<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Ellipsoidal Calculus &mdash; Ellipsoidal Toolbox 2.0 beta 1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0 beta 1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Ellipsoidal Toolbox 2.0 beta 1 documentation" href="index.html" />
    <link rel="next" title="Installation" href="chap_install.html" />
    <link rel="prev" title="Introduction" href="chap_intro.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="chap_install.html" title="Installation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="chap_intro.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li><a href="main_manual.html">Ellipsoidal Toolbox 2.0 beta 1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="ellipsoidal-calculus">
<h1>Ellipsoidal Calculus<a class="headerlink" href="#ellipsoidal-calculus" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-notions">
<h2>Basic Notions<a class="headerlink" href="#basic-notions" title="Permalink to this headline">¶</a></h2>
<p>We start with basic definitions.
Ellipsoid <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> in
<img class="math" src="_images/math/9d5b8bcc7aa4f27bc64d1e1817aa4f42c44cffcb.png" alt="{\bf R}^n"/> with center <img class="math" src="_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/> and shape matrix <img class="math" src="_images/math/9866e3a998d628ba0941eb4fea0666ac391d149a.png" alt="Q"/> is
the set</p>
<div class="math" id="equation-ellipsoid">
<p><span class="eqno">(1)</span><img src="_images/math/3a533b8bc1ef5d0561409d914318444d5feb0127.png" alt="{\mathcal E}(q,Q) = \{ x \in {\bf R}^n ~|~ \langle (x-q), Q^{-1}(x-q)\rangle\leqslant1 \},"/></p>
</div><p>wherein <img class="math" src="_images/math/9866e3a998d628ba0941eb4fea0666ac391d149a.png" alt="Q"/> is positive definite (<img class="math" src="_images/math/bd59cd068d766e594478ad09e423d6fb398c63e1.png" alt="Q=Q^T"/> and
<img class="math" src="_images/math/11c656f07afcb5a0afee913b8ac128b5f57249f4.png" alt="\langle x, Qx\rangle&gt;0"/> for all nonzero <img class="math" src="_images/math/7bb6c0add112d2fafef9f550e3efdf5a8a90f9fc.png" alt="x\in{\bf R}^n"/>).
Here <img class="math" src="_images/math/18c2678ef7f3f037c1964e63384099f0313a6fd5.png" alt="\langle\cdot,\cdot\rangle"/> denotes inner
product. The support function of a set
<img class="math" src="_images/math/b96c8cb69427f15af3797de44c829de5ee81b08d.png" alt="{\mathcal X}\subseteq{\bf R}^n"/> is</p>
<div class="math">
<p><img src="_images/math/60bd268c609a7964888987b79b3ff48a56c605c7.png" alt="\rho(l~|~{\mathcal X}) = \sup_{x\in{\mathcal X}} \langle l,x\rangle."/></p>
</div><p>In particular, the support function of the ellipsoid <a href="#equation-ellipsoid">(1)</a> is</p>
<div class="math" id="equation-ellsupp">
<p><span class="eqno">(2)</span><img src="_images/math/55f1bf21ab57c96af2b84ac3af818b29cf14a85b.png" alt="\rho(l~|~{\mathcal E}(q,Q)) = \langle l, q\rangle + \langle l, Ql\rangle^{1/2}."/></p>
</div><p>Although in <a href="#equation-ellipsoid">(1)</a> <img class="math" src="_images/math/9866e3a998d628ba0941eb4fea0666ac391d149a.png" alt="Q"/> is assumed to be positive definite,
in practice we may deal with situations when <img class="math" src="_images/math/9866e3a998d628ba0941eb4fea0666ac391d149a.png" alt="Q"/> is singular, that
is, with degenerate ellipsoids flat in those directions for which the
corresponding eigenvalues are zero. Therefore, it is useful to give an
alternative definition of an ellipsoid using the expression <a href="#equation-ellsupp">(2)</a>.
Ellipsoid <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> in <img class="math" src="_images/math/9d5b8bcc7aa4f27bc64d1e1817aa4f42c44cffcb.png" alt="{\bf R}^n"/> with center
<img class="math" src="_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/> and shape matrix <img class="math" src="_images/math/9866e3a998d628ba0941eb4fea0666ac391d149a.png" alt="Q"/> is the set</p>
<div class="math" id="equation-ellipsoid2">
<p><span class="eqno">(3)</span><img src="_images/math/a9d6137062c23d367d64e918d66059511726c3e8.png" alt="{\mathcal E}(q,Q) = \{ x \in {\bf R}^n ~|~
\langle l,x\rangle\leqslant\langle l,q\rangle + \langle l,Ql\rangle^{1/2}
\mbox{ for all } l\in{\bf R}^n \},"/></p>
</div><p>wherein matrix <img class="math" src="_images/math/9866e3a998d628ba0941eb4fea0666ac391d149a.png" alt="Q"/> is positive semidefinite (<img class="math" src="_images/math/bd59cd068d766e594478ad09e423d6fb398c63e1.png" alt="Q=Q^T"/> and
<img class="math" src="_images/math/272f85804947fbbdbccedfcecf671db04b833624.png" alt="\langle x, Qx\rangle\geqslant0"/> for all <img class="math" src="_images/math/7bb6c0add112d2fafef9f550e3efdf5a8a90f9fc.png" alt="x\in{\bf R}^n"/>).
The volume of ellipsoid <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> is</p>
<div class="math" id="equation-ellvolume">
<p><span class="eqno">(4)</span><img src="_images/math/787e26f0936c32e30732956d391475f477c721f7.png" alt="{\bf Vol}(E(q,Q)) = {\bf Vol}_{\langle x,x\rangle\leqslant1}\sqrt{\det Q},"/></p>
</div><p>where <img class="math" src="_images/math/a1c4282ba153b9007e5704a7844b6b912c3cefa4.png" alt="{\bf Vol}_{\langle x,x\rangle\leqslant1}"/> is the volume of
the unit ball in <img class="math" src="_images/math/9d5b8bcc7aa4f27bc64d1e1817aa4f42c44cffcb.png" alt="{\bf R}^n"/>:</p>
<div class="math" id="equation-ellunitball">
<p><span class="eqno">(5)</span><img src="_images/math/e8c3c4bdc6098ca9596103e8b5d8548b105c7d1f.png" alt="{\bf Vol}_{\langle x,x\rangle\leqslant1} = \left\{\begin{array}{ll}
\frac{\pi^{n/2}}{(n/2)!}, &amp;
\mbox{ for even } n,\\
\frac{2^n\pi^{(n-1)/2}\left((n-1)/2\right)!}{n!}, &amp;
\mbox{ for odd } n. \end{array}\right."/></p>
</div><p>The distance from <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> to the fixed point <img class="math" src="_images/math/c7d457e388298246adb06c587bccd419ea67f7e8.png" alt="a"/>
is</p>
<div class="math" id="equation-dist_point">
<p><span class="eqno">(6)</span><img src="_images/math/f55ed67a8bdd8cfa80a4d9fb01c31dd322b1bd94.png" alt="{\bf dist}({\mathcal E}(q,Q),a) = \max_{\langle l,l\rangle=1}\left(\langle l,a\rangle -
\rho(l ~|~ {\mathcal E}(q,Q)) \right) =
\max_{\langle l,l\rangle=1}\left(\langle l,a\rangle - \langle l,q\rangle -
\langle l,Ql\rangle^{1/2}\right)."/></p>
</div><p>If <img class="math" src="_images/math/33c2e1c843ee3d20001f0660eb3a595d254df6fa.png" alt="{\bf dist}({\mathcal E}(q,Q),a) &gt; 0"/>, <img class="math" src="_images/math/c7d457e388298246adb06c587bccd419ea67f7e8.png" alt="a"/> lies outside
<img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/>; if
<img class="math" src="_images/math/b5695495d2d339517497d94a81558300a82f054c.png" alt="{\bf dist}({\mathcal E}(q,Q),a) = 0"/>, <img class="math" src="_images/math/c7d457e388298246adb06c587bccd419ea67f7e8.png" alt="a"/> is a boundary
point of <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/>; if
<img class="math" src="_images/math/69b5f49dc7bfaa5204c740c07d10b36cd51d461b.png" alt="{\bf dist}({\mathcal E}(q,Q),a) &lt; 0"/>, <img class="math" src="_images/math/c7d457e388298246adb06c587bccd419ea67f7e8.png" alt="a"/> is an internal
point of <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/>.</p>
<p>Given two ellipsoids, <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> and
<img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/>, the distance between them is</p>
<div class="math" id="equation-dist_ell">
<p><span class="eqno">(7)</span><img src="_images/math/de6040a2794dfff5ea1ebef5b939911fbf2cfd21.png" alt="\begin{aligned}
{\bf dist}({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2)) &amp; = \max_{\langle l,l\rangle=1}
\left(-\rho(-l ~|~ {\mathcal E}(q_1,Q_1)) - \rho(l ~|~ {\mathcal E}(q_2,Q_2))\right) \\
&amp; = \max_{\langle l,l\rangle=1}\left(\langle l,q_1\rangle -
\langle l,Q_1l\rangle^{1/2} - \langle l,q_2\rangle -
\langle l,Q_2l\rangle^{1/2}\right).
\end{aligned}"/></p>
</div><p>If <img class="math" src="_images/math/79d42ac63334d1f9d165c25408d0ca134d81aef3.png" alt="{\bf dist}({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2)) &gt; 0"/>,
the ellipsoids have no common points; if
<img class="math" src="_images/math/40944f178c2e97a4c639bc8e144b6b6b527ed231.png" alt="{\bf dist}({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2)) = 0"/>, the
ellipsoids have one common point - they touch; if
<img class="math" src="_images/math/84de77713e3068c4cd1e610b16b75d643fe0f9a7.png" alt="{\bf dist}({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2)) &lt; 0"/>, the
ellipsoids intersect.</p>
<p>Finding <img class="math" src="_images/math/903072eca6104ef9efd2d60b30c5f28df1b51dbf.png" alt="{\bf dist}({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2))"/>
using QCQP is</p>
<div class="math">
<p><img src="_images/math/178c2ffca9448494ad1477217df532a2089aacd2.png" alt="d({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2)) = \min \langle (x-y), (x-y)\rangle"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/607483d236037103af14d35c9d8dce873baa3bb9.png" alt="\begin{aligned}
\langle (q_1-x), Q_1^{-1}(q_1-x)\rangle &amp; \leqslant&amp; 1,\\
\langle (q_2-x), Q_2^{-1}(q_2-y)\rangle &amp; \leqslant&amp; 1,\end{aligned}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/fc9516c891e2fff82100c9bc658cdff497c0d775.png" alt="d({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2))=\left\{\begin{array}{ll}
{\bf dist}^2({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2)) &amp;
\mbox{ if } {\bf dist}({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2))&gt;0, \\
0 &amp; \mbox{ otherwise}. \end{array}\right."/></p>
</div><p>Checking if <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> nondegenerate ellipsoids
<img class="math" src="_images/math/bba93d24bd1133965590d5dd5390897f12bfdd39.png" alt="{\mathcal E}(q_1,Q_1),\cdots,{\mathcal E}(q_k,Q_k)"/> have nonempty
intersection, can be cast as a quadratically constrained quadratic
programming (QCQP) problem:</p>
<div class="math">
<p><img src="_images/math/883cc66c9220b1a82600e5112a8ddb183cd8f4e4.png" alt="\min 0"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/448602ad362885e9e460254eadf42db9436cbd85.png" alt="\langle (x-q_i),Q_i^{-1}(x-q_i)\rangle - 1 \leqslant0, ~~~ i=1,\cdots,k."/></p>
</div><p>If this problem is feasible, the intersection is nonempty. Given
compact convex set <img class="math" src="_images/math/b96c8cb69427f15af3797de44c829de5ee81b08d.png" alt="{\mathcal X}\subseteq{\bf R}^n"/>, its polar
set, denoted <img class="math" src="_images/math/9dcf65b34c9b6571c83e870b229364b7513df564.png" alt="{\mathcal X}^\circ"/>, is</p>
<div class="math">
<p><img src="_images/math/34768e4d22ee40d66173aa700efc505485af8983.png" alt="{\mathcal X}^\circ = \{x\in{\bf R}^n ~|~ \langle x,y\rangle\leqslant1, ~ y\in{\mathcal X}\},"/></p>
</div><p>or, equivalently,</p>
<div class="math">
<p><img src="_images/math/f96fb36da02664e65571321d81b24b17b81b96f3.png" alt="{\mathcal X}^\circ = \{l\in{\bf R}^n ~|~ \rho(l ~|~ {\mathcal X})\leqslant1\}."/></p>
</div><p>The properties of the polar set are</p>
<ul class="simple">
<li>If <img class="math" src="_images/math/0285557d288b33952d0cf254b178223c5f746598.png" alt="{\mathcal X}"/> contains the origin,
<img class="math" src="_images/math/511ef974392c7b8ffbba574af743fa446e17a520.png" alt="({\mathcal X}^\circ)^\circ = {\mathcal X}"/>;</li>
<li>If <img class="math" src="_images/math/c8c00b61dc9f5899edcc6e869710149ab4cda213.png" alt="{\mathcal X}_1\subseteq{\mathcal X}_2"/>,
<img class="math" src="_images/math/bfc9604c1bcb2121a81d0af9f7d682220444800b.png" alt="{\mathcal X}_2^\circ\subseteq{\mathcal X}_1^\circ"/>;</li>
<li>For any nonsingular matrix <img class="math" src="_images/math/5bb275b50853b5ef0c861cc788aec212ff538dc5.png" alt="A\in{\bf R}^{n\times n}"/>,
<img class="math" src="_images/math/848746b5aa961701a706011bc49a2cec7645bf03.png" alt="(A{\mathcal X})^\circ = (A^T)^{-1}{\mathcal X}^\circ"/>.</li>
</ul>
<p>If a nondegenerate ellipsoid <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> contains the
origin, its polar set is also an ellipsoid:</p>
<div class="math">
<p><img src="_images/math/a1a60d72293886a86d97110ef0f9554352c8123c.png" alt="\begin{aligned}
{\mathcal E}^\circ(q,Q) &amp; = \{l\in{\bf R}^n ~|~ \langle l,q\rangle +
\langle l,Ql\rangle^{1/2}\leqslant1 \}\\
&amp; = \{l\in{\bf R}^n ~|~ \langle l,(Q-qq^T)^{-1}l\rangle +
2\langle l,q\rangle\leqslant1 \}\\
&amp; = \{l\in{\bf R}^n ~|~ \langle(l+(Q-qq^T)^{-1}q),
(Q-qq^T)(l+(Q-qq^T)^{-1}q)\rangle\leqslant1+\langle q,(Q-qq^T)^{-1}q\rangle \}.\end{aligned}"/></p>
</div><p>The special case is</p>
<div class="math">
<p><img src="_images/math/2de1ea6fb3f6676930a240b8391a5207e85936a3.png" alt="{\mathcal E}^\circ(0,Q) = {\mathcal E}(0,Q^{-1})."/></p>
</div><p>Given <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> compact sets
<img class="math" src="_images/math/caa75cd3c3d042f89f0a13f8e5a46481d6b93e65.png" alt="{\mathcal X}_1, \cdots, {\mathcal X}_k\subseteq{\bf R}^n"/>, their
geometric (Minkowski) sum is</p>
<div class="math" id="equation-minksum">
<p><span class="eqno">(8)</span><img src="_images/math/bd592756af7f9948048ca313b4d195268ae78f09.png" alt="{\mathcal X}_1\oplus\cdots\oplus{\mathcal X}_k=\bigcup_{x_1\in{\mathcal X}_1}\cdots\bigcup_{x_k\in{\mathcal X}_k}
\{x_1 + \cdots + x_k\} ."/></p>
</div><p>Given two compact sets
<img class="math" src="_images/math/27de03ccef6bd8fac119dd0ea6c30b4fbcfba669.png" alt="{\mathcal X}_1, {\mathcal X}_2 \subseteq{\bf R}^n"/>, their
geometric (Minkowski) difference is</p>
<div class="math" id="equation-minkdiff">
<p><span class="eqno">(9)</span><img src="_images/math/4f1e202eabc0263a7e08bada8ccbc0faa51841fd.png" alt="{\mathcal X}_1\dot{-}{\mathcal X}_2 = \{x\in{\bf R}^n ~|~ x + {\mathcal X}_2 \subseteq {\mathcal X}_1 \}."/></p>
</div><p>Ellipsoidal calculus concerns the following set of operations:</p>
<ul class="simple">
<li>affine transformation of ellipsoid;</li>
<li>geometric sum of finite number of ellipsoids;</li>
<li>geometric difference of two ellipsoids;</li>
<li>intersection of finite number of ellipsoids.</li>
</ul>
<p>These operations occur in reachability calculation and verification of
piecewise affine dynamical systems. The result of all of these
operations, except for the affine transformation, is <em>not</em> generally an
ellipsoid but some convex set, for which we can compute external and
internal ellipsoidal approximations.</p>
<p>Additional operations implemented in the <em>Ellipsoidal Toolbox</em> include
external and internal approximations of intersections of ellipsoids with
hyperplanes, halfspaces and polytopes. Hyperplane <img class="math" src="_images/math/bac0ae63aec09971dd9b5d57245fb790377c8e10.png" alt="H(c,\gamma)"/> in
<img class="math" src="_images/math/9d5b8bcc7aa4f27bc64d1e1817aa4f42c44cffcb.png" alt="{\bf R}^n"/> is the set</p>
<div class="math" id="equation-hyperplane">
<p><span class="eqno">(10)</span><img src="_images/math/b7b6154b1b249806be929c57a4a66bb864455e6b.png" alt="H = \{x\in{\bf R}^n ~|~ \langle c, x\rangle = \gamma\}"/></p>
</div><p>with <img class="math" src="_images/math/39f9cca28279bfc85bbb591230158cd05d2417a1.png" alt="c\in{\bf R}^n"/> and <img class="math" src="_images/math/36cc654c162768bcca8a0c1c37f44133bf3c5495.png" alt="\gamma\in{\bf R}"/> fixed.
The distance from ellipsoid <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> to
hyperplane <img class="math" src="_images/math/bac0ae63aec09971dd9b5d57245fb790377c8e10.png" alt="H(c,\gamma)"/> is</p>
<div class="math" id="equation-dist_hp">
<p><span class="eqno">(11)</span><img src="_images/math/f8ba265e6f08a7ae35cbae8aec9f39518239c6ce.png" alt="{\bf dist}({\mathcal E}(q,Q),H(c,\gamma)) =
\frac{\left|\gamma-\langle c,q\rangle\right| -
\langle c,Qc\rangle^{1/2}}{\langle c,c\rangle^{1/2}}."/></p>
</div><p>If <img class="math" src="_images/math/d89c46304fa27f54fcb98b16a8e15b7a544495c0.png" alt="{\bf dist}({\mathcal E}(q,Q),H(c,\gamma))&gt;0"/>, the ellipsoid
and the hyperplane do not intersect; if
<img class="math" src="_images/math/106d8d3c46c311ff64d55724bfc600d7ac54ec73.png" alt="{\bf dist}({\mathcal E}(q,Q),H(c,\gamma))=0"/>, the hyperplane is a
supporting hyperplane for the ellipsoid; if
<img class="math" src="_images/math/960abeff20941af75ff673a99d0c9e44f84dde48.png" alt="{\bf dist}({\mathcal E}(q,Q),H(c,\gamma))&lt;0"/>, the ellipsoid
intersects the hyperplane. The intersection of an ellipsoid with a
hyperplane is always an ellipsoid and can be computed directly.</p>
<p>Checking if the intersection of <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> nondegenerate ellipsoids
<img class="math" src="_images/math/f71c7ba166b0aed1265d134baf256a71de71b358.png" alt="E(q_1,Q_1),\cdots,{\mathcal E}(q_k,Q_k)"/> intersects hyperplane
<img class="math" src="_images/math/bac0ae63aec09971dd9b5d57245fb790377c8e10.png" alt="H(c,\gamma)"/>, is equivalent to the feasibility check of the QCQP
problem:</p>
<div class="math">
<p><img src="_images/math/883cc66c9220b1a82600e5112a8ddb183cd8f4e4.png" alt="\min 0"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/337da0b80c659c1ca0bcbefb9674dd271d44184a.png" alt="\begin{aligned}
\langle (x-q_i),Q_i^{-1}(x-q_i)\rangle - 1 \leqslant0, &amp; &amp; i=1,\cdots,k,\\
\langle c, x\rangle - \gamma = 0. &amp; &amp;\end{aligned}"/></p>
</div><p>A hyperplane defines two (closed) <em>halfspaces</em>:</p>
<div class="math" id="equation-halfspace1">
<p><span class="eqno">(12)</span><img src="_images/math/cc8f0e3cc28cf5f84cafbe8b9674a3fc67f0a866.png" alt="{\bf S}_1 = \{x\in{\bf R}^n ~|~ \langle c, x\rangle \leqslant\gamma\}"/></p>
</div><p>and</p>
<div class="math" id="equation-halfspace2">
<p><span class="eqno">(13)</span><img src="_images/math/5d6d799168a072ff170f28d7ad409178a607fba5.png" alt="{\bf S}_2 = \{x\in{\bf R}^n ~|~ \langle c, x\rangle \geqslant\gamma\}."/></p>
</div><p>To avoid confusion, however, we shall further assume that a hyperplane
<img class="math" src="_images/math/bac0ae63aec09971dd9b5d57245fb790377c8e10.png" alt="H(c,\gamma)"/> specifies the halfspace in the sense <a href="#equation-halfspace1">(12)</a>.
In order to refer to the other halfspace, the same hyperplane should be
defined as <img class="math" src="_images/math/16e3c1b6fd6e98b81efcca4d744c1d395a580ebd.png" alt="H(-c,-\gamma)"/>.</p>
<p>The idea behind the calculation of intersection of an ellipsoid with a
halfspace is to treat the halfspace as an unbounded ellipsoid, that is,
as the ellipsoid with the shape matrix all but one of whose eigenvalues
are <img class="math" src="_images/math/b671f1bb7e4ee86584347d5d22f1dc8abdb5bef2.png" alt="\infty"/>.
Polytope <img class="math" src="_images/math/7df7554bc8b905a14d174aa3078a101032004660.png" alt="P(C,g)"/> is the
intersection of a finite number of closed halfspaces:</p>
<div class="math" id="equation-polytope">
<p><span class="eqno">(14)</span><img src="_images/math/ba36465f80659e02db6d1fc06dc138954c5ff94c.png" alt="P = \{x\in{\bf R}^n ~|~ Cx\leqslant g\},"/></p>
</div><p>wherein <img class="math" src="_images/math/1433cbe6516602fafd6b038e814ff937c6e05743.png" alt="C=[c_1 ~ \cdots ~ c_m]^T\in{\bf R}^{m\times n}"/> and
<img class="math" src="_images/math/1ed2eac522cf78de4379b635f636420ca7dfe910.png" alt="g=[\gamma_1 ~ \cdots ~ \gamma_m]^T\in{\bf R}^m"/>.
The distance
from ellipsoid <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> to the polytope <img class="math" src="_images/math/7df7554bc8b905a14d174aa3078a101032004660.png" alt="P(C,g)"/>
is</p>
<div class="math" id="equation-dist_poly">
<p><span class="eqno">(15)</span><img src="_images/math/6532442941bab8d7c5d993bd2134aae401810273.png" alt="{\bf dist}({\mathcal E}(q,Q),P(C,g))=\min_{y\in P(C,g)}{\bf dist}({\mathcal E}(q,Q),y),"/></p>
</div><p>where <img class="math" src="_images/math/5079462083e7ccce01f235396688a1624437c469.png" alt="{\bf dist}({\mathcal E}(q,Q),y)"/> comes from
([dist:sub:<cite>p</cite>oint]). If
<img class="math" src="_images/math/3cd27bac51d15b2f5983cd901cf89c3eb88282f4.png" alt="{\bf dist}({\mathcal E}(q,Q),P(C,g))&gt;0"/>, the ellipsoid and the
polytope do not intersect; if
<img class="math" src="_images/math/92cad30470cce7e86b5489d31e58224ca05dbeea.png" alt="{\bf dist}({\mathcal E}(q,Q),P(C,g))=0"/>, the ellipsoid touches
the polytope; if <img class="math" src="_images/math/507c7e0d2c6a83904609d27ffb280ec47f181ad2.png" alt="{\bf dist}({\mathcal E}(q,Q),P(C,g))&lt;0"/>, the
ellipsoid intersects the polytope.</p>
<p>Checking if the intersection of <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> nondegenerate ellipsoids
<img class="math" src="_images/math/f71c7ba166b0aed1265d134baf256a71de71b358.png" alt="E(q_1,Q_1),\cdots,{\mathcal E}(q_k,Q_k)"/> intersects polytope
<img class="math" src="_images/math/7df7554bc8b905a14d174aa3078a101032004660.png" alt="P(C,g)"/> is equivalent to the feasibility check of the QCQP
problem:</p>
<div class="math">
<p><img src="_images/math/883cc66c9220b1a82600e5112a8ddb183cd8f4e4.png" alt="\min 0"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/089dc5f1e3a0b324124f8dde628d1ad36e78555f.png" alt="\begin{aligned}
\langle (x-q_i),Q_i^{-1}(x-q_i)\rangle - 1 \leqslant0, &amp; &amp; i=1,\cdots,k,\\
\langle c_j, x\rangle - \gamma_j \leqslant0, &amp; &amp; j=1,\cdots,m.\end{aligned}"/></p>
</div></div>
<div class="section" id="operations-with-ellipsoids">
<h2>Operations with Ellipsoids<a class="headerlink" href="#operations-with-ellipsoids" title="Permalink to this headline">¶</a></h2>
<div class="section" id="affine-transformation">
<h3>Affine Transformation<a class="headerlink" href="#affine-transformation" title="Permalink to this headline">¶</a></h3>
<p>The simplest operation with ellipsoids is an affine transformation. Let
ellipsoid <img class="math" src="_images/math/db099b63bb605cd0784d06062609d4b78658990d.png" alt="{\mathcal E}(q,Q)\subseteq{\bf R}^n"/>, matrix
<img class="math" src="_images/math/037c0df54789bf87da84097dbddd312524ab44fd.png" alt="A\in{\bf R}^{m\times n}"/> and vector <img class="math" src="_images/math/2de3365ca20ad608bee38a645d05d849a748114c.png" alt="b\in{\bf R}^m"/>. Then</p>
<div class="math" id="equation-affinetrans">
<p><span class="eqno">(16)</span><img src="_images/math/5b49a8071408cec8a437959a3b7f41cef4c48e56.png" alt="A{\mathcal E}(q,Q) + b = {\mathcal E}(Aq+b, AQA^T) ."/></p>
</div><p>Thus, ellipsoids are preserved under affine transformation. If the rows
of <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/> are linearly independent (which implies
<img class="math" src="_images/math/e12e26bb03985dbe5008e8262f91a3ba187ff3d8.png" alt="m\leqslant n"/>), and <img class="math" src="_images/math/fc43f0ea59e862d7db01586894e9eea730d427b7.png" alt="b=0"/>, the affine transformation is
called <em>projection</em>.</p>
</div>
<div class="section" id="geometric-sum">
<h3>Geometric Sum<a class="headerlink" href="#geometric-sum" title="Permalink to this headline">¶</a></h3>
<p>Consider the geometric sum <a href="#equation-minksum">(8)</a> in which
<img class="math" src="_images/math/949123d9e0ed205b634d8ea6b63f0389a11234bb.png" alt="{\mathcal X}_1,\cdots"/>,<img class="math" src="_images/math/a27869b9b49cef957925e4de4af37b9e24ae2d58.png" alt="{\mathcal X}_k"/> are nondegenerate
ellipsoids <img class="math" src="_images/math/50cdf21096e1416aee91886590383a10ba319d50.png" alt="{\mathcal E}(q_1,Q_1),\cdots"/>,
<img class="math" src="_images/math/e923683d85eb163281b77dbfc1a1dcee7e1344bb.png" alt="{\mathcal E}(q_k,Q_k)\subseteq{\bf R}^n"/>. The resulting set is
not generally an ellipsoid. However, it can be tightly approximated by
the parametrized families of external and internal ellipsoids.</p>
<p>Let parameter <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> be some nonzero vector in <img class="math" src="_images/math/9d5b8bcc7aa4f27bc64d1e1817aa4f42c44cffcb.png" alt="{\bf R}^n"/>.
Then the external approximation <img class="math" src="_images/math/b7ba4ccd31cc16807035190d40c846bc450b6213.png" alt="{\mathcal E}(q,Q_l^+)"/> and the
internal approximation <img class="math" src="_images/math/1ec35dc3d7ef81c4f0c3a43a5776862c9312b6f5.png" alt="{\mathcal E}(q,Q_l^-)"/> of the sum
<img class="math" src="_images/math/c7c30e2dd5f3258c685f0f36043a32320d7601f2.png" alt="{\mathcal E}(q_1,Q_1)\oplus\cdots\oplus{\mathcal E}(q_k,Q_k)"/> are
<em>tight</em> along direction <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/>, i.e.,</p>
<div class="math">
<p><img src="_images/math/55c6f83d93b9cfd19c078664baecec2cd4855b19.png" alt="{\mathcal E}(q,Q_l^-)\subseteq{\mathcal E}(q_1,Q_1)\oplus\cdots\oplus{\mathcal E}(q_k,Q_k)
\subseteq{\mathcal E}(q,Q_l^+)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/9ac1ae316de090a0a7dd43aed00f3d3d829bee93.png" alt="\rho(\pm l ~|~ {\mathcal E}(q,Q_l^-)) =
\rho(\pm l ~|~ {\mathcal E}(q_1,Q_1)\oplus\cdots\oplus{\mathcal E}(q_k,Q_k)) =
\rho(\pm l ~|~ {\mathcal E}(q,Q_l^+))."/></p>
</div><p>Here the center <img class="math" src="_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/> is</p>
<div class="math" id="equation-minksum_c">
<p><span class="eqno">(17)</span><img src="_images/math/c4b627e644a8293c07e69bba06fc492853fc260e.png" alt="q = q_1 + \cdots + q_k ,"/></p>
</div><p>the shape matrix of the external ellipsoid <img class="math" src="_images/math/2259718a4c723981c66c344ce2a73459a8e26f0e.png" alt="Q_l^+"/> is</p>
<div class="math" id="equation-minksum_ea">
<p><span class="eqno">(18)</span><img src="_images/math/26f359504b0f4259c81dfd8a3cb9d82104205373.png" alt="Q_l^+ = \left(\langle l,Q_1l\rangle^{1/2} + \cdots
+ \langle l,Q_kl\rangle^{1/2}\right)
\left(\frac{1}{\langle l,Q_1l\rangle^{1/2}}Q_1 + \cdots +
\frac{1}{\langle l,Q_kl\rangle^{1/2}}Q_k\right),"/></p>
</div><p>and the shape matrix of the internal ellipsoid <img class="math" src="_images/math/5cac05aa42515ef71b03061ea7a3bb933b5024c8.png" alt="Q_l^-"/> is</p>
<div class="math" id="equation-minksum_ia">
<p><span class="eqno">(19)</span><img src="_images/math/9a1efe88cc2f4b3be342e4ce3e57f8f4b2297b8b.png" alt="Q_l^- = \left(Q_1^{1/2} + S_2Q_2^{1/2} + \cdots + S_kQ_k^{1/2}\right)^T
\left(Q_1^{1/2} + S_2Q_2^{1/2} + \cdots + S_kQ_k^{1/2}\right),"/></p>
</div><p>with matrices <img class="math" src="_images/math/9e0ec34cd8860ceb97113f81ba768ba739ad5166.png" alt="S_i"/>, <img class="math" src="_images/math/0c85d6fd0282e32f0fb6db010435ae19dbdf51f9.png" alt="i=2,\cdots,k"/>, being orthogonal
(<img class="math" src="_images/math/abfa77d99a295cfdec300683a437f78b84152501.png" alt="S_iS_i^T=I"/>) and such that vectors
<img class="math" src="_images/math/c7ed5faab40584a2685ceec6f0d539f256772f45.png" alt="Q_1^{1/2}l, S_2Q_2^{1/2}l, \cdots, S_kQ_k^{1/2}l"/> are parallel.</p>
<p>Varying vector <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> we get exact external and internal
approximations,</p>
<div class="math">
<p><img src="_images/math/951d3a4b2425b8c0eb94e7ed305a9b8b80142a39.png" alt="\bigcup_{\langle l,l\rangle=1} {\mathcal E}(q,Q_l^-) =
{\mathcal E}(q_1,Q_1)\oplus\cdots\oplus{\mathcal E}(q_k,Q_k) =
\bigcap_{\langle l,l\rangle=1} {\mathcal E}(q,Q_l^+) ."/></p>
</div><p>For proofs of formulas given in this section, see Kurzhanski and Vályi
(1997), Kurzhanski and Varaiya (2000).</p>
<p>One last comment is about how to find orthogonal matrices
<img class="math" src="_images/math/5d8622c8f78dee53189f0a7db53aa204ef207189.png" alt="S_2,\cdots,S_k"/> that align vectors
<img class="math" src="_images/math/5cafc61a5b67a967d4faee9aacfd00327fad0f70.png" alt="Q_2^{1/2}l, \cdots, Q_k^{1/2}l"/> with <img class="math" src="_images/math/0610ca673ec485925fbd1c600179fff9f22bca8c.png" alt="Q_1^{1/2}l"/>. Let
<img class="math" src="_images/math/a3ef75cc31c88a4eb1c121de7a914b0d73882ee2.png" alt="v_1"/> and <img class="math" src="_images/math/e3c09383f52ff7db11358e4aa6ca6c0307b02d76.png" alt="v_2"/> be some unit vectors in <img class="math" src="_images/math/9d5b8bcc7aa4f27bc64d1e1817aa4f42c44cffcb.png" alt="{\bf R}^n"/>.
We have to find matrix <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> such that
<img class="math" src="_images/math/f5f5185b36251ec182e491c4426666d2571552e9.png" alt="Sv_2\uparrow\uparrow v_1"/>. We suggest explicit formulas for the
calculation of this matrix ( Dariyn and Kurzhanski (2012)):</p>
<div class="math" id="equation-valign1">
<p><span class="eqno">(20)</span><img src="_images/math/6befdc30041e159b2dc70b0413434071ace7cbeb.png" alt="T = I + Q_1(S - I)Q_1^T,"/></p>
</div><div class="math" id="equation-valign2">
<p><span class="eqno">(21)</span><img src="_images/math/13d431115166dafcfd7e6567b0fff7a0eb92d170.png" alt="S = \begin{pmatrix}
     c &amp; s\\
     -s &amp; c
    \end{pmatrix},\quad c = \langle\hat{v_1},\ \hat{v_2}\rangle,\ \quad s = \sqrt{1 - c^2},\ \quad \hat{v_i} = \dfrac{v_i}{\|v_i\|}"/></p>
</div><div class="math" id="equation-valign3">
<p><span class="eqno">(22)</span><img src="_images/math/61cdc81e61c3c602a3331b5cb5c6a816f38b2704.png" alt="Q_1 = [q_1 \, q_2]\in \mathbb{R}^{n\times2},\ \quad q_1 = \hat{v_1},\ \quad q_2 = \begin{cases}
s^{-1}(\hat{v_2} - c\hat{v_1}),&amp; s\ne 0\\
0,&amp; s = 0.
\end{cases}"/></p>
</div></div>
<div class="section" id="geometric-difference">
<h3>Geometric Difference<a class="headerlink" href="#geometric-difference" title="Permalink to this headline">¶</a></h3>
<p>Consider the geometric difference <a href="#equation-minkdiff">(9)</a> in which the sets
<img class="math" src="_images/math/51cb1c05fe424ad46a882c20e73982073f636208.png" alt="{\mathcal X}_1"/> and <img class="math" src="_images/math/f1ff206ea244a14735a602e5212cfe96f0589f26.png" alt="{\mathcal X}_2"/> are nondegenerate
ellipsoids <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> and
<img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/>. We say that ellipsoid
<img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> is <em>bigger</em> than ellipsoid
<img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/> if</p>
<div class="math">
<p><img src="_images/math/cf9b457145afdb53006860945864f00accd1c618.png" alt="{\mathcal E}(0,Q_2) \subseteq {\mathcal E}(0,Q_1)."/></p>
</div><p>If this condition is not fulfilled, the geometric difference
<img class="math" src="_images/math/a1062fcc8473fb7421323f2b926c485e48337e78.png" alt="{\mathcal E}(q_1,Q_1)\dot{-}{\mathcal E}(q_2,Q_2)"/> is an empty
set:</p>
<div class="math">
<p><img src="_images/math/4779d3cbb11c493a1b28a95176a6456b9fadab75.png" alt="{\mathcal E}(0,Q_2) \not\subseteq {\mathcal E}(0,Q_1) ~~~ \Rightarrow ~~~
{\mathcal E}(q_1,Q_1) \dot{-}{\mathcal E}(q_2,Q_2) = \emptyset."/></p>
</div><p>If <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> is bigger than
<img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/> and <img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/> is
bigger than <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/>, in other words, if
<img class="math" src="_images/math/e66315533674b0431cd1558baecb6889c2f20b5e.png" alt="Q_1=Q_2"/>,</p>
<div class="math">
<p><img src="_images/math/28cc614d5dce7576ad04acdbbb21d6f5368ea6d6.png" alt="{\mathcal E}(q_1,Q_1) \dot{-}{\mathcal E}(q_2,Q_2) = \{q_1-q_2\} ~~~ \mbox{and} ~~~
{\mathcal E}(q_2,Q_2) \dot{-}{\mathcal E}(q_1,Q_1) = \{q_2-q_1\}."/></p>
</div><p>To check if ellipsoid <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> is bigger than
ellipsoid <img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/>, we perform simultaneous
diagonalization of matrices <img class="math" src="_images/math/c16e423c8f499e0bef8c20078b04126aeb9417bc.png" alt="Q_1"/> and <img class="math" src="_images/math/f83bf0891a57ba8a1ee68d8c72f141ccbc14186d.png" alt="Q_2"/>, that is, we
find matrix <img class="math" src="_images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/> such that</p>
<div class="math">
<p><img src="_images/math/7d357110ae4ae4dd0d455af7356b89b6dc4bef2f.png" alt="TQ_1T^T = I ~~~ \mbox{and} ~~~ TQ_2T^T=D,"/></p>
</div><p>where <img class="math" src="_images/math/9ffb448918db29f2a72f8f87f421b3b3cad18f95.png" alt="D"/> is some diagonal matrix. Simultaneous diagonalization
of <img class="math" src="_images/math/c16e423c8f499e0bef8c20078b04126aeb9417bc.png" alt="Q_1"/> and <img class="math" src="_images/math/f83bf0891a57ba8a1ee68d8c72f141ccbc14186d.png" alt="Q_2"/> is possible because both are symmetric
positive definite (see Gantmacher (1960)). To find such matrix
<img class="math" src="_images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/>, we first do the SVD of <img class="math" src="_images/math/c16e423c8f499e0bef8c20078b04126aeb9417bc.png" alt="Q_1"/>:</p>
<div class="math" id="equation-simdiag1">
<p><span class="eqno">(23)</span><img src="_images/math/4824ec9676cfa0ed6d828e1581a2b0fce5b3f20f.png" alt="Q_1 = U_1\Sigma_1V_1^T ."/></p>
</div><p>Then the SVD of matrix
<img class="math" src="_images/math/dee3d34368b4ff037cfb9a60bee42c69520bc5db.png" alt="\Sigma_1^{-1/2}U_1^TQ_2U_1\Sigma_1^{-1/2}"/>:</p>
<div class="math" id="equation-simdiag2">
<p><span class="eqno">(24)</span><img src="_images/math/0076b21ab5b4e4c82862aa8e261c01040fe877be.png" alt="\Sigma_1^{-1/2}U_1^TQ_2U_1\Sigma_1^{-1/2} = U_2\Sigma_2V_2^T."/></p>
</div><p>Now, <img class="math" src="_images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/> is defined as</p>
<div class="math" id="equation-simdiag3">
<p><span class="eqno">(25)</span><img src="_images/math/b8fd8ec4de863e538933814f8119653f05957963.png" alt="T = U_2^T \Sigma_1^{-1/2}U_1^T."/></p>
</div><p>If the biggest diagonal element (eigenvalue) of matrix <img class="math" src="_images/math/3c30c85dd92830e6eeba03429a3de1619a98365a.png" alt="D=TQ_2T^T"/>
is less than or equal to <img class="math" src="_images/math/dce34f4dfb2406144304ad0d6106c5382ddd1446.png" alt="1"/>,
<img class="math" src="_images/math/0eb8863783e03f5430af0160912fc20f07e0f722.png" alt="{\mathcal E}(0,Q_2)\subseteq{\mathcal E}(0,Q_1)"/>.</p>
<p>Once it is established that ellipsoid <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> is
bigger than ellipsoid <img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/>, we know that their
geometric difference
<img class="math" src="_images/math/a1062fcc8473fb7421323f2b926c485e48337e78.png" alt="{\mathcal E}(q_1,Q_1)\dot{-}{\mathcal E}(q_2,Q_2)"/> is a nonempty
convex compact set. Although it is not generally an ellipsoid, we can
find tight external and internal approximations of this set parametrized
by vector <img class="math" src="_images/math/46f0b658f423a1abfb55b768b599f0bdd795786b.png" alt="l\in{\bf R}^n"/>. Unlike geometric sum, however,
ellipsoidal approximations for the geometric difference do not exist for
every direction <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/>. Vectors for which the approximations do not
exist are called <em>bad directions</em>.</p>
<p>Given two ellipsoids <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> and
<img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/> with
<img class="math" src="_images/math/0eb8863783e03f5430af0160912fc20f07e0f722.png" alt="{\mathcal E}(0,Q_2)\subseteq{\mathcal E}(0,Q_1)"/>, <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> is a
bad direction if</p>
<div class="math">
<p><img src="_images/math/97a034a346a13ec0a32eb72a1a4e2af8df4a2bf3.png" alt="\frac{\langle l,Q_1l\rangle^{1/2}}{\langle l,Q_2l\rangle^{1/2}}&gt;r,"/></p>
</div><p>in which <img class="math" src="_images/math/b55ca7a0aa88ab7d58f4fc035317fdac39b17861.png" alt="r"/> is a minimal root of the equation</p>
<div class="math">
<p><img src="_images/math/36cef43b268c8b1d7c2ff143aa3e7ce2ec229771.png" alt="{\bf det}(Q_1-rQ_2) = 0."/></p>
</div><p>To find <img class="math" src="_images/math/b55ca7a0aa88ab7d58f4fc035317fdac39b17861.png" alt="r"/>, compute matrix <img class="math" src="_images/math/2554b6496c3b678897e9b060ef00aa9f0a7d7ece.png" alt="T"/> by <a href="#equation-simdiag1">(23)</a>-<a href="#equation-simdiag3">(25)</a>
and define</p>
<div class="math">
<p><img src="_images/math/78769870143bc4ae404820ed8515038371701c5c.png" alt="r = \frac{1}{\max({\bf diag}(TQ_2T^T))}."/></p>
</div><p>If <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> is <em>not</em> a bad direction, we can find tight external and
internal ellipsoidal approximations <img class="math" src="_images/math/cd820e0ffa361e49ddb20b48c10ef28e71eb33bd.png" alt="{\mathcal E}(q,Q^+_l)"/> and
<img class="math" src="_images/math/94f43cc848977a2501ef18eeb62f60f6c7e08d4c.png" alt="{\mathcal E}(q,Q^-_l)"/> such that</p>
<div class="math">
<p><img src="_images/math/ee7c4356b5cf1f8dda2ae13f831577457739e4be.png" alt="{\mathcal E}(q,Q^-_l)\subseteq{\mathcal E}(q_1,Q_1)\dot{-}{\mathcal E}(q_2,Q_2)\subseteq{\mathcal E}(q,Q^+_l)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/9ef4ba40b296e5f5580db88dc9ad4e01b9450313.png" alt="\rho(\pm l ~|~ {\mathcal E}(q,Q_l^-)) =
\rho(\pm l ~|~ {\mathcal E}(q_1,Q_1)\dot{-}{\mathcal E}(q_2,Q_2)) =
\rho(\pm l ~|~ {\mathcal E}(q,Q_l^+))."/></p>
</div><p>The center <img class="math" src="_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/> is</p>
<div class="math" id="equation-minkdiff_c">
<p><span class="eqno">(26)</span><img src="_images/math/5d64e144f884c1deefe994ab558b5e6bf32db0f4.png" alt="q = q_1 - q_2;"/></p>
</div><p>the shape matrix of the internal ellipsoid <img class="math" src="_images/math/e6a70802f10ac1eb9ca48e196d2cefb83a3c0ce1.png" alt="Q^-_l"/> is</p>
<div class="math">
<p><img src="_images/math/927b9b9b217d5bfc907bcfa669f9b910f8235083.png" alt="\begin{aligned}
&amp;&amp; P = \frac{\sqrt{\langle l, Q_1 l\rangle}}{\sqrt{\langle l, Q_2 \rangle}};\nonumber\\
&amp;&amp; Q^-_l = \left(1 - \dfrac{1}{P}\right)Q_1 + \left(1 - P\right)Q_2.
\label{minkdiff_ia}\end{aligned}"/></p>
</div><p>and the shape matrix of the external ellipsoid <img class="math" src="_images/math/2545b35ab32f3fe2286915cd5a6cf657d1609b23.png" alt="Q^+_l"/> is</p>
<div class="math" id="equation-minkdiff_ea">
<p><span class="eqno">(27)</span><img src="_images/math/0c75b04ff8f6b76af3c2814853854993c7857b61.png" alt="Q^+_l = \left(Q_1^{1/2} - SQ_2^{1/2}\right)^T
\left(Q_1^{1/2} - SQ_2^{1/2}\right)."/></p>
</div><p>Here <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> is an orthogonal matrix such that vectors
<img class="math" src="_images/math/0610ca673ec485925fbd1c600179fff9f22bca8c.png" alt="Q_1^{1/2}l"/> and <img class="math" src="_images/math/668ab12e6757a22530c09e76a96a386df2f078d5.png" alt="SQ_2^{1/2}l"/> are parallel. <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> is
found from <a href="#equation-valign1">(20)</a>-<a href="#equation-valign3">(22)</a>, with <img class="math" src="_images/math/7b678032d17c8758b9e52d50aecfd6c5b00c2e59.png" alt="v_1=Q_2^{1/2}l"/> and
<img class="math" src="_images/math/38cf7254ff127006e0a7de17fa5acc295c1a35f2.png" alt="v_2=Q_1^{1/2}l"/>.</p>
<p>Running <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> over all unit directions that are not bad, we get</p>
<div class="math">
<p><img src="_images/math/4ebe43a5f289916d71ff81ff5e22fff63c9b928f.png" alt="\bigcup_{\langle l,l\rangle=1} {\mathcal E}(q,Q_l^-) =
{\mathcal E}(q_1,Q_1)\dot{-}{\mathcal E}(q_2,Q_2) =
\bigcap_{\langle l,l\rangle=1} {\mathcal E}(q,Q_l^+) ."/></p>
</div><p>For proofs of formulas given in this section, see Kurzhanski and Vályi
(1997).</p>
</div>
<div class="section" id="geometric-difference-sum">
<h3>Geometric Difference-Sum<a class="headerlink" href="#geometric-difference-sum" title="Permalink to this headline">¶</a></h3>
<p>Given ellipsoids <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/>,
<img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/> and <img class="math" src="_images/math/e801b0c5b9bcd9cd4bb01a18125df635e8c4334f.png" alt="{\mathcal E}(q_3,Q_3)"/>, it is
possible to compute families of external and internal approximating
ellipsoids for</p>
<div class="math" id="equation-minkmp">
<p><span class="eqno">(28)</span><img src="_images/math/18b730b1ebf285f666e9bc96b6db5d84e2335d99.png" alt="{\mathcal E}(q_1,Q_1) \dot{-} {\mathcal E}(q_2,Q_2) \oplus {\mathcal E}(q_3,Q_3)"/></p>
</div><p>parametrized by direction <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/>, if this set is nonempty
(<img class="math" src="_images/math/0eb8863783e03f5430af0160912fc20f07e0f722.png" alt="{\mathcal E}(0,Q_2)\subseteq{\mathcal E}(0,Q_1)"/>).</p>
<p>First, using the result of the previous section, for any direction
<img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> that is not bad, we obtain tight external
<img class="math" src="_images/math/1ef94097826575e4dfc04c90cf96561350639dd4.png" alt="{\mathcal E}(q_1-q_2, Q_l^{0+})"/> and internal
<img class="math" src="_images/math/4e009ebaa189c3fca73a1ae72a3799282b4190d5.png" alt="{\mathcal E}(q_1-q_2, Q_l^{0-})"/> approximations of the set
<img class="math" src="_images/math/a1062fcc8473fb7421323f2b926c485e48337e78.png" alt="{\mathcal E}(q_1,Q_1)\dot{-}{\mathcal E}(q_2,Q_2)"/>.</p>
<p>The second and last step is, using the result of section 2.2.2, to find
tight external ellipsoidal approximation
<img class="math" src="_images/math/4462fb7eecf6724146bf9f4fa7af6c8c3670a6e1.png" alt="{\mathcal E}(q_1-q_2+q_3,Q_l^+)"/> of the sum
<img class="math" src="_images/math/53027abc3cf3e1423650b4e48260b8570d5412d9.png" alt="{\mathcal E}(q_1-q_2,Q_l^{0+})\oplus{\mathcal E}(q_3,Q_3)"/>, and
tight internal ellipsoidal approximation
<img class="math" src="_images/math/6ff4660e3e35dcfa926196d592eee77b5fabce5a.png" alt="{\mathcal E}(q_1-q_2+q_3,Q_l^-)"/> for the sum
<img class="math" src="_images/math/ab7ed77843bb59354a4a55db1eb75375256fa9d1.png" alt="{\mathcal E}(q_1-q_2,Q_l^{0-})\oplus{\mathcal E}(q_3,Q_3)"/>.</p>
<p>As a result, we get</p>
<div class="math">
<p><img src="_images/math/13a8ba3580848f7360e11f7be94ab92fd74a060c.png" alt="{\mathcal E}(q_1-q_2+q_3,Q_l^-) \subseteq
{\mathcal E}(q_1,Q_1)\dot{-}{\mathcal E}(q_2,Q_2)\oplus{\mathcal E}(q_3,Q_3) \subseteq
{\mathcal E}(q_1-q_2+q_3,Q_l^+)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/37207e8e5c0e01f19b741292ee0b8a39ceb6988b.png" alt="\rho(\pm l ~|~{\mathcal E}(q_1-q_2+q_3,Q_l^-)) =
\rho(\pm l ~|~ {\mathcal E}(q_1,Q_1)\dot{-}{\mathcal E}(q_2,Q_2)\oplus{\mathcal E}(q_3,Q_3)) =
\rho(\pm l ~|~ {\mathcal E}(q_1-q_2+q_3,Q_l^+))."/></p>
</div><p>Running <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> over all unit vectors that are not bad, this
translates to</p>
<div class="math">
<p><img src="_images/math/089ab400ac9f3e21ec9f6ce0e670be322101fd23.png" alt="\bigcup_{\langle l,l\rangle=1} {\mathcal E}(q_1-q_2+q_3,Q_l^-) =
{\mathcal E}(q_1,Q_1)\dot{-}{\mathcal E}(q_2,Q_2)\oplus{\mathcal E}(q_3,Q_3) =
\bigcap_{\langle l,l\rangle=1} {\mathcal E}(q_1-q_2+q_3,Q_l^+) ."/></p>
</div></div>
<div class="section" id="geometric-sum-difference">
<h3>Geometric Sum-Difference<a class="headerlink" href="#geometric-sum-difference" title="Permalink to this headline">¶</a></h3>
<p>Given ellipsoids <img class="math" src="_images/math/d64bd729074d0b5a8a33a399cc181376a1414224.png" alt="{\mathcal E}(q_1,Q1)"/>,
<img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/> and <img class="math" src="_images/math/e801b0c5b9bcd9cd4bb01a18125df635e8c4334f.png" alt="{\mathcal E}(q_3,Q_3)"/>, it is
possible to compute families of external and internal approximating
ellipsoids for</p>
<div class="math" id="equation-minkpm">
<p><span class="eqno">(29)</span><img src="_images/math/c4e20bb3a2240c28a54a23fef1ce607a16963f8d.png" alt="{\mathcal E}(q_1,Q_1) \oplus {\mathcal E}(q_2,Q_2) \dot{-} {\mathcal E}(q_3,Q_3)"/></p>
</div><p>parametrized by direction <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/>, if this set is nonempty
(<img class="math" src="_images/math/f71e4a98ac552649614e93ace2f7ef8d74f74c80.png" alt="{\mathcal E}(0,Q_3)\subseteq{\mathcal E}(0,Q_1)\oplus{\mathcal E}(0,Q_2)"/>).</p>
<p>First, using the result of section 2.2.2, we obtain tight external
<img class="math" src="_images/math/ca4197f531cc684e5df7e43051f370569f8da334.png" alt="{\mathcal E}(q_1+q_2,Q_l^{0+})"/> and internal
<img class="math" src="_images/math/35ecffe9f99d6b61180fc167c1e6da7ac0325f89.png" alt="{\mathcal E}(q_1+q_2,Q_l^{0-})"/> ellipsoidal approximations of the
set <img class="math" src="_images/math/22f8fe42b513ea5a08cd9b122594357b0c1a2663.png" alt="{\mathcal E}(q_1,Q_1)\oplus{\mathcal E}(q_2,Q_2)"/>. In order
for the set <a href="#equation-minkpm">(29)</a> to be nonempty, inclusion
<img class="math" src="_images/math/607e37b9805c9cd4e5c27f82eb29ae5cd1cc64b9.png" alt="{\mathcal E}(0,Q_3)\subseteq{\mathcal E}(0,Q_l^{0+})"/> must be
true for any <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/>. Note, however, that even if <a href="#equation-minkpm">(29)</a> is
nonempty, it may be that
<img class="math" src="_images/math/f420790dc001fa2c5fff0ee3086eb2c8d599bc3f.png" alt="{\mathcal E}(0,Q_3)\not\subseteq{\mathcal E}(0,Q_l^{0-})"/>, then
internal approximation for this direction does not exist.</p>
<p>Assuming that <a href="#equation-minkpm">(29)</a> is nonempty and
<img class="math" src="_images/math/46fc27c9ce4a42e7e55da298fd0f82a908f7f103.png" alt="{\mathcal E}(0,Q_3)\subseteq{\mathcal E}(0,Q_l^{0-})"/>, the second
step would be, using the results of section 2.2.3, to compute tight
external ellipsoidal approximation
<img class="math" src="_images/math/3ffc2f5a528c97c04ac8524e90272cdb242ce196.png" alt="{\mathcal E}(q_1+q_2-q_3,Q_l^+)"/> of the difference
<img class="math" src="_images/math/68038150ae9c7e61ad5744981e022edbdca8b4f6.png" alt="{\mathcal E}(q_1+q_2,Q_l^{0+})\dot{-}{\mathcal E}(q_3,Q_3)"/>,
which exists only if <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> is not bad, and tight internal
ellipsoidal approximation <img class="math" src="_images/math/261420092537a7308bd401582a05cc558a987142.png" alt="{\mathcal E}(q_1+q_2-q_3,Q_l^-)"/> of the
difference
<img class="math" src="_images/math/e35ccb2407ac3d3308fbf9889afc5d2193f76838.png" alt="{\mathcal E}(q_1+q_2,Q_l^{0-})\dot{-}{\mathcal E}(q_3,Q_3)"/>,
which exists only if <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> is not bad for this difference.</p>
<p>If approximation <img class="math" src="_images/math/3ffc2f5a528c97c04ac8524e90272cdb242ce196.png" alt="{\mathcal E}(q_1+q_2-q_3,Q_l^+)"/> exists, then</p>
<div class="math">
<p><img src="_images/math/0c1ba2d8e7e9ab0a8814a544dfc76904bdc2eced.png" alt="{\mathcal E}(q_1,Q_1)\oplus{\mathcal E}(q_2,Q_2)\dot{-}{\mathcal E}(q_3,Q_3) \subseteq
{\mathcal E}(q_1+q_2-q_3,Q_l^+)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/b7585008f0f54f5ccddb78aa4c40194c26db3520.png" alt="\rho(\pm l ~|~ {\mathcal E}(q_1,Q_1)\oplus{\mathcal E}(q_2,Q_2)\dot{-}{\mathcal E}(q_3,Q_3)) =
\rho(\pm l ~|~ {\mathcal E}(q_1+q_2-q_3,Q_l^+))."/></p>
</div><p>If approximation <img class="math" src="_images/math/261420092537a7308bd401582a05cc558a987142.png" alt="{\mathcal E}(q_1+q_2-q_3,Q_l^-)"/> exists, then</p>
<div class="math">
<p><img src="_images/math/4b42ae8607e2e5fc7ff37a5d4ff33d4510998e80.png" alt="{\mathcal E}(q_1+q_2-q_3,Q_l^-) \subseteq
{\mathcal E}(q_1,Q_1)\oplus{\mathcal E}(q_2,Q_2)\dot{-}{\mathcal E}(q_3,Q_3)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/780adc0e33adf507a793ee814169a0c980d2f59f.png" alt="\rho(\pm l ~|~{\mathcal E}(q_1+q_2-q_3,Q_l^-)) =
\rho(\pm l ~|~ {\mathcal E}(q_1,Q_1)\oplus{\mathcal E}(q_2,Q_2)\dot{-}{\mathcal E}(q_3,Q_3)) ."/></p>
</div><p>For any fixed direction <img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> it may be the case that neither
external nor internal tight ellipsoidal approximations exist.</p>
</div>
<div class="section" id="intersection-of-ellipsoid-and-hyperplane">
<h3>Intersection of Ellipsoid and Hyperplane<a class="headerlink" href="#intersection-of-ellipsoid-and-hyperplane" title="Permalink to this headline">¶</a></h3>
<p>Let nondegenerate ellipsoid <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> and hyperplane
<img class="math" src="_images/math/bac0ae63aec09971dd9b5d57245fb790377c8e10.png" alt="H(c,\gamma)"/> be such that
<img class="math" src="_images/math/960abeff20941af75ff673a99d0c9e44f84dde48.png" alt="{\bf dist}({\mathcal E}(q,Q),H(c,\gamma))&lt;0"/>. In other words,</p>
<div class="math">
<p><img src="_images/math/34a288533d1fd5a236dd0b66e6f2609d964d7363.png" alt="{\mathcal E}_H(w,W) = {\mathcal E}(q,Q)\cap H(c,\gamma) \neq \emptyset ."/></p>
</div><p>The intersection of ellipsoid with hyperplane, if nonempty, is always
an ellipsoid. Here we show how to find it.</p>
<p>First of all, we transform the hyperplane <img class="math" src="_images/math/bac0ae63aec09971dd9b5d57245fb790377c8e10.png" alt="H(c,\gamma)"/> into
<img class="math" src="_images/math/538a531654c5a33f2dee65b42f2ceee1e7bcb093.png" alt="H([1~0~\cdots~0]^T, 0)"/> by the affine transformation</p>
<div class="math">
<p><img src="_images/math/d5bd0c58db744683f21ef68d1fa0b9f92f2362a2.png" alt="y = Sx - \frac{\gamma}{\langle c,c\rangle^{1/2}}Sc,"/></p>
</div><p>where <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> is an orthogonal matrix found by <a href="#equation-valign1">(20)</a>-<a href="#equation-valign3">(22)</a>
with <img class="math" src="_images/math/c7e77feae9e86880d314fe3a51f4e851d78e25e9.png" alt="v_1=c"/> and <img class="math" src="_images/math/e2a4206b0fc420afa156e56f648b0700ce6fbf8e.png" alt="v_2=[1~0~\cdots~0]^T"/>. The ellipsoid in
the new coordinates becomes <img class="math" src="_images/math/0833a0c6e7ed9439d370589e5c64e3f7b7359851.png" alt="{\mathcal E}(q',Q')"/> with</p>
<div class="math">
<p><img src="_images/math/9601bfdb03a243b97f39ab40b3979d6912c3798b.png" alt="\begin{aligned}
q' &amp; = q-\frac{\gamma}{\langle c,c\rangle^{1/2}}Sc, \\
Q' &amp; = SQS^T.\end{aligned}"/></p>
</div><p>Define matrix <img class="math" src="_images/math/b3911b40f8b909842d24b7d89020040d1afb8cbc.png" alt="M=Q'^{-1}"/>; <img class="math" src="_images/math/cacb608f7e428f64c8e4dbffdb5dd69848201f7c.png" alt="m_{11}"/> is its element in
position <img class="math" src="_images/math/ae7a465ffe5255961382f5777569608be052b783.png" alt="(1,1)"/>, <img class="math" src="_images/math/7f98826dc08a1a0b01b31e030bba573e93beae08.png" alt="\bar{m}"/> is the first column of <img class="math" src="_images/math/5d1e4485dc90c450e8c76826516c1b2ccb8fce16.png" alt="M"/>
without the first element, and <img class="math" src="_images/math/dce332cba90a1411dc2b4411f6845273bdca8373.png" alt="\bar{M}"/> is the submatrix of
<img class="math" src="_images/math/5d1e4485dc90c450e8c76826516c1b2ccb8fce16.png" alt="M"/> obtained by stripping <img class="math" src="_images/math/5d1e4485dc90c450e8c76826516c1b2ccb8fce16.png" alt="M"/> of its first row and first
column:</p>
<div class="math">
<p><img src="_images/math/190dd89a565e4cbf5e8f76193e5a86101c1457eb.png" alt="M = \left[\begin{array}{c|cl}
m_{11} &amp; &amp; \bar{m}^T\\
 &amp; \\
\hline
 &amp; \\
\bar{m} &amp; &amp; \bar{M}\end{array}\right]."/></p>
</div><p>The ellipsoid resulting from the intersection is
<img class="math" src="_images/math/c3563f03f3e8adac231b8f2cf4b1662d62c5228f.png" alt="{\mathcal E}_H(w',W')"/> with</p>
<div class="math">
<p><img src="_images/math/1f461c17d20992f2431d22c78516f852193d069a.png" alt="\begin{aligned}
w' &amp; = q' + q_1'\left[\begin{array}{c}
-1\\
\bar{M}^{-1}\bar{m}\end{array}\right],\\
W' &amp; = \left(1-q_1'^2(m_{11}-
\langle\bar{m},\bar{M}^{-1}\bar{m}\rangle)\right)\left[\begin{array}{c|cl}
0 &amp; &amp; {\bf 0}\\
 &amp; \\
\hline
 &amp; \\
{\bf 0} &amp; &amp; \bar{M}^{-1}\end{array}\right],\end{aligned}"/></p>
</div><p>in which <img class="math" src="_images/math/73efdb7b737442181a9e072451110446ce984dfa.png" alt="q_1'"/> represents the first element of vector <img class="math" src="_images/math/af36faec8fe9f30065aa2bd1cc4c000f7efa1b7c.png" alt="q'"/>.</p>
<p>Finally, it remains to do the inverse transform of the coordinates to
obtain ellipsoid <img class="math" src="_images/math/be5c023aff92e6173fea63995f6a126af6e9a6cf.png" alt="{\mathcal E}_H(w,W)"/>:</p>
<div class="math">
<p><img src="_images/math/75e591e33f13cf53c53cdea8c00b0c4bb253bff2.png" alt="\begin{aligned}
w &amp; = S^Tw' + \frac{\gamma}{\langle c,c\rangle^{1/2}}c, \\
W &amp; = S^TW'S.\end{aligned}"/></p>
</div></div>
<div class="section" id="intersection-of-ellipsoid-and-ellipsoid">
<h3>Intersection of Ellipsoid and Ellipsoid<a class="headerlink" href="#intersection-of-ellipsoid-and-ellipsoid" title="Permalink to this headline">¶</a></h3>
<p>Given two nondegenerate ellipsoids <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> and
<img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/>,
<img class="math" src="_images/math/59fb99c011fcc8b05131f1db86a730a857b24961.png" alt="{\bf dist}({\mathcal E}(q_1,Q_1),{\mathcal E}(q_2,Q_2))&lt;0"/>
implies that</p>
<div class="math">
<p><img src="_images/math/9385b7a27e79a1d0b5dab8b1bcec110322a82b17.png" alt="{\mathcal E}(q_1,Q_1)\cap{\mathcal E}(q_2,Q_2)\neq\emptyset ."/></p>
</div><p>This intersection can be approximated by ellipsoids from the outside
and from the inside. Trivially, both <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> and
<img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/> are external approximations of this
intersection. Here, however, we show how to find the external
ellipsoidal approximation of minimal volume.</p>
<p>Define matrices</p>
<div class="math">
<p><img src="_images/math/75f514382b9b7715453564228efdd3c918a6bf58.png" alt="W_1 = Q_1^{-1}, ~~~~ W_2 = Q_2^{-1} .\label{wmatrices}"/></p>
</div><p>Minimal volume external ellipsoidal approximation
<img class="math" src="_images/math/6f3fb6a018d954f619ca08b95ca2b8feb7fe23a0.png" alt="{\mathcal E}(q+,Q^+)"/> of the intersection
<img class="math" src="_images/math/03d373897663dd503f63646a563bb94f9100dd33.png" alt="{\mathcal E}(q_1,Q_1)\cap{\mathcal E}(q_2,Q_2)"/> is determined
from the set of equations:</p>
<div class="math" id="equation-fusion1">
<p><span class="eqno">(30)</span><img src="_images/math/90c47ab0eb5d1569efb1a2200ed641c1adc18c58.png" alt="Q^+  = \alpha X^{-1}, \\"/></p>
</div><div class="math" id="equation-fusion2">
<p><span class="eqno">(31)</span><img src="_images/math/91872ea2c902eca556ed0ffc7accdb731bcb3bcd.png" alt="X  =  \pi W_1 + (1-\pi)W_2,\\"/></p>
</div><div class="math" id="equation-fusion3">
<p><span class="eqno">(32)</span><img src="_images/math/164e4f04a283b442e239bdefd09ff5f9beb3f089.png" alt="\alpha  =  1-\pi(1-\pi)\langle(q_2-q_1), W_2X^{-1}W_1(q_2-q_1)\rangle, \\"/></p>
</div><div class="math" id="equation-fusion4">
<p><span class="eqno">(33)</span><img src="_images/math/dd793f4a85c802cf2686d6478cbdae7840742456.png" alt="q^+  = X^{-1}(\pi W_1q_1 + (1-\pi)W_2q_2), \\"/></p>
</div><div class="math" id="equation-fusion5">
<p><span class="eqno">(34)</span><img src="_images/math/36a8e498ac3c5202f5ff3f1b6d178f033dc64ad9.png" alt="0 &amp;=  \alpha({\bf det}(X))^2{\bf trace}(X^{-1}(W_1-W_2)) - {}\\
  &amp;- n({\bf det}(X))^2 (2\langle q^+,W_1q_1-W_2q_2\rangle + \langle q^+,(W_2-W_1)q^+\rangle - {}\\
  &amp;- \langle q_1,W_1q_1\rangle + \langle q_2,W_2q_2\rangle),"/></p>
</div><p>with <img class="math" src="_images/math/588e5eb4a0e6e811eb3e3d5e84dc5d22d0b0d225.png" alt="0\leqslant\pi\leqslant1"/>. We substitute <img class="math" src="_images/math/6a47ca0fe7cb276abc022af6ac88ddae1a9d6894.png" alt="X"/>,
<img class="math" src="_images/math/10f32377ac67d94f764f12a15ea987e88c85d3e1.png" alt="\alpha"/>, <img class="math" src="_images/math/8115a6cdfb5aa5187072882f9e19d0bdcb60fc66.png" alt="q^+"/> defined in <a href="#equation-fusion2">(31)</a>-<a href="#equation-fusion4">(33)</a> into
<a href="#equation-fusion5">(34)</a> and get a polynomial of degree <img class="math" src="_images/math/2f9a96c63183be91b9fe70e6e16dfa4bfec6f3da.png" alt="2n-1"/> with respect to
<img class="math" src="_images/math/f2ca003a7da0de4994b4733e203b74ff52d42553.png" alt="\pi"/>, which has only one root in the interval <img class="math" src="_images/math/e861e10e1c19918756b9c8b7717684593c63aeb8.png" alt="[0,1]"/>,
<img class="math" src="_images/math/26b68eda95285a191312843b6a5c617bfb56220e.png" alt="\pi_0"/>. Then, substituting <img class="math" src="_images/math/0443fdfcf3f8d39e7187581b56ae165eaaffdb25.png" alt="\pi=\pi_0"/> into
<a href="#equation-fusion1">(30)</a>-<a href="#equation-fusion4">(33)</a>, we obtain <img class="math" src="_images/math/8115a6cdfb5aa5187072882f9e19d0bdcb60fc66.png" alt="q^+"/> and <img class="math" src="_images/math/3c23a630bf907d9d794d0c6b9aef29782abf3bac.png" alt="Q^+"/>. Special
cases are <img class="math" src="_images/math/03b577d315bafcc0368eb1f51b7e4cac353890bf.png" alt="\pi_0=1"/>, whence
<img class="math" src="_images/math/2ede8b370de23b72578537a377e45c50a826172d.png" alt="{\mathcal E}(q^+,Q^+)={\mathcal E}(q_1,Q_1)"/>, and
<img class="math" src="_images/math/8617810f9ac8ba407326425156df072f64474881.png" alt="\pi_0=0"/>, whence
<img class="math" src="_images/math/0543ddabd0acb31d7afa2a83df88031794f1782a.png" alt="{\mathcal E}(q^+,Q^+)={\mathcal E}(q_2,Q_2)"/>. These situations
may occur if, for example, one ellipsoid is contained in the other:</p>
<div class="math">
<p><img src="_images/math/ec4e1b80a56dd9005e2bc69462cd5ed53390d5a9.png" alt="{\mathcal E}(q_1,Q_1)\subseteq{\mathcal E}(q_2,Q_2) &amp; \Rightarrow \pi_0 = 1,\\
{\mathcal E}(q_2,Q_2)\subseteq{\mathcal E}(q_1,Q_1) &amp; \Rightarrow \pi_0 = 0."/></p>
</div><p>The proof that the system of equations <a href="#equation-fusion1">(30)</a>-<a href="#equation-fusion5">(34)</a> correctly
defines the minimal volume external ellipsoidal approximationi of the
intersection <img class="math" src="_images/math/03d373897663dd503f63646a563bb94f9100dd33.png" alt="{\mathcal E}(q_1,Q_1)\cap{\mathcal E}(q_2,Q_2)"/> is
given in L. Ros (2002).</p>
<p>To find the internal approximating ellipsoid
<img class="math" src="_images/math/144f9fdd80aca5fb8d72791d188b3726506cb213.png" alt="{\mathcal E}(q^-,Q^-)\subseteq{\mathcal E}(q_1,Q_1)\cap{\mathcal E}(q_2,Q_2)"/>,
define</p>
<div class="math" id="equation-beta1">
<p><span class="eqno">(35)</span><img src="_images/math/c192001b77e5c23e7cb3542269ac22c480bcf6e5.png" alt="\beta_1 = \min_{\langle x,W_2x\rangle=1}\langle x,W_1x\rangle,"/></p>
</div><div class="math" id="equation-beta2">
<p><span class="eqno">(36)</span><img src="_images/math/3a46c9290c97fc06adac11c8033700dea5e4850b.png" alt="\beta_2 = \min_{\langle x,W_1x\rangle=1}\langle x,W_2x\rangle,"/></p>
</div><p>Notice that <a href="#equation-beta1">(35)</a> and <a href="#equation-beta2">(36)</a> are QCQP problems. Parameters
<img class="math" src="_images/math/8aae8c9070619089c2670823feb61568c0b3b625.png" alt="\beta_1"/> and <img class="math" src="_images/math/dbf1237726889bb1c003a859c455ede1e20e5381.png" alt="\beta_2"/> are invariant with respect to affine
coordinate transformation and describe the position of ellipsoids
<img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/>, <img class="math" src="_images/math/5dab2798851c8408cf12b09c6587412701b3a32a.png" alt="{\mathcal E}(q_2,Q_2)"/> with
respect to each other:</p>
<div class="math">
<p><img src="_images/math/7c03a765cb1b25fd1f45a4c98464a5aa055ea900.png" alt="\beta_1\geqslant1,~\beta_2\geqslant1 &amp; \Rightarrow
{\bf int}({\mathcal E}(q_1,Q_1)\cap{\mathcal E}(q_2,Q_2))=\emptyset, \\

\beta_1\geqslant1,~\beta_2\leqslant1 &amp; \Rightarrow {\mathcal E}(q_1,Q_1)\subseteq{\mathcal E}(q_2,Q_2), \\

\beta_1\leqslant1,~\beta_2\geqslant1 &amp; \Rightarrow {\mathcal E}(q_2,Q_2)\subseteq{\mathcal E}(q_1,Q_1), \\

\beta_1&lt;1,~\beta_2&lt;1 &amp; \Rightarrow
{\bf int}({\mathcal E}(q_1,Q_1)\cap{\mathcal E}(q_2,Q_2))\neq\emptyset \\

&amp;\mbox{and} ~ {\mathcal E}(q_1,Q_1)\not\subseteq{\mathcal E}(q_2,Q_2) \\

&amp;\mbox{and} ~ {\mathcal E}(q_2,Q_2)\not\subseteq{\mathcal E}(q_1,Q_1)."/></p>
</div><p>Define parametrized family of internal ellipsoids
<img class="math" src="_images/math/a0552947ec005fb9471cf25cf3b187b67e0bba1a.png" alt="{\mathcal E}(q^-_{\theta_1\theta_2},Q^-_{\theta_1\theta_2})"/> with</p>
<div class="math" id="equation-paramell1">
<p><span class="eqno">(37)</span><img src="_images/math/8d07b42c9c1ca1027172d899fb54a1040e7beebe.png" alt="q^-_{\theta_1\theta_2}  =  (\theta_1W_1 +
\theta_2W_2)^{-1}(\theta_1W_1q_1 + \theta_2W_2q_2),\\"/></p>
</div><div class="math" id="equation-paramell2">
<p><span class="eqno">(38)</span><img src="_images/math/77fb22f46390ba2708d754c801dddc44659f7fbb.png" alt="Q^-_{\theta_1\theta_2} =  (1 - \theta_1\langle q_1,W_1q_1\rangle -
\theta_2\langle q_2,W_2q_2\rangle +
\langle q^-_{\theta_1\theta_2},(Q^-)^{-1}q^-_{\theta_1\theta_2}\rangle)
(\theta_1W_1 + \theta_2W_2)^{-1} ."/></p>
</div><p>The best internal ellipsoid
<img class="math" src="_images/math/cd24775d43d17ae8df736ba8d1aa6785677f4b10.png" alt="{\mathcal E}(q^-_{\hat{\theta}_1\hat{\theta}_2},Q^-_{\hat{\theta}_1\hat{\theta}_2})"/>
in the class <a href="#equation-paramell1">(37)</a>-<a href="#equation-paramell2">(38)</a>, namely, such that</p>
<div class="math">
<p><img src="_images/math/398e36e334b245dd32ad477be68a32ebd5698d1a.png" alt="{\mathcal E}(q^-_{{\theta}_1{\theta}_2},Q^-_{{\theta}_1{\theta}_2})\subseteq
{\mathcal E}(q^-_{\hat{\theta}_1\hat{\theta}_2},Q^-_{\hat{\theta}_1\hat{\theta}_2})
\subseteq {\mathcal E}(q_1,Q_1)\cap{\mathcal E}(q_2,Q_2)"/></p>
</div><p>for all <img class="math" src="_images/math/bfe434b73c33d8d1d4c7103cd85b59cad839b346.png" alt="0\leqslant\theta_1,\theta_2\leqslant1"/>, is specified by
the parameters</p>
<div class="math" id="equation-thetapar">
<p><span class="eqno">(39)</span><img src="_images/math/c385e2f68f0a5bbaaccf181e3ed8d8ad860627ea.png" alt="\hat{\theta}_1 = \frac{1-\hat{\beta}_2}{1-\hat{\beta}_1\hat{\beta}_2}, ~~~~
\hat{\theta}_2 = \frac{1-\hat{\beta}_1}{1-\hat{\beta}_1\hat{\beta}_2},"/></p>
</div><p>with</p>
<div class="math">
<p><img src="_images/math/fa8d62c5c25dddb9f5ee0f2d640ac3bc21690f38.png" alt="\hat{\beta}_1=\min(1,\beta_1), ~~~~ \hat{\beta}_2=\min(1,\beta_2)."/></p>
</div><p>It is the ellipsoid that we look for:
<img class="math" src="_images/math/d49118ee57fdc9d8e6ebf39c7d488a9db8e3bf78.png" alt="{\mathcal E}(q^-,Q^-)={\mathcal E}(q^-_{\hat{\theta}_1\hat{\theta}_2},Q^-_{\hat{\theta}_1\hat{\theta}_2})"/>.
Two special cases are</p>
<div class="math">
<p><img src="_images/math/de3147d93dbea5a33a7a66c8ba2d0049c92a5b96.png" alt="\hat{\theta}_1=1, ~ \hat{\theta}_2=0 ~~~ \Rightarrow ~~~
{\mathcal E}(q_1,Q_1)\subseteq{\mathcal E}(q_2,Q_2) ~~~ \Rightarrow ~~~
{\mathcal E}(q^-,Q^-)={\mathcal E}(q_1,Q_1),"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/68294c7e975e126209c40f7ba4d3a9ce58040947.png" alt="\hat{\theta}_1=0, ~ \hat{\theta}_2=1 ~~~ \Rightarrow ~~~
{\mathcal E}(q_2,Q_2)\subseteq{\mathcal E}(q_1,Q_1) ~~~ \Rightarrow ~~~
{\mathcal E}(q^-,Q^-)={\mathcal E}(q_2,Q_2)."/></p>
</div><p>The method of finding the internal ellipsoidal approximation of the
intersection of two ellipsoids is described in Vazhentsev (1999).</p>
</div>
<div class="section" id="intersection-of-ellipsoid-and-halfspace">
<h3>Intersection of Ellipsoid and Halfspace<a class="headerlink" href="#intersection-of-ellipsoid-and-halfspace" title="Permalink to this headline">¶</a></h3>
<p>Finding the intersection of ellipsoid and halfspace can be reduced to
finding the intersection of two ellipsoids, one of which is unbounded.
Let <img class="math" src="_images/math/ea744f811759be7c88b5262e9d0a740984c595a0.png" alt="{\mathcal E}(q_1,Q_1)"/> be a nondegenerate ellipsoid and let
<img class="math" src="_images/math/bac0ae63aec09971dd9b5d57245fb790377c8e10.png" alt="H(c,\gamma)"/> define the halfspace</p>
<div class="math">
<p><img src="_images/math/91b75e4a78ee85720d81e8fa008b7a8dab883f70.png" alt="{\bf S}(c,\gamma) = \{x\in{\bf R}^n ~|~ \langle c,x\rangle\leqslant\gamma\}."/></p>
</div><p>We have to determine if the intersection
<img class="math" src="_images/math/66b423e5f770dd427e5f2d899c1ccc04ae72a34a.png" alt="{\mathcal E}(q_1,Q_1)\cap{\bf S}(c,\gamma)"/> is empty, and if not,
find its external and internal ellipsoidal approximations,
<img class="math" src="_images/math/c6ac73b524d3caadd8af57a8f7f97ed9de81a50b.png" alt="{\mathcal E}(q^+,Q^+)"/> and <img class="math" src="_images/math/61e19923678e2b76cc85e1c8ffaba981335809bf.png" alt="{\mathcal E}(q^-,Q^-)"/>. Two
trivial situations are:</p>
<ul class="simple">
<li><img class="math" src="_images/math/336e0eb12c2ce5a4cac6474f53150500c6617aa7.png" alt="{\bf dist}({\mathcal E}(q_1,Q_1),H(c,\gamma))&gt;0"/> and
<img class="math" src="_images/math/5f43a190337d6c722ea7016c86ea7816ddfff121.png" alt="\langle c, q_1\rangle&gt;0"/>, which implies that
<img class="math" src="_images/math/8aaee947e622b026b5b4bd96c21a040e2691d56a.png" alt="{\mathcal E}(q_1,Q_1)\cap{\bf S}(c,\gamma)=\emptyset"/>;</li>
<li><img class="math" src="_images/math/336e0eb12c2ce5a4cac6474f53150500c6617aa7.png" alt="{\bf dist}({\mathcal E}(q_1,Q_1),H(c,\gamma))&gt;0"/> and
<img class="math" src="_images/math/8f7c265901ac9e9111bf38630048c160c51aeb96.png" alt="\langle c, q_1\rangle&lt;0"/>, so that
<img class="math" src="_images/math/e1ce5f2fe06e7d9e7623337c1b7e0b94c9ba7cff.png" alt="{\mathcal E}(q_1,Q_1)\subseteq{\bf S}(c,\gamma)"/>, and then
<img class="math" src="_images/math/7cd9b45854804578b3e112d6e7f61619c7d54ed8.png" alt="{\mathcal E}(q^+,Q^+)={\mathcal E}(q^-,Q^-)={\mathcal E}(q_1,Q_1)"/>.</li>
</ul>
<p>In case <img class="math" src="_images/math/21a19a28bf0b23176729cb9d9d3f40a7ac48f227.png" alt="{\bf dist}({\mathcal E}(q_1,Q_1),H(c,\gamma)&lt;0"/>, i.e. the
ellipsoid intersects the hyperplane,</p>
<div class="math">
<p><img src="_images/math/745d68164fa2b0732fedd3aa49318c109db6050a.png" alt="{\mathcal E}(q_1,Q_1)\cap{\bf S}(c,\gamma) =
{\mathcal E}(q_1,Q_1)\cap\{x ~|~ \langle (x-q_2),W_2(x-q_2)\rangle\leqslant1\},"/></p>
</div><p>with</p>
<div class="math" id="equation-hsell1">
<p><span class="eqno">(40)</span><img src="_images/math/f1e9a53a34c33b6aa1c85b8e0fc10c33805f5e2e.png" alt="q_2  =  (\gamma + 2\sqrt{\overline{\lambda}})c,\\"/></p>
</div><div class="math" id="equation-hsell2">
<p><span class="eqno">(41)</span><img src="_images/math/f4af9cd50f7750a588ea3c8277156dd7566a1cfa.png" alt="W_2  =  \frac{1}{4\overline{\lambda}}cc^T,"/></p>
</div><p><img class="math" src="_images/math/efaa2f210aa07e2e2a4863aadd9b250c31529351.png" alt="\overline{\lambda}"/> being the biggest eigenvalue of matrix
<img class="math" src="_images/math/c16e423c8f499e0bef8c20078b04126aeb9417bc.png" alt="Q_1"/>. After defining <img class="math" src="_images/math/178adf4675bee5fd8085466794690641a4899025.png" alt="W_1=Q_1^{-1}"/>, we obtain
<img class="math" src="_images/math/c6ac73b524d3caadd8af57a8f7f97ed9de81a50b.png" alt="{\mathcal E}(q^+,Q^+)"/> from equations <a href="#equation-fusion1">(30)</a>-<a href="#equation-fusion5">(34)</a>, and
<img class="math" src="_images/math/61e19923678e2b76cc85e1c8ffaba981335809bf.png" alt="{\mathcal E}(q^-,Q^-)"/> from <a href="#equation-paramell1">(37)</a>-<a href="#equation-paramell2">(38)</a>,
<a href="#equation-thetapar">(39)</a>.</p>
<p><strong>Remark.</strong> Notice that matrix <img class="math" src="_images/math/fe6a61c0adf995408d4c70c51d35f9798bc472c6.png" alt="W_2"/> has rank <img class="math" src="_images/math/dce34f4dfb2406144304ad0d6106c5382ddd1446.png" alt="1"/>, which
makes it singular for <img class="math" src="_images/math/65262bf247c4a3c6114a8223d249dc9702619d3e.png" alt="n&gt;1"/>. Nevertheless, expressions
<a href="#equation-fusion1">(30)</a>-<a href="#equation-fusion2">(31)</a>, <a href="#equation-paramell1">(37)</a>-<a href="#equation-paramell2">(38)</a> make sense because
<img class="math" src="_images/math/08ae12b69f1364e6f0aa693d2a051b17383ea82a.png" alt="W_1"/> is nonsingular, <img class="math" src="_images/math/25e6e407a20e07e2e0f499bf2c562a5713af0a3c.png" alt="\pi_0\neq0"/> and
<img class="math" src="_images/math/1d80425775e59cb07f7391a800bd102adc4014c9.png" alt="\hat{\theta}_1\neq0"/>.</p>
<p>To find the ellipsoidal approximations <img class="math" src="_images/math/c6ac73b524d3caadd8af57a8f7f97ed9de81a50b.png" alt="{\mathcal E}(q^+,Q^+)"/> and
<img class="math" src="_images/math/61e19923678e2b76cc85e1c8ffaba981335809bf.png" alt="{\mathcal E}(q^-,Q^-)"/> of the intersection of ellipsoid
<img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> and polytope <img class="math" src="_images/math/7df7554bc8b905a14d174aa3078a101032004660.png" alt="P(C,g)"/>,
<img class="math" src="_images/math/71adfdaa578f541ca97d9680a4b53f491af7561d.png" alt="C\in{\bf R}^{m\times n}"/>, <img class="math" src="_images/math/2de3365ca20ad608bee38a645d05d849a748114c.png" alt="b\in{\bf R}^m"/>, such that</p>
<div class="math">
<p><img src="_images/math/db216a9ff941d9b1ff9d3314b645b28e9130f1d1.png" alt="{\mathcal E}(q^-,Q^-)\subseteq{\mathcal E}(q,Q)\cap P(C,g)\subseteq{\mathcal E}(q^+,Q^+),"/></p>
</div><p>we first compute</p>
<div class="math">
<p><img src="_images/math/3f3e70c1c4c9c4fa7932322417173cfb68923811.png" alt="{\mathcal E}(q^-_1,Q^-_1)\subseteq{\mathcal E}(q,Q)\cap{\bf S}(c_1,\gamma_1)\subseteq
{\mathcal E}(q^+_1,Q^+_1),"/></p>
</div><p>wherein <img class="math" src="_images/math/91f0050ef8a193e6e6c7c0151c234b1e3c2ce553.png" alt="{\bf S}(c_1,\gamma_1)"/> is the halfspace defined by the
first row of matrix <img class="math" src="_images/math/c3355896da590fc491a10150a50416687626d7cc.png" alt="C"/>, <img class="math" src="_images/math/00322295674c54c5413520f7493470ff32ae3cec.png" alt="c_1"/>, and the first element of
vector <img class="math" src="_images/math/311cabda3a9b09f0dde217303ca9d1cd9201dcf6.png" alt="g"/>, <img class="math" src="_images/math/24746dfd17e9188871007307efc793c9be692647.png" alt="\gamma_1"/>. Then, one by one, we get</p>
<div class="math">
<p><img src="_images/math/31219576174d72fc7ceedf88d2464117992bc863.png" alt="\begin{aligned}
&amp; &amp; {\mathcal E}(q^-_2,Q^-_2)\subseteq{\mathcal E}(q^-_1,Q^-_1)\cap{\bf S}(c_2,\gamma_2), ~~~
{\mathcal E}(q^+_1,Q^+_1)\cap{\bf S}(c_2,\gamma_2)\subseteq{\mathcal E}(q^+_2,Q^+_2), \\
&amp; &amp; {\mathcal E}(q^-_3,Q^-_3)\subseteq{\mathcal E}(q^-_2,Q^-_2)\cap{\bf S}(c_3,\gamma_3), ~~~
{\mathcal E}(q^+_2,Q^+_2)\cap{\bf S}(c_3,\gamma_3)\subseteq{\mathcal E}(q^+_3,Q^+_3), \\
&amp; &amp; \cdots \\
&amp; &amp; {\mathcal E}(q^-_m,Q^-_m)\subseteq{\mathcal E}(q^-_{m-1},Q^-_{m-1})\cap{\bf S}(c_m,\gamma_m), ~~~
{\mathcal E}(q^+_{m-1},Q^+_{m-1})\cap{\bf S}(c_m,\gamma_m)\subseteq{\mathcal E}(q^+_m,Q^+_m), \\\end{aligned}"/></p>
</div><p>The resulting ellipsoidal approximations are</p>
<div class="math">
<p><img src="_images/math/cbce10734fe2ac631593711f047d4a810d54fe33.png" alt="{\mathcal E}(q^+,Q^+)={\mathcal E}(q^+_m,Q^+_m), ~~~~ {\mathcal E}(q^-,Q^-)={\mathcal E}(q^-_m,Q^-_m) ."/></p>
</div></div>
<div class="section" id="checking-if-one-ellipsoid-contains-another">
<h3>Checking if one ellipsoid contains another<a class="headerlink" href="#checking-if-one-ellipsoid-contains-another" title="Permalink to this headline">¶</a></h3>
<p>Theorem of alternatives, also known as <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/>-procedure Boyd and
Vandenberghe (2004), states that the implication</p>
<div class="math">
<p><img src="_images/math/2e6ae9687cf1f6421d4ea10f9805287691ac99d1.png" alt="\langle x, A_1x\rangle + 2\langle b_1,x\rangle + c_1 \leqslant0
~~ \Rightarrow ~~
\langle x, A_2x\rangle + 2\langle b_2,x\rangle + c_2 \leqslant0,"/></p>
</div><p>where <img class="math" src="_images/math/652e947af2ee4ce917aa046bfc842e8b1cbd7bd8.png" alt="A_i\in{\bf R}^{n\times n}"/> are symmetric matrices,
<img class="math" src="_images/math/d9fd78829732e9b6f9383a6900af90b61c00fe1e.png" alt="b_i\in{\bf R}^n"/>, <img class="math" src="_images/math/55cda2cdabe26e99d412b6ce47eed6bedab3d3f6.png" alt="c_i\in{\bf R}"/>, <img class="math" src="_images/math/7a65986e7d16d5bed7a9bcb5a83121c72289727c.png" alt="i=1,2"/>, holds if
and only if there exists <img class="math" src="_images/math/e92b0a26229a4346959b0fcf78aa756f44da588b.png" alt="\lambda&gt;0"/> such that</p>
<div class="math">
<p><img src="_images/math/0e9d15b88527c5e029b75f7769b009378ea7a390.png" alt="\left[\begin{array}{cc}
A_2 &amp; b_2\\
b_2^T &amp; c_2\end{array}\right]
\preceq
\lambda\left[\begin{array}{cc}
A_1 &amp; b_1\\
b_1^T &amp; c_1\end{array}\right]."/></p>
</div><p>By <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/>-procedure,
<img class="math" src="_images/math/ed4ec478f97383d654190be07156789d9c49f8e8.png" alt="{\mathcal E}(q_1,Q_1)\subseteq{\mathcal E}(q_2,Q_2)"/> (both
ellipsoids are assumed to be nondegenerate) if and only if the following
SDP problem is feasible:</p>
<div class="math">
<p><img src="_images/math/883cc66c9220b1a82600e5112a8ddb183cd8f4e4.png" alt="\min 0"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/2eac5dc4401c091596e10c578d9ded87c2949057.png" alt="\begin{aligned}
\lambda &amp; &gt;  0, \\
\left[\begin{array}{cc}
Q_2^{-1} &amp; -Q_2^{-1}q_2\\
(-Q_2^{-1}q_2)^T &amp; q_2^TQ_2^{-1}q_2-1\end{array}\right]
&amp; \preceq
\lambda \left[\begin{array}{cc}
Q_1^{-1} &amp; -Q_1^{-1}q_1\\
(-Q_1^{-1}q_1)^T &amp; q_1^TQ_1^{-1}q_1-1\end{array}\right]\end{aligned}"/></p>
</div><p>where <img class="math" src="_images/math/9b58315bbb7d93ca561f75aaca8f8769328a0953.png" alt="\lambda\in{\bf R}"/> is the variable.</p>
</div>
<div class="section" id="minimum-volume-ellipsoids">
<h3>Minimum Volume Ellipsoids<a class="headerlink" href="#minimum-volume-ellipsoids" title="Permalink to this headline">¶</a></h3>
<p>The minimum volume ellipsoid that contains set <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> is called
<em>Löwner-John ellipsoid</em> of the set <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/>. To characterize it we
rewrite general ellipsoid <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> as</p>
<div class="math">
<p><img src="_images/math/f74a7347e6be4d33a85d97b0457ecd5b4d19f304.png" alt="{\mathcal E}(q,Q) = \{x ~|~ \langle (Ax + b), (Ax + b)\rangle \},"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/1802165e51599ec480bbc9fd3156c14aa51fe23b.png" alt="A = Q^{-1/2} ~~~ \mbox{ and } ~~~ b = -Aq ."/></p>
</div><p>For positive definite matrix <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/>, the volume of
<img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> is proportional to <img class="math" src="_images/math/3185cc5e2ae41b7c8ebf2e2346b2b8409c5586ef.png" alt="\det A^{-1}"/>. So,
finding the minimum volume ellipsoid containing <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> can be
expressed as semidefinite programming (SDP) problem</p>
<div class="math">
<p><img src="_images/math/2ba0bc17e05b19a8d5cfce76c19e71868453b485.png" alt="\min \log \det A^{-1}"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/783c5a3801fafa25291daad5041a93501e9cb71e.png" alt="\sup_{v\in S} \langle (Av + b), (Av + b)\rangle \leqslant1,"/></p>
</div><p>where the variables are <img class="math" src="_images/math/5bb275b50853b5ef0c861cc788aec212ff538dc5.png" alt="A\in{\bf R}^{n\times n}"/> and
<img class="math" src="_images/math/678e3e8bf985d056060f19204c3ce9d115266e32.png" alt="b\in{\bf R}^n"/>, and there is an implicit constraint
<img class="math" src="_images/math/432dd42e07f08767ce4dbacc70ae57d357c00506.png" alt="A\succ 0"/> (<img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/> is positive definite). The objective and
constraint functions are both convex in <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/> and <img class="math" src="_images/math/8136a7ef6a03334a7246df9097e5bcc31ba33fd2.png" alt="b"/>, so this
problem is convex. Evaluating the constraint function, however, requires
solving a convex maximization problem, and is tractable only in certain
special cases.</p>
<p>For a finite set <img class="math" src="_images/math/f81ac810bd3ecbb6ae23756422a958a454fc2beb.png" alt="S=\{x_1,\cdots,x_m\}\subset{\bf R}^n"/>, an
ellipsoid covers <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> if and only if it covers its convex hull. So,
finding the minimum volume ellipsoid covering <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> is the same as
finding the minimum volume ellipsoid containing the polytope
<img class="math" src="_images/math/90951d353747c0fed5fd2adeed6258718e7ba7f4.png" alt="{\bf conv}\{x_1,\cdots,x_m\}"/>. The SDP problem is</p>
<div class="math">
<p><img src="_images/math/2ba0bc17e05b19a8d5cfce76c19e71868453b485.png" alt="\min \log \det A^{-1}"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/a663db97beba72ef60f4ca802cae575c6409eb8f.png" alt="\begin{aligned}
A &amp; \succ  0, \\
\langle (Ax_i + b), (Ax_i + b)\rangle &amp; \leqslant 1, ~~~ i=1..m.\end{aligned}"/></p>
</div><p>We can find the minimum volume ellipsoid containing the union of
ellipsoids <img class="math" src="_images/math/9eb64b702fe24f660e2444967bd846b7dab309a6.png" alt="\bigcup_{i=1}^m{\mathcal E}(q_i,Q_i)"/>. Using the fact
that for <img class="math" src="_images/math/f9c09343107ce98fcf364ac4a6974ec24212ba2f.png" alt="i=1..m"/>
<img class="math" src="_images/math/7ea1c0fca06ad37e4a6a8290eb93fc7d3a5ec892.png" alt="{\mathcal E}(q_i,Q_i)\subseteq{\mathcal E}(q,Q)"/> if and only if
there exists <img class="math" src="_images/math/362646f89151b7ca11a96de4f2114562d6878632.png" alt="\lambda_i&gt;0"/> such that</p>
<div class="math">
<p><img src="_images/math/1bfb56594f142b4711e1763c166a8c381fb9c9c1.png" alt="\left[\begin{array}{cc}
A^2 - \lambda_i Q_i^{-1} &amp; Ab + \lambda_i Q_i^{-1}q_i\\
(Ab + \lambda_i Q_i^{-1}q_i)^T &amp; b^Tb-1 - \lambda_i (q_i^TQ_i^{-1}q_i-1) \end{array}
\right] \preceq 0 ."/></p>
</div><p>Changing variable <img class="math" src="_images/math/cac076d0e08f51690a253b3723f04d4aa4b1b326.png" alt="\tilde{b}=Ab"/>, we get convex SDP in the
variables <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/>, <img class="math" src="_images/math/2844f78fbcadb4103d4e7008800188bb35eb0db2.png" alt="\tilde{b}"/>, and
<img class="math" src="_images/math/3f3930162816b36b6e013861c57e68f060c916f5.png" alt="\lambda_1,\cdots,\lambda_m"/>:</p>
<div class="math">
<p><img src="_images/math/2ba0bc17e05b19a8d5cfce76c19e71868453b485.png" alt="\min \log \det A^{-1}"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/0eca2ec71db07c3ea6e83c1162bf851b970dc391.png" alt="\begin{aligned}
\lambda_i &amp; &gt; 0,\\
\left[\begin{array}{ccc}
A^2-\lambda_iQ_i^{-1} &amp; \tilde{b}+\lambda_iQ_i^{-1}q_i &amp; 0 \\
(\tilde{b}+\lambda_iQ_i^{-1}q_i)^T &amp; -1-\lambda_i(q_i^TQ_i^{-1}q_i-1) &amp; \tilde{b}^T \\
0 &amp; \tilde{b} &amp; -A^2\end{array}\right] &amp; \preceq 0, ~~~ i=1..m.\end{aligned}"/></p>
</div><p>After <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/> and <img class="math" src="_images/math/8136a7ef6a03334a7246df9097e5bcc31ba33fd2.png" alt="b"/> are found,</p>
<div class="math">
<p><img src="_images/math/5e0473fd58249ffee304204822d1167ca8ace602.png" alt="q=-A^{-1}b ~~~ \mbox{ and } ~~~ Q=(A^TA)^{-1}."/></p>
</div><p>The results on the minimum volume ellipsoids are explained and proven in
Boyd and Vandenberghe (2004).</p>
</div>
<div class="section" id="maximum-volume-ellipsoids">
<h3>Maximum Volume Ellipsoids<a class="headerlink" href="#maximum-volume-ellipsoids" title="Permalink to this headline">¶</a></h3>
<p>Consider a problem of finding the maximum volume ellipsoid that lies
inside a bounded convex set <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> with nonempty interior. To
formulate this problem we rewrite general ellipsoid
<img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> as</p>
<div class="math">
<p><img src="_images/math/b432ca7ef7f5085b555d79d4a7190fd951a9c1bb.png" alt="{\mathcal E}(q,Q) = \{Bx + q ~|~ \langle x,x\rangle\leqslant1\},"/></p>
</div><p>where <img class="math" src="_images/math/1b03550509c1911c04b0c5077de6cb978fdcd260.png" alt="B=Q^{1/2}"/>, so the volume of <img class="math" src="_images/math/76d087838f96cc48fcfd327127771bf549754f2f.png" alt="{\mathcal E}(q,Q)"/> is
proportional to <img class="math" src="_images/math/b6de6728d21cf8c1d44a29107c68cf8e95081b04.png" alt="\det B"/>.</p>
<p>The maximum volume ellipsoid that lies inside <img class="math" src="_images/math/ad28c83c99a8fd0dd2e2e594c9d02ee532765a0a.png" alt="S"/> can be found by
solving the following SDP problem:</p>
<div class="math">
<p><img src="_images/math/d2c743e3ea95a31aaf2d6a3c27d4856c6b9d3803.png" alt="\max \log \det B"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/3876b6cc9c00b1f441e070314884017f38a6b99a.png" alt="\sup_{\langle v,v\rangle\leqslant1} I_S(Bv+q)\leqslant0 ,"/></p>
</div><p>in the variables <img class="math" src="_images/math/a35714268b61ac980283474ed5dcc3a2d069626f.png" alt="B\in{\bf R}^{n\times n}"/> - symmetric matrix,
and <img class="math" src="_images/math/2f0254e7ea239a9e63ab4310a523e422df56e6c1.png" alt="q\in{\bf R}^n"/>, with implicit constraint <img class="math" src="_images/math/1b7dd1f642c3e982568cc29dc1f5a0e1bb62b6ba.png" alt="B\succ 0"/>,
where <img class="math" src="_images/math/4d042a567bd7e5b5fae8900e4bf9cc8bc58792fc.png" alt="I_S"/> is the indicator function:</p>
<div class="math">
<p><img src="_images/math/7a7b76728e184353f586ad2fb63ad208793b5699.png" alt="I_S(x) = \left\{\begin{array}{ll}
0, &amp; \mbox{ if } x\in S,\\
\infty, &amp; \mbox{ otherwise.}\end{array}\right."/></p>
</div><p>In case of polytope, <img class="math" src="_images/math/8a30f95855d9b4023ede36035af297b5d482e543.png" alt="S=P(C,g)"/> with <img class="math" src="_images/math/7df7554bc8b905a14d174aa3078a101032004660.png" alt="P(C,g)"/> defined in
<a href="#equation-polytope">(14)</a>, the SDP has the form</p>
<div class="math">
<p><img src="_images/math/ac03112d81b92ce6eab79afa40e03ebedb8628f1.png" alt="\min \log \det B^{-1}"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/ab5251439ecc70cee3e15e6288ea2c7ca840e025.png" alt="\begin{aligned}
B &amp; \succ 0,\\
\langle c_i, Bc_i\rangle + \langle c_i, q\rangle &amp; \leqslant \gamma_i,
~~~ i=1..m.\end{aligned}"/></p>
</div><p>We can find the maximum volume ellipsoid that lies inside the
intersection of given ellipsoids
<img class="math" src="_images/math/7981a7113df63ea439de328d568d4ed423e15527.png" alt="\bigcap_{i=1}^m{\mathcal E}(q_i,Q_i)"/>. Using the fact that for
<img class="math" src="_images/math/f9c09343107ce98fcf364ac4a6974ec24212ba2f.png" alt="i=1..m"/> <img class="math" src="_images/math/ae67ee47c6c7e0b6dcc2d2e36d30f0b2b00655ad.png" alt="{\mathcal E}(q,Q)\subseteq{\mathcal E}(q_i,Q_i)"/>
if and only if there exists <img class="math" src="_images/math/362646f89151b7ca11a96de4f2114562d6878632.png" alt="\lambda_i&gt;0"/> such that</p>
<div class="math">
<p><img src="_images/math/58f2fc326e8a517635f35be7103247ef557a77b1.png" alt="\left[\begin{array}{cc}
-\lambda_i - q^TQ_i^{-1}q + 2q_i^TQ_i^{-1}q - q_i^TQ_i^{-1}q_i + 1 &amp; (Q_i^{-1}q-Q_i^{-1}q_i)^TB\\
B(Q_i^{-1}q-Q_i^{-1}q_i) &amp; \lambda_iI-BQ_i^{-1}B\end{array}\right] \succeq 0."/></p>
</div><p>To find the maximum volume ellipsoid, we solve convex SDP in variables
<img class="math" src="_images/math/ff5fb3d775862e2123b007eb4373ff6cc1a34d4e.png" alt="B"/>, <img class="math" src="_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/>, and <img class="math" src="_images/math/3f3930162816b36b6e013861c57e68f060c916f5.png" alt="\lambda_1,\cdots,\lambda_m"/>:</p>
<div class="math">
<p><img src="_images/math/ac03112d81b92ce6eab79afa40e03ebedb8628f1.png" alt="\min \log \det B^{-1}"/></p>
</div><p>subject to:</p>
<div class="math">
<p><img src="_images/math/099017df42de1d1cb4c003cfa90e314962c71731.png" alt="\begin{aligned}
\lambda_i &amp; &gt;  0, \\
\left[\begin{array}{ccc}
1-\lambda_i &amp; 0 &amp; (q - q_i)^T\\
0 &amp; \lambda_iI &amp; B\\
q - q_i &amp; B &amp; Q_i\end{array}\right] &amp; \succeq  0, ~~~ i=1..m.\end{aligned}"/></p>
</div><p>After <img class="math" src="_images/math/ff5fb3d775862e2123b007eb4373ff6cc1a34d4e.png" alt="B"/> and <img class="math" src="_images/math/0615acc3725de21025457e7d6f7694dab8e2f758.png" alt="q"/> are found,</p>
<div class="math">
<p><img src="_images/math/2c4ecb1b18106402978cf3d4481c3df7d0aa8922.png" alt="Q = B^TB."/></p>
</div><p>The results on the maximum volume ellipsoids are explained and proven in
Boyd and Vandenberghe (2004).</p>
</div>
</div>
</div>
<div class="section" id="reachability">
<h1>Reachability<a class="headerlink" href="#reachability" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basics-of-reachability-analysis">
<h2>Basics of Reachability Analysis<a class="headerlink" href="#basics-of-reachability-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="systems-without-disturbances">
<h3>Systems without disturbances<a class="headerlink" href="#systems-without-disturbances" title="Permalink to this headline">¶</a></h3>
<p>Consider a general continuous-time</p>
<div class="math" id="equation-ctds1">
<p><span class="eqno">(42)</span><img src="_images/math/2ca4e17e19fa261a8017d598ed2a630374d816bd.png" alt="\dot{x}(t) = f(t, x, u),"/></p>
</div><p>or discrete-time dynamical system</p>
<div class="math" id="equation-dtds1">
<p><span class="eqno">(43)</span><img src="_images/math/22ae2e7de816b712afd362eca1be6524b7ae8e32.png" alt="x(t+1) = f(t, x, u),"/></p>
</div><p>wherein <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> is time <a class="footnote-reference" href="#id11" id="id1">[1]</a>, <img class="math" src="_images/math/7bb6c0add112d2fafef9f550e3efdf5a8a90f9fc.png" alt="x\in{\bf R}^n"/> is the state,
<img class="math" src="_images/math/885666012fc22acc97448cd23a4e087461163fe8.png" alt="u\in{\bf R}^m"/> is the control, and <img class="math" src="_images/math/bb2c93730dbb48558bb3c4738c956c4e8f816437.png" alt="f"/> is a measurable
vector function taking values in <img class="math" src="_images/math/9d5b8bcc7aa4f27bc64d1e1817aa4f42c44cffcb.png" alt="{\bf R}^n"/>. <a class="footnote-reference" href="#id12" id="id2">[2]</a> The control
values <img class="math" src="_images/math/962d030797713a522c94cc9365cac8daa2eba55b.png" alt="u(t, x(t))"/> are restricted to a closed compact control set
<img class="math" src="_images/math/716aa9f254b85bd9c27294bd9a2279369dc5337a.png" alt="{\mathcal U}(t)\subset{\bf R}^m"/>. An <em>open-loop</em> control does not
depend on the state, <img class="math" src="_images/math/799ecf0514724164bc6aeb7ae59cb953101ed4d9.png" alt="u=u(t)"/>; for a <em>closed-loop</em> control,
<img class="math" src="_images/math/0bf7daa52060ba1694eb242ef467c14d103bc8a3.png" alt="u=u(t, x(t))"/>.</p>
<p>The (forward) reach set <img class="math" src="_images/math/4ac03bddc513f223d4686a28c9956a8a1bda959e.png" alt="{\mathcal X}(t, t_0, x_0)"/> at time
<img class="math" src="_images/math/7c2c15b11e78eea6a5e78c86dee37e0980a3f10d.png" alt="t&gt;t_0"/> from the initial position <img class="math" src="_images/math/bb9a6f9a1c40ef877e03efc9f258bd9e26344877.png" alt="(t_0, x_0)"/> is the set of
all states <img class="math" src="_images/math/ca2daf2e20f673b2640c6e7dc320ca876788504f.png" alt="x(t)"/> reachable at time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> by system <a href="#equation-ctds1">(42)</a>,
or <a href="#equation-dtds1">(43)</a>, with <img class="math" src="_images/math/e9968a16fb90aa2d8126384a4b1af47870fd12a6.png" alt="x(t_0)=x_0"/> through all possible controls
<img class="math" src="_images/math/75741dc287c95ab30ca0b52fba5160b2c2ea66d8.png" alt="u(\tau, x(\tau))\in{\mathcal U}(\tau)"/>,
<img class="math" src="_images/math/eab6bff26e807fb4405fa64304a1265c1dd9ca3c.png" alt="t_0\leqslant\tau&lt; t"/>. For a given set of initial states
<img class="math" src="_images/math/058cc043eb5c4750bfba163d5014ba4a2911b20c.png" alt="{\mathcal X}_0"/>, the reach set
<img class="math" src="_images/math/742ecaa940e5f59c5500865e58e37461ccd8aa3a.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0)"/> is</p>
<div class="math">
<p><img src="_images/math/4d4096579353ff5e3d9c8fdfdacfa9643b950c7e.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0) = \bigcup_{x_0\in{\mathcal X}_0}{\mathcal X}(t, t_0, x_0)."/></p>
</div><p>Here are two facts about forward reach sets.</p>
<ol class="arabic">
<li><p class="first"><img class="math" src="_images/math/742ecaa940e5f59c5500865e58e37461ccd8aa3a.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0)"/> is the same for
open-loop and closed-loop control.</p>
</li>
<li><p class="first"><img class="math" src="_images/math/742ecaa940e5f59c5500865e58e37461ccd8aa3a.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0)"/> satisfies the semigroup
property,</p>
<div class="math" id="equation-semigroup">
<p><span class="eqno">(44)</span><img src="_images/math/3f154a3c90dcc9e3a0a5a273b62d172fa807c504.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0) = {\mathcal X}(t, \tau, {\mathcal X}(\tau, t_0, {\mathcal X}_0)), \;\;\;
t_0\leqslant\tau&lt; t."/></p>
</div></li>
</ol>
<p>For linear systems</p>
<div class="math" id="equation-linearrhs">
<p><span class="eqno">(45)</span><img src="_images/math/949f15c17c06ce267d7e29d4899999e171533283.png" alt="f(t, x, u) = A(t)x(t) + B(t)u,"/></p>
</div><p>with matrices <img class="math" src="_images/math/39a600f2477bf0c26625cbeac94c8b2db1137fc3.png" alt="A(t)"/> in <img class="math" src="_images/math/cb0db0dbdc5a4fb4c145e30a737d8d2e3a0c0665.png" alt="{\bf R}^{n\times n}"/> and
<img class="math" src="_images/math/429f9bbb73bef9e385fb33c6a610248910b919e0.png" alt="B(t)"/> in <img class="math" src="_images/math/f7310db1c9f2d781f689a4a2a7e82e7f9e465d17.png" alt="{\bf R}^{m\times n}"/>. For continuous-time linear
system the state transition matrix is</p>
<div class="math">
<p><img src="_images/math/fa7306baf69bb692361ac93e38f294cecfb99ba3.png" alt="\dot{\Phi}(t, t_0) = A(t)\Phi(t, t_0), \Phi(t, t) = I,"/></p>
</div><p>which for constant <img class="math" src="_images/math/99a43db79e7ea5abd0478c141516e437ab9906d6.png" alt="A(t)\equiv A"/> simplifies as</p>
<div class="math">
<p><img src="_images/math/268ca42ec22ae9c6317909d50e001d7a26485fb6.png" alt="\Phi(t, t_0) = e^{A(t-t_0)} ."/></p>
</div><p>For discrete-time linear system the state transition matrix is</p>
<div class="math">
<p><img src="_images/math/dc3e664754cab6f673bb05f27c253088b4a2acb0.png" alt="\Phi(t+1, t_0) = A(t)\Phi(t, t_0), \Phi(t, t) = I,"/></p>
</div><p>which for constant <img class="math" src="_images/math/99a43db79e7ea5abd0478c141516e437ab9906d6.png" alt="A(t)\equiv A"/> simplifies as</p>
<div class="math">
<p><img src="_images/math/53a6f08f46786ad74691b2d45dff557e36b27e13.png" alt="\Phi(t, t_0) = A^{t-t_0} ."/></p>
</div><p>If the state transition matrix is invertible,
<img class="math" src="_images/math/dbb01a0d6f4dfa9f724dd681242a8d96bb236fde.png" alt="\Phi^{-1}(t, t_0) = \Phi(t_0, t)"/>. The transition matrix is
always invertible for continuous-time and for sampled discrete-time
systems. However, if for some <img class="math" src="_images/math/1dc1c0119a604b91be9142370dc3159b6a9bbcb9.png" alt="\tau"/>, <img class="math" src="_images/math/f835b9ade5be0f5e6fe46ddb9e6aaf4e6722f665.png" alt="t_0\leqslant\tau&lt;t"/>,
<img class="math" src="_images/math/1ccb7a7f43f1a7378375bc0b410c72636a297016.png" alt="A(\tau)"/> is degenerate (singular),
<img class="math" src="_images/math/34d1587f0334c20905e9add548352a7b4152abbc.png" alt="\Phi(t, t_0)=\prod_{\tau=t_0}^{t-1}A(\tau)"/>, is also degenerate
and cannot be inverted.</p>
<p>Following Cauchy’s formula, the reach set
<img class="math" src="_images/math/742ecaa940e5f59c5500865e58e37461ccd8aa3a.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0)"/> for a linear system can be
expressed as</p>
<div class="math" id="equation-ctlsrs">
<p><span class="eqno">(46)</span><img src="_images/math/8511665fe56bbcd56b0786a30f44544738899e59.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0) =
\Phi(t, t_0){\mathcal X}_0 \oplus \int_{t_0}^t\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau"/></p>
</div><p>in continuous-time, and as</p>
<div class="math" id="equation-dtlsrs">
<p><span class="eqno">(47)</span><img src="_images/math/55a9f44153e579f6ecac4f22cd27f6b677a7d931.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0) =
\Phi(t, t_0){\mathcal X}_0 \oplus \sum_{\tau=t_0}^{t-1}\Phi(t, \tau+1)B(\tau){\mathcal U}(\tau)"/></p>
</div><p>in discrete-time case.</p>
<p>The operation ‘<img class="math" src="_images/math/f7c581af3f7cf7ed3abe62da090534eb4d1bd00f.png" alt="\oplus"/>’ is the <em>geometric sum</em>, also known as
<em>Minkowski sum</em>. <a class="footnote-reference" href="#id13" id="id3">[3]</a> The geometric sum and linear (or affine)
transformations preserve compactness and convexity. Hence, if the
initial set <img class="math" src="_images/math/058cc043eb5c4750bfba163d5014ba4a2911b20c.png" alt="{\mathcal X}_0"/> and the control sets
<img class="math" src="_images/math/2fad00e8688c15ae8e5d1cb55e0e80e8a1a94599.png" alt="{\mathcal U}(\tau)"/>, <img class="math" src="_images/math/f835b9ade5be0f5e6fe46ddb9e6aaf4e6722f665.png" alt="t_0\leqslant\tau&lt;t"/>, are compact and
convex, so is the reach set
<img class="math" src="_images/math/742ecaa940e5f59c5500865e58e37461ccd8aa3a.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0)"/>.</p>
<p>The backward reach set <img class="math" src="_images/math/2b9abba74ebec9ce8844e70604230da1dceb511b.png" alt="{\mathcal Y}(t_1, t, y_1)"/> for the target
position <img class="math" src="_images/math/af044877adb9f0742be0181232cd7503d496dcea.png" alt="(t_1, y_1)"/> is the set of all states <img class="math" src="_images/math/1340561888dcb4122a0844f6edc3acaa4dfc4a63.png" alt="y(t)"/> for
which there exists some control
<img class="math" src="_images/math/75741dc287c95ab30ca0b52fba5160b2c2ea66d8.png" alt="u(\tau, x(\tau))\in{\mathcal U}(\tau)"/>,
<img class="math" src="_images/math/db857027076b91652b7bac6974e038e8975cb8f4.png" alt="t\leqslant\tau&lt;t_1"/>, that steers system <a href="#equation-ctds1">(42)</a>, or <a href="#equation-dtds1">(43)</a> to
the state <img class="math" src="_images/math/4ae250d1bdd46e5677f27edcf5efb34587b6fc1a.png" alt="y_1"/> at time <img class="math" src="_images/math/8b91b7245b0dd42b4f5585b97e323a8cfaa064a8.png" alt="t_1"/>. For the target set
<img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> at time <img class="math" src="_images/math/8b91b7245b0dd42b4f5585b97e323a8cfaa064a8.png" alt="t_1"/>, the backward reach set
<img class="math" src="_images/math/6e2bb77aa7bc88aa6847793e8159b305c3e98836.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1)"/> is</p>
<div class="math">
<p><img src="_images/math/ac048a8b5260ddfbdad1e440eaaeab55ce448685.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1) = \bigcup_{y_1\in{\mathcal Y}_1}{\mathcal Y}(t_1, t, y_1)."/></p>
</div><p>The backward reach set
<img class="math" src="_images/math/6e2bb77aa7bc88aa6847793e8159b305c3e98836.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1)"/> is the largest <em>weakly
invariant</em> set with respect to the target set <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> and
time values <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> and <img class="math" src="_images/math/8b91b7245b0dd42b4f5585b97e323a8cfaa064a8.png" alt="t_1"/>. <a class="footnote-reference" href="#id14" id="id4">[4]</a></p>
<p><strong>Remark.</strong> Backward reach set can be computed for continuous-time
system only if the solution of <a href="#equation-ctds1">(42)</a> exists for <img class="math" src="_images/math/bfb532e561f10458258d619de1c2f1d9bb83aaf1.png" alt="t&lt;t_1"/>; and
for discrete-time system only if the right hand side of <a href="#equation-dtds1">(43)</a> is
invertible <a class="footnote-reference" href="#id15" id="id5">[5]</a>.</p>
<p>These two facts about the backward reach set <img class="math" src="_images/math/3e0cda439f41ec70ecfd72256277066dfcf37e1e.png" alt="{\mathcal Y}"/> are
similar to those for forward reach sets.</p>
<ol class="arabic">
<li><p class="first"><img class="math" src="_images/math/6e2bb77aa7bc88aa6847793e8159b305c3e98836.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1)"/> is the same for
open-loop and closed-loop control.</p>
</li>
<li><p class="first"><img class="math" src="_images/math/6e2bb77aa7bc88aa6847793e8159b305c3e98836.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1)"/> satisfies the semigroup
property,</p>
<div class="math" id="equation-semigroup_b">
<p><span class="eqno">(48)</span><img src="_images/math/9a2934d7302d56913326b3d3190c3fc33ddf2d3e.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1) = {\mathcal Y}(\tau, t, {\mathcal Y}(t_1, \tau, {\mathcal Y}_1)), \;\;\;
t\leqslant\tau&lt; t_1."/></p>
</div></li>
</ol>
<p>For the linear system <a href="#equation-linearrhs">(45)</a> the backward reach set can be
expressed as</p>
<div class="math" id="equation-ctlsbrs">
<p><span class="eqno">(49)</span><img src="_images/math/4d2b80daeaf00a3f3238d8a0a0527de9ad9467d5.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1) =
\Phi(t, t_1){\mathcal Y}_1 \oplus \int_{t_1}^t\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau"/></p>
</div><p>in the continuous-time case, and as</p>
<div class="math" id="equation-dtlsbrs">
<p><span class="eqno">(50)</span><img src="_images/math/b1a0cc16a655bd9b0fc6dee82cca9c38f2c210c0.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1) =
\Phi(t, t_1){\mathcal Y}_1 \oplus \sum_{\tau =t}^{t_1-1}-\Phi(t, \tau)B(\tau){\mathcal U}(\tau)"/></p>
</div><p>in discrete-time case. The last formula makes sense only for
discrete-time linear systems with invertible state transition matrix.
Degenerate discrete-time linear systems have unbounded backward reach
sets and such sets cannot be computed with available software tools.</p>
<p>Just as in the case of forward reach set, the backward reach set of a
linear system <img class="math" src="_images/math/6e2bb77aa7bc88aa6847793e8159b305c3e98836.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1)"/> is compact
and convex if the target set <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> and the control sets
<img class="math" src="_images/math/2fad00e8688c15ae8e5d1cb55e0e80e8a1a94599.png" alt="{\mathcal U}(\tau)"/>, <img class="math" src="_images/math/db857027076b91652b7bac6974e038e8975cb8f4.png" alt="t\leqslant\tau&lt;t_1"/>, are compact and
convex.</p>
<p><strong>Remark.</strong> In the computer science literature the reach set is said to
be the result of operator <em>post</em>, and the backward reach set is the
result of operator <em>pre</em>. In the control literature the backward reach
set is also called the <em>solvability set</em>.</p>
</div>
<div class="section" id="systems-with-disturbances">
<h3>Systems with disturbances<a class="headerlink" href="#systems-with-disturbances" title="Permalink to this headline">¶</a></h3>
<p>Consider the continuous-time dynamical system with disturbance</p>
<div class="math" id="equation-ctds2">
<p><span class="eqno">(51)</span><img src="_images/math/52faca6070a78501effdf8a5269dbc0a0ea61f5c.png" alt="\dot{x}(t) = f(t, x, u, v),"/></p>
</div><p>or the discrete-time dynamical system with disturbance</p>
<div class="math" id="equation-dtds2">
<p><span class="eqno">(52)</span><img src="_images/math/bd1c31a6d2b5c7595dcca4648e06fd2dd1a2b6a4.png" alt="x(t+1) = f(t, x, u, v),"/></p>
</div><p>in which we also have the disturbance input <img class="math" src="_images/math/7bb3fd47faa27f347a077d625d39406a791ff622.png" alt="v\in{\bf R}^d"/> with
values <img class="math" src="_images/math/0dfca47fad8dae84de1c4d7532d3bf9269f096ae.png" alt="v(t)"/> restricted to a closed compact set
<img class="math" src="_images/math/24ad963c52d48c58b63fc70ff95576d5c4a10d2f.png" alt="{\mathcal V}(t)\subset{\bf R}^d"/>.</p>
<p>In the presence of disturbances the open-loop reach set (OLRS) is
different from the closed-loop reach set (CLRS).</p>
<p>Given the initial time <img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/>, the set of initial states
<img class="math" src="_images/math/058cc043eb5c4750bfba163d5014ba4a2911b20c.png" alt="{\mathcal X}_0"/>, and terminal time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>, there are two types
of OLRS.</p>
<p>The maxmin open-loop reach set
<img class="math" src="_images/math/d88091f900f387f89e493cae7fcdf94b2ec91dea.png" alt="\overline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0)"/> is the set
of all states <img class="math" src="_images/math/26eeb5258ca5099acf8fe96b2a1049c48c89a5e6.png" alt="x"/>, such that for any disturbance
<img class="math" src="_images/math/e85f92fe1925b42b86da50a31d00b47850b2305f.png" alt="v(\tau)\in{\mathcal V}(\tau)"/>, there exist an initial state
<img class="math" src="_images/math/87d6ca88c2d985a194b1e04ce79073fb768de643.png" alt="x_0\in{\mathcal X}_0"/> and a control
<img class="math" src="_images/math/c5c8d19800a0b2f2d789c84ca70888923dc54f93.png" alt="u(\tau)\in{\mathcal U}(\tau)"/>, <img class="math" src="_images/math/f835b9ade5be0f5e6fe46ddb9e6aaf4e6722f665.png" alt="t_0\leqslant\tau&lt;t"/>, that
steers system <a href="#equation-ctds2">(51)</a> or <a href="#equation-dtds2">(52)</a> from <img class="math" src="_images/math/e9968a16fb90aa2d8126384a4b1af47870fd12a6.png" alt="x(t_0)=x_0"/> to
<img class="math" src="_images/math/ef823851cbbb81a24a7a49f418daa505b600a5fd.png" alt="x(t)=x"/>.</p>
<p>The minmax open-loop reach set
<img class="math" src="_images/math/73ba581d885599f17dba44dc036e1f91fc2e7be4.png" alt="\underline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0)"/> is the set
of all states <img class="math" src="_images/math/26eeb5258ca5099acf8fe96b2a1049c48c89a5e6.png" alt="x"/>, such that there exists a control
<img class="math" src="_images/math/c5c8d19800a0b2f2d789c84ca70888923dc54f93.png" alt="u(\tau)\in{\mathcal U}(\tau)"/> that for all disturbances
<img class="math" src="_images/math/e85f92fe1925b42b86da50a31d00b47850b2305f.png" alt="v(\tau)\in{\mathcal V}(\tau)"/>, <img class="math" src="_images/math/f835b9ade5be0f5e6fe46ddb9e6aaf4e6722f665.png" alt="t_0\leqslant\tau&lt;t"/>,
assigns an initial state <img class="math" src="_images/math/87d6ca88c2d985a194b1e04ce79073fb768de643.png" alt="x_0\in{\mathcal X}_0"/> and steers system
<a href="#equation-ctds2">(51)</a>, or <a href="#equation-dtds2">(52)</a>, from <img class="math" src="_images/math/e9968a16fb90aa2d8126384a4b1af47870fd12a6.png" alt="x(t_0)=x_0"/> to <img class="math" src="_images/math/ef823851cbbb81a24a7a49f418daa505b600a5fd.png" alt="x(t)=x"/>.</p>
<p>In the maxmin case the control is chosen
<em>after</em> knowing the disturbance over the entire time interval
<img class="math" src="_images/math/9cfd7cc884ddf9e7b9d34795c8cd6ab315ad64b2.png" alt="[t_0, t]"/>, whereas in the minmax case the control is chosen
<em>before</em> any knowledge of the disturbance. Consequently, the OLRS do not
satisfy the semigroup property.</p>
<p>The terms ‘maxmin’ and ‘minmax’ come from the fact that
<img class="math" src="_images/math/d88091f900f387f89e493cae7fcdf94b2ec91dea.png" alt="\overline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0)"/> is the
subzero level set of the value function</p>
<div class="math" id="equation-maxminvf">
<p><span class="eqno">(53)</span><img src="_images/math/59c0cc9876265adfdab70e03eaff4ec5bd68bf9d.png" alt="\underline{V}(t, x) =
\max_v\min_u\{{\bf dist}(x(t_0), {\mathcal X}_0) ~|~ x(t)=x, \; u(\tau)\in{\mathcal U}(\tau), \;
v(\tau)\in{\mathcal V}(\tau), \; t_0\leqslant\tau&lt;t\},"/></p>
</div><p>i.e.,
<img class="math" src="_images/math/33a2bdd5108f138e547a001bb57f55ba3a4bb737.png" alt="\overline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0) = \{ x~|~\underline{V}(t, x) \leqslant0\}"/>,
and <img class="math" src="_images/math/73ba581d885599f17dba44dc036e1f91fc2e7be4.png" alt="\underline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0)"/> is the
subzero level set of the value function</p>
<div class="math" id="equation-minmaxvf">
<p><span class="eqno">(54)</span><img src="_images/math/91449f289ad84516746f338180521c05b5925a83.png" alt="\overline{V}(t, x) =
\min_u\max_v\{{\bf dist}(x(t_0), {\mathcal X}_0) ~|~ x(t)=x, \; u(\tau)\in{\mathcal U}(\tau), \;
v(\tau)\in{\mathcal V}(\tau), \; t_0\leqslant\tau&lt;t\},"/></p>
</div><p>in which <img class="math" src="_images/math/912a101713690341d4121d9f299d7253b07f7ad4.png" alt="{\bf dist}(\cdot, \cdot)"/> denotes Hausdorff
semidistance. <a class="footnote-reference" href="#id16" id="id6">[6]</a> Since
<img class="math" src="_images/math/589492ba3e741b45444a9507f84b7c4e936bb2cd.png" alt="\underline{V}(t, x)\leqslant\overline{V}(t, x)"/>,
<img class="math" src="_images/math/061fc41e04d3d12c0faf00f5131c2ecfd836feee.png" alt="\underline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0)\subseteq\overline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0)"/>.</p>
<p>Note that maxmin and minmax OLRS imply <em>guarantees</em>: these are states
that can be reached no matter what the disturbance is, whether it is
known in advance (maxmin case) or not (minmax case). The OLRS may be
empty.</p>
<p>Fixing time instant <img class="math" src="_images/math/5595b2091ab81419cf08ada9eba54585015760a8.png" alt="\tau_1"/>, <img class="math" src="_images/math/255250242fecf207b8f9d58a7417e605bd0b5d6d.png" alt="t_0&lt;\tau_1&lt;t"/>, define the
<em>piecewise maxmin open-loop reach set with one correction</em>,</p>
<div class="math" id="equation-maxmin1">
<p><span class="eqno">(55)</span><img src="_images/math/3cf556a95911cda4ce2f67e029055c5ffff6fa6d.png" alt="\overline{{\mathcal X}}_{OL}^1(t, t_0, {\mathcal X}_0) = \overline{{\mathcal X}}_{OL}(t, \tau_1, \overline{{\mathcal X}}_{OL}(\tau_1, t_0, {\mathcal X}_0)),"/></p>
</div><p>and the <em>piecewise minmax open-loop reach set with one correction</em>,</p>
<div class="math" id="equation-minmax1">
<p><span class="eqno">(56)</span><img src="_images/math/400655faeefd0665257cbfaf473175915fccca1b.png" alt="\underline{{\mathcal X}}_{OL}^1(t, t_0, {\mathcal X}_0) = \underline{{\mathcal X}}_{OL}(t, \tau_1, \underline{{\mathcal X}}_{OL}(\tau_1, t_0, {\mathcal X}_0))."/></p>
</div><p>The piecewise maxmin OLRS
<img class="math" src="_images/math/7935e426f1d9da22cc0aa46d2c43dbcdda7600c1.png" alt="\overline{{\mathcal X}}_{OL}^1(t, t_0, {\mathcal X}_0)"/> is the
subzero level set of the value function</p>
<div class="math" id="equation-maxminvf1">
<p><span class="eqno">(57)</span><img src="_images/math/862b414a575adc6ef600930c7e57479eaf9fe4b0.png" alt="\underline{V}^1(t, x) =
\max_v\min_u\{\underline{V}(\tau_1, x(\tau_1)) ~|~ x(t)=x, \;
u(\tau)\in{\mathcal U}(\tau), \; v(\tau)\in{\mathcal V}(\tau), \; \tau_1\leqslant\tau&lt;t\},"/></p>
</div><p>with <img class="math" src="_images/math/c21842169a32af4ec52d3c3e708e5c7ea7808b26.png" alt="V(\tau_1, x(\tau_1))"/> given by <a href="#equation-maxminvf">(53)</a>, which yields</p>
<div class="math">
<p><img src="_images/math/2fb5538b88fd2c1a3cb44a54da7231fe3e67bb70.png" alt="\underline{V}^1(t, x) \geqslant\underline{V}(t, x),"/></p>
</div><p>and thus,</p>
<div class="math">
<p><img src="_images/math/a7feb27bdee715f1c466c6ef080d87ac72f893e3.png" alt="\overline{{\mathcal X}}_{OL}^1(t, t_0 {\mathcal X}_0) \subseteq \overline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0) ."/></p>
</div><p>On the other hand, the piecewise minmax OLRS
<img class="math" src="_images/math/3571786b94b3ae7efcfcb6c1e4c2f35697feedc0.png" alt="\underline{{\mathcal X}}_{OL}^1(t, t_0, {\mathcal X}_0)"/> is the
subzero level set of the value function</p>
<div class="math" id="equation-minmaxvf1">
<p><span class="eqno">(58)</span><img src="_images/math/5dd6506c789c94639877e210b9d5d9e1f15caab7.png" alt="\overline{V}^1(t, x) =
\min_u\max_v\{\overline{V}(\tau_1, x(\tau_1)) ~|~ x(t)=x, \;
u(\tau)\in{\mathcal U}(\tau), \; v(\tau)\in{\mathcal V}(\tau), \; \tau_1\leqslant\tau&lt;t\},"/></p>
</div><p>with <img class="math" src="_images/math/c21842169a32af4ec52d3c3e708e5c7ea7808b26.png" alt="V(\tau_1, x(\tau_1))"/> given by <a href="#equation-minmaxvf">(54)</a>, which yields</p>
<div class="math">
<p><img src="_images/math/2ef367fb1c0413d7aa49fa4f276761a92f32ae77.png" alt="\overline{V}(t, x) \geqslant\overline{V}^1(t, x),"/></p>
</div><p>and thus,</p>
<div class="math">
<p><img src="_images/math/2f9274193640ac6dd3c610043fb68ab1b765183d.png" alt="\underline{{\mathcal X}}_{OL}(t, t_0 {\mathcal X}_0) \subseteq \underline{{\mathcal X}}_{OL}^1(t, t_0, {\mathcal X}_0) ."/></p>
</div><p>We can now recursively define piecewise maxmin and minmax OLRS with
<img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> corrections for <img class="math" src="_images/math/b7f547e38f7b35ae63a582b5fa57cc9f0870f222.png" alt="t_0&lt;\tau_1&lt;\cdots&lt;\tau_k&lt;t"/>. The maxmin
piecewise OLRS with <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> corrections is</p>
<div class="math" id="equation-maxmink">
<p><span class="eqno">(59)</span><img src="_images/math/9848b4ee4fab67fff836cc47d90bb8bc8d09633a.png" alt="\overline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0) =
\overline{{\mathcal X}}_{OL}(t, \tau_k, \overline{{\mathcal X}}_{OL}^{k-1}(\tau_k, t_0, {\mathcal X}_0)),"/></p>
</div><p>which is the subzero level set of the corresponding value function</p>
<div class="math" id="equation-maxminvfk">
<p><span class="eqno">(60)</span><img src="_images/math/6f8393522248f79d3de3184825dd1765f038c261.png" alt="\begin{aligned}
&amp;&amp;\underline{V}^k(t, x) = \nonumber \\
&amp;&amp;\max_v\min_u\{\underline{V}^{k-1}(\tau_k, x(\tau_k)) ~|~ x(t)=x, \;
u(\tau)\in{\mathcal U}(\tau), \; v(\tau)\in{\mathcal V}(\tau), \; \tau_k\leqslant\tau&lt;t\}.
\end{aligned}"/></p>
</div><p>The minmax piecewise OLRS with <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> corrections is</p>
<div class="math" id="equation-minmaxk">
<p><span class="eqno">(61)</span><img src="_images/math/4021dd24f2b8ff0620f0e6009bf9b6285a7b322f.png" alt="\underline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0) =
\underline{{\mathcal X}}_{OL}(t, \tau_k, \underline{{\mathcal X}}_{OL}^{k-1}(\tau_k, t_0, {\mathcal X}_0)),"/></p>
</div><p>which is the subzero level set of the corresponding value function</p>
<div class="math" id="equation-minmaxvfk">
<p><span class="eqno">(62)</span><img src="_images/math/1b55ee9aac816c38557981aef061385894f2b13b.png" alt="\begin{aligned}
&amp;&amp;\overline{V}^k(t, x) = \nonumber \\
&amp;&amp;\min_u\max_v\{\overline{V}^{k-1}(\tau_k, x(\tau_k)) ~|~ x(t)=x, \;
u(\tau)\in{\mathcal U}(\tau), \; v(\tau)\in{\mathcal V}(\tau), \; \tau_k\leqslant\tau&lt;t\}.
\end{aligned}"/></p>
</div><p>From <a href="#equation-maxminvf1">(57)</a>, <a href="#equation-minmaxvf1">(58)</a>, <a href="#equation-maxminvfk">(60)</a> and <a href="#equation-minmaxvfk">(62)</a> it
follows that</p>
<div class="math">
<p><img src="_images/math/10963ec8c25a762d56a165ec95cc5da5d4ea666e.png" alt="\underline{V}(t, x) \leqslant\underline{V}^1(t, x)\leqslant\cdots
\leqslant\underline{V}^k(t, x) \leqslant\overline{V}^k(t, x) \leqslant\cdots
\leqslant\overline{V}^1(t, x) \leqslant\overline{V}(t, x) ."/></p>
</div><p>Hence,</p>
<div class="math" id="equation-olrsinclusion">
<p><span class="eqno">(63)</span><img src="_images/math/1113bbc74afd07561b01b44645fa72c24ed080eb.png" alt="\begin{aligned}
&amp;&amp;\underline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0) \subseteq \underline{{\mathcal X}}_{OL}^1(t, t_0, {\mathcal X}_0) \subseteq \cdots
\subseteq \underline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0) \subseteq \nonumber \\
&amp;&amp;\overline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0) \subseteq \cdots \subseteq \overline{{\mathcal X}}_{OL}^1(t, t_0, {\mathcal X}_0)
\subseteq \overline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0) .
\end{aligned}"/></p>
</div><p>We call</p>
<div class="math" id="equation-maxminclrs">
<p><span class="eqno">(64)</span><img src="_images/math/08d14efeb4cfb5cdc6e80d64bb14d23c94e86c7a.png" alt="\overline{{\mathcal X}}_{CL}(t, t_0, {\mathcal X}_0) = \overline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0), \;\;
k = \left\{\begin{array}{ll}
\infty &amp; \mbox{ for continuous-time system}\\
t-t_0-1 &amp; \mbox{ for discrete-time system}\end{array}\right."/></p>
</div><p>the <em>maxmin closed-loop reach set</em> of system <a href="#equation-ctds2">(51)</a> or <a href="#equation-dtds2">(52)</a> at
time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>, and we call</p>
<div class="math" id="equation-minmaxclrs">
<p><span class="eqno">(65)</span><img src="_images/math/43c47445d1816871a73864ce117cc9e9990ec90e.png" alt="\underline{{\mathcal X}}_{CL}(t, t_0, {\mathcal X}_0) = \underline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0), \;\;
k = \left\{\begin{array}{ll}
\infty &amp; \mbox{ for continuous-time system}\\
t-t_0-1 &amp; \mbox{ for discrete-time system}\end{array}\right."/></p>
</div><p>the <em>minmax closed-loop reach set</em> of system <a href="#equation-ctds2">(51)</a> or <a href="#equation-dtds2">(52)</a> at
time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>.
Given initial time <img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> and the set of initial
states <img class="math" src="_images/math/058cc043eb5c4750bfba163d5014ba4a2911b20c.png" alt="{\mathcal X}_0"/>, the maxmin CLRS
<img class="math" src="_images/math/1fa680dca57b07cc940c9796373b63111512f3c0.png" alt="\overline{{\mathcal X}}_{CL}(t, t_0, {\mathcal X}_0)"/> of system
<a href="#equation-ctds2">(51)</a> or <a href="#equation-dtds2">(52)</a> at time <img class="math" src="_images/math/7c2c15b11e78eea6a5e78c86dee37e0980a3f10d.png" alt="t&gt;t_0"/>, is the set of all states
<img class="math" src="_images/math/26eeb5258ca5099acf8fe96b2a1049c48c89a5e6.png" alt="x"/>, for each of which and for every disturbance
<img class="math" src="_images/math/e85f92fe1925b42b86da50a31d00b47850b2305f.png" alt="v(\tau)\in{\mathcal V}(\tau)"/>, there exist an initial state
<img class="math" src="_images/math/87d6ca88c2d985a194b1e04ce79073fb768de643.png" alt="x_0\in{\mathcal X}_0"/> and a control
<img class="math" src="_images/math/75741dc287c95ab30ca0b52fba5160b2c2ea66d8.png" alt="u(\tau, x(\tau))\in{\mathcal U}(\tau)"/>, such that the trajectory
<img class="math" src="_images/math/ebe8b756479a6dde4744b780515397b140d3caed.png" alt="x(\tau | v(\tau), u(\tau, x(\tau)))"/> satisfying
<img class="math" src="_images/math/1a913b283556ea8270a7c12c67e0fc5b03714f1e.png" alt="x(t_0) = x_0"/> and</p>
<div class="math">
<p><img src="_images/math/ece677c3e222c005b94cb718eaa118d6923d8c56.png" alt="\dot{x}(\tau | v(\tau), u(\tau, x(\tau))) \in
f(\tau, x(\tau), u(\tau, x(\tau)), v(\tau))"/></p>
</div><p>in the continuous-time case, or</p>
<div class="math">
<p><img src="_images/math/5eebf303b127c1dcf549f8aa7588c835a41518a3.png" alt="x(\tau+1 | v(\tau), u(\tau, x(\tau))) \in
f(\tau, x(\tau), u(\tau, x(\tau)), v(\tau))"/></p>
</div><p>in the discrete-time case, with <img class="math" src="_images/math/f835b9ade5be0f5e6fe46ddb9e6aaf4e6722f665.png" alt="t_0\leqslant\tau&lt;t"/>, is such
that <img class="math" src="_images/math/ef823851cbbb81a24a7a49f418daa505b600a5fd.png" alt="x(t)=x"/>.
Given initial time <img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> and the set of initial states <img class="math" src="_images/math/058cc043eb5c4750bfba163d5014ba4a2911b20c.png" alt="{\mathcal X}_0"/>, the
maxmin CLRS <img class="math" src="_images/math/af9c2f37040450ab12f7f40cf17114a96aae2b02.png" alt="\underline{{\mathcal X}}_{CL}(t, t_0, {\mathcal X}_0)"/> of system
<a href="#equation-ctds2">(51)</a> or <a href="#equation-dtds2">(52)</a>, at time <img class="math" src="_images/math/7c2c15b11e78eea6a5e78c86dee37e0980a3f10d.png" alt="t&gt;t_0"/>, is the set of all states
<img class="math" src="_images/math/26eeb5258ca5099acf8fe96b2a1049c48c89a5e6.png" alt="x"/>, for each of which there exists a control
<img class="math" src="_images/math/75741dc287c95ab30ca0b52fba5160b2c2ea66d8.png" alt="u(\tau, x(\tau))\in{\mathcal U}(\tau)"/>, and for every disturbance
<img class="math" src="_images/math/e85f92fe1925b42b86da50a31d00b47850b2305f.png" alt="v(\tau)\in{\mathcal V}(\tau)"/> there exists an initial state
<img class="math" src="_images/math/87d6ca88c2d985a194b1e04ce79073fb768de643.png" alt="x_0\in{\mathcal X}_0"/>, such that the trajectory
<img class="math" src="_images/math/5976db1ecca8e984431195f0ba91a067db5a3d0d.png" alt="x(\tau, v(\tau) | u(\tau, x(\tau)))"/> satisfying
<img class="math" src="_images/math/1a913b283556ea8270a7c12c67e0fc5b03714f1e.png" alt="x(t_0) = x_0"/> and</p>
<div class="math">
<p><img src="_images/math/c74e8bf7eda725dd9ab93a4f70f6ee8927790f5b.png" alt="\dot{x}(\tau, v(\tau) | u(\tau, x(\tau))) \in
f(\tau, x(\tau), u(\tau, x(\tau)), v(\tau))"/></p>
</div><p>in the continuous-time case, or</p>
<div class="math">
<p><img src="_images/math/4e07ee6fd8d31646d32902bd1760c51cff263ae2.png" alt="x(\tau+1, v(\tau) | u(\tau, x(\tau))) \in
f(\tau, x(\tau), u(\tau, x(\tau)), v(\tau))"/></p>
</div><p>in the discrete-time case, with <img class="math" src="_images/math/f835b9ade5be0f5e6fe46ddb9e6aaf4e6722f665.png" alt="t_0\leqslant\tau&lt;t"/>, is such
that <img class="math" src="_images/math/ef823851cbbb81a24a7a49f418daa505b600a5fd.png" alt="x(t)=x"/>.
By construction, both
maxmin and minmax CLRS satisfy the semigroup property <a href="#equation-semigroup">(44)</a>.</p>
<p>For some classes of dynamical systems and some types of constraints on
initial conditions, controls and disturbances, the maxmin and minmax
CLRS may coincide. This is the case for continuous-time linear systems
with convex compact bounds on the initial set, controls and disturbances
under the condition that the initial set <img class="math" src="_images/math/058cc043eb5c4750bfba163d5014ba4a2911b20c.png" alt="{\mathcal X}_0"/> is large
enough to ensure that
<img class="math" src="_images/math/a1c8f457ec7ed2e61744755f49bc5e80c495bbd6.png" alt="{\mathcal X}(t_0+\epsilon, t_0, {\mathcal X}_0)"/> is nonempty for
some small <img class="math" src="_images/math/ca47de052eb3fb5454694d9bce3561ebff831a1e.png" alt="\epsilon&gt;0"/>.</p>
<p>Consider the linear system case,</p>
<div class="math" id="equation-linearrhsdist">
<p><span class="eqno">(66)</span><img src="_images/math/526869990d45b20a5b25e104fa19d35ab71259dd.png" alt="f(t, x, u) = A(t)x(t) + B(t)u + G(t)v,"/></p>
</div><p>where <img class="math" src="_images/math/39a600f2477bf0c26625cbeac94c8b2db1137fc3.png" alt="A(t)"/> and <img class="math" src="_images/math/429f9bbb73bef9e385fb33c6a610248910b919e0.png" alt="B(t)"/> are as in <a href="#equation-linearrhs">(45)</a>, and
<img class="math" src="_images/math/8af75cf3e7caba5c7c879ab92a73e61550e311be.png" alt="G(t)"/> takes its values in <img class="math" src="_images/math/52757dd65ec12c9b61e3d47d65e1abe62cc0ac78.png" alt="{\bf R}^d"/>.</p>
<p>The maxmin OLRS for the continuous-time linear system can be expressed
through set valued integrals,</p>
<div class="math" id="equation-ctlsmaxmin">
<p><span class="eqno">(67)</span><img src="_images/math/901eb23716204f09159fe7af1e278f08d78f8132.png" alt="\begin{array}{l}
\overline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0) = \\
\left(\Phi(t, t_0){\mathcal X}_0 \oplus
\int_{t_0}^t\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau\right) \dot{-} \\
\int_{t_0}^t\Phi(t, \tau)(-G(\tau)){\mathcal V}(\tau)d\tau,
\end{array}"/></p>
</div><p>and for discrete-time linear system through set-valued sums,</p>
<div class="math" id="equation-dtlsmaxmin">
<p><span class="eqno">(68)</span><img src="_images/math/ee072882ded5c004d089ab985f862477ae646af1.png" alt="\begin{array}{l}
\overline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0) = \\
\left(\Phi(t, t_0){\mathcal X}_0 \oplus \sum_{\tau=t_0}^{t-1}\Phi(t, \tau+1)B(\tau){\mathcal U}(\tau)\right) \dot{-} \\
\sum_{\tau=t_0}^{t-1}\Phi(t, \tau+1)(-G(\tau)){\mathcal V}(\tau).
\end{array}"/></p>
</div><p>Similarly, the minmax OLRS for the continuous-time linear system is</p>
<div class="math" id="equation-ctlsminmax">
<p><span class="eqno">(69)</span><img src="_images/math/e2920db0a28ff2f90a17eef4a42ed9d2e6f66081.png" alt="\begin{array}{l}
\underline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0) = \\
\left(\Phi(t, t_0){\mathcal X}_0 \dot{-}
\int_{t_0}^t\Phi(t, \tau)(-G(\tau)){\mathcal V}(\tau)d\tau\right)
\oplus \\
\int_{t_0}^t\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau,
\end{array}"/></p>
</div><p>and for the discrete-time linear system it is</p>
<div class="math" id="equation-dtlsminmax">
<p><span class="eqno">(70)</span><img src="_images/math/8ecc2f342c2443095315c977d204ba3ac1076623.png" alt="\begin{array}{l}
\underline{{\mathcal X}}_{OL}(t, t_0, {\mathcal X}_0) = \\
\left(\Phi(t, t_0){\mathcal X}_0 \dot{-} \sum_{\tau=t_0}^{t-1}\Phi(t, \tau+1)(-G(\tau)){\mathcal V}(\tau)\right) \oplus \\
\sum_{\tau=t_0}^{t-1}\Phi(t, \tau+1)B(\tau){\mathcal U}(\tau).
\end{array}"/></p>
</div><p>The operation ‘<img class="math" src="_images/math/643d2d69223031aa6713610351bd87564ede3e7a.png" alt="\dot{-}"/>’ is <em>geometric difference</em>, also known as
<em>Minkowski difference</em>. <a class="footnote-reference" href="#id17" id="id7">[7]</a></p>
<p>Now consider the piecewise OLRS with <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> corrections. Expression
<a href="#equation-maxmink">(59)</a> translates into</p>
<div class="math" id="equation-ctlsmaxmink">
<p><span class="eqno">(71)</span><img src="_images/math/5fa0ff7c61e294e0ce99b36c0b5a0cf7501e96b3.png" alt="\begin{array}{l}
\overline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0) = \\
\left(\Phi(t, \tau_k)\overline{{\mathcal X}}_{OL}^{k-1}(\tau_k, t_0, {\mathcal X}_0) \oplus
\int_{\tau_k}^t\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau\right) \dot{-} \\
\int_{\tau_k}^t\Phi(t, \tau)(-G(\tau)){\mathcal V}(\tau)d\tau,
\end{array}"/></p>
</div><p>in the continuous-time case, and for the discrete-time case into</p>
<div class="math" id="equation-dtlsmaxmink">
<p><span class="eqno">(72)</span><img src="_images/math/b193c42ad634cfeaa2142c4b590e3ffbafd82a19.png" alt="\begin{array}{l}
\overline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0) = \\
\left(\Phi(t, \tau_k)\overline{{\mathcal X}}_{OL}^{k-1}(\tau_k, t_0, {\mathcal X}_0) \oplus
\sum_{\tau=\tau_k}^{t-1}\Phi(t, \tau+1)B(\tau){\mathcal U}(\tau)\right) \dot{-} \\
\sum_{\tau=\tau_k}^{t-1}\Phi(t, \tau+1)(-G(\tau)){\mathcal V}(\tau).
\end{array}"/></p>
</div><p>Expression <a href="#equation-minmaxk">(61)</a> translates into</p>
<div class="math" id="equation-ctlsminmaxk">
<p><span class="eqno">(73)</span><img src="_images/math/96ea731969af14f82ceb2689e8818b70ddfa93c8.png" alt="\begin{array}{l}
\underline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0) = \\
\left(\Phi(t, \tau_k)\underline{{\mathcal X}}_{OL}^{k-1}(t, t_0, {\mathcal X}_0) \dot{-}
\int_{\tau_k}^t\Phi(t, \tau)(-G(\tau)){\mathcal V}(\tau)d\tau\right)
\oplus \\
\int_{\tau_k}^t\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau,
\end{array}"/></p>
</div><p>in the continuous-time case, and for the discrete-time case into</p>
<div class="math" id="equation-dtlsminmaxk">
<p><span class="eqno">(74)</span><img src="_images/math/5289f453c63da5382e11e897cfebf58c845657f4.png" alt="\begin{array}{l}
\underline{{\mathcal X}}_{OL}^k(t, t_0, {\mathcal X}_0) = \\
\left(\Phi(t, \tau_k)\underline{{\mathcal X}}_{OL}^{k-1}(\tau_k, t_0, {\mathcal X}_0) \dot{-}
\sum_{\tau=\tau_k}^{t-1}\Phi(t, \tau+1)(-G(\tau)){\mathcal V}(\tau)\right)
\oplus \\
\sum_{\tau=\tau_k}^{t-1}\Phi(t, \tau+1)B(\tau){\mathcal U}(\tau).
\end{array}"/></p>
</div><p>Since for any
<img class="math" src="_images/math/3da9b810c4331174d047f0d465df4adda60f5bf8.png" alt="{\mathcal W}_1, {\mathcal W}_2, {\mathcal W}_3 \subseteq {\bf R}^n"/>
it is true that</p>
<div class="math">
<p><img src="_images/math/9d71230623b6d55323c4dff964f53c3ec6d00739.png" alt="({\mathcal W}_1 \dot{-} {\mathcal W}_2) \oplus {\mathcal W}_3 =
({\mathcal W}_1 \oplus {\mathcal W}_3) \dot{-} ({\mathcal W}_2 \oplus {\mathcal W}_3) \subseteq
({\mathcal W}_1 \oplus {\mathcal W}_3) \dot{-} {\mathcal W}_2,"/></p>
</div><p>from <a href="#equation-ctlsmaxmink">(71)</a>, <a href="#equation-ctlsminmaxk">(73)</a> and from <a href="#equation-dtlsmaxmink">(72)</a>,
<a href="#equation-dtlsminmaxk">(74)</a>, it is clear that <a href="#equation-olrsinclusion">(63)</a> is true.
For linear systems, if the initial set <img class="math" src="_images/math/058cc043eb5c4750bfba163d5014ba4a2911b20c.png" alt="{\mathcal X}_0"/>, control
bounds <img class="math" src="_images/math/2fad00e8688c15ae8e5d1cb55e0e80e8a1a94599.png" alt="{\mathcal U}(\tau)"/> and disturbance bounds
<img class="math" src="_images/math/f7bf92e6253e44b00475b7a2cb18ff6f712f5211.png" alt="{\mathcal V}(\tau)"/>, <img class="math" src="_images/math/f835b9ade5be0f5e6fe46ddb9e6aaf4e6722f665.png" alt="t_0\leqslant\tau&lt;t"/>, are compact and
convex, the CLRS
<img class="math" src="_images/math/1fa680dca57b07cc940c9796373b63111512f3c0.png" alt="\overline{{\mathcal X}}_{CL}(t, t_0, {\mathcal X}_0)"/> and
<img class="math" src="_images/math/af9c2f37040450ab12f7f40cf17114a96aae2b02.png" alt="\underline{{\mathcal X}}_{CL}(t, t_0, {\mathcal X}_0)"/> are
compact and convex, provided they are nonempty. For continuous-time
linear systems,
<img class="math" src="_images/math/03fec95f56ded9a58fea0c9101ec0c4ebfab396e.png" alt="\overline{{\mathcal X}}_{CL}(t, t_0, {\mathcal X}_0) = \underline{{\mathcal X}}_{CL}(t, t_0, {\mathcal X}_0) = {\mathcal X}_{CL}(t, t_0, {\mathcal X}_0)"/>.</p>
<p>Just as for forward reach sets, the backward reach sets can be open-loop
(OLBRS) or closed-loop (CLBRS).</p>
<p>Given the terminal time <img class="math" src="_images/math/8b91b7245b0dd42b4f5585b97e323a8cfaa064a8.png" alt="t_1"/> and target set
<img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/>, the maxmin open-loop backward reach set
<img class="math" src="_images/math/49147eaa2e979b83c5980be03e339a161edc5819.png" alt="\overline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1)"/> of system
<a href="#equation-ctds2">(51)</a> or <a href="#equation-dtds2">(52)</a> at time <img class="math" src="_images/math/bfb532e561f10458258d619de1c2f1d9bb83aaf1.png" alt="t&lt;t_1"/>, is the set of all <img class="math" src="_images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/>,
such that for any disturbance <img class="math" src="_images/math/e85f92fe1925b42b86da50a31d00b47850b2305f.png" alt="v(\tau)\in{\mathcal V}(\tau)"/> there
exists a terminal state <img class="math" src="_images/math/ea92bf13f3bda814ce7a63203cb91447f9ed1ef0.png" alt="y_1\in{\mathcal Y}_1"/> and control
<img class="math" src="_images/math/c5c8d19800a0b2f2d789c84ca70888923dc54f93.png" alt="u(\tau)\in{\mathcal U}(\tau)"/>, <img class="math" src="_images/math/db857027076b91652b7bac6974e038e8975cb8f4.png" alt="t\leqslant\tau&lt;t_1"/>, which
steers the system from <img class="math" src="_images/math/3c571cc46b92fdee69ece29daca3986b0c3ebeaf.png" alt="y(t)=y"/> to <img class="math" src="_images/math/a5d0a76f62ca1acdb1000a63660be39e7d0281e4.png" alt="y(t_1)=y_1"/>.</p>
<p><img class="math" src="_images/math/49147eaa2e979b83c5980be03e339a161edc5819.png" alt="\overline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1)"/> is the
subzero level set of the value function</p>
<div class="math" id="equation-maxminvfb">
<p><span class="eqno">(75)</span><img src="_images/math/76fe9c9eb2723c679517f7d513e64f5d6548c2da.png" alt="\begin{aligned}
&amp;&amp;\underline{V}_b(t, y) = \nonumber \\
&amp;&amp;\max_v\min_u\{{\bf dist}(y(t_1), {\mathcal Y}_1) ~|~ y(t)=y, \; u(\tau)\in{\mathcal U}(\tau), \;
v(\tau)\in{\mathcal V}(\tau), \; t\leqslant\tau&lt;t_1\},
\end{aligned}"/></p>
</div><p>Given the terminal time <img class="math" src="_images/math/8b91b7245b0dd42b4f5585b97e323a8cfaa064a8.png" alt="t_1"/> and target set
<img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/>, the minmax open-loop backward reach set
<img class="math" src="_images/math/7a983ab63ecb4fb45519eff44faf5b175680a7a3.png" alt="\underline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1)"/> of system
<a href="#equation-ctds2">(51)</a> or <a href="#equation-dtds2">(52)</a> at time <img class="math" src="_images/math/bfb532e561f10458258d619de1c2f1d9bb83aaf1.png" alt="t&lt;t_1"/>, is the set of all <img class="math" src="_images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/>,
such that there exists a control <img class="math" src="_images/math/c5c8d19800a0b2f2d789c84ca70888923dc54f93.png" alt="u(\tau)\in{\mathcal U}(\tau)"/>
that for all disturbances <img class="math" src="_images/math/f30ea039d8e119a8a8c97c182c9c9d8f12fb5db1.png" alt="v(\tau\in{\mathcal V}(\tau)"/>,
<img class="math" src="_images/math/db857027076b91652b7bac6974e038e8975cb8f4.png" alt="t\leqslant\tau&lt;t_1"/>, assigns a terminal state
<img class="math" src="_images/math/ea92bf13f3bda814ce7a63203cb91447f9ed1ef0.png" alt="y_1\in{\mathcal Y}_1"/> and steers the system from <img class="math" src="_images/math/3c571cc46b92fdee69ece29daca3986b0c3ebeaf.png" alt="y(t)=y"/>
to <img class="math" src="_images/math/a5d0a76f62ca1acdb1000a63660be39e7d0281e4.png" alt="y(t_1)=y_1"/>.
<img class="math" src="_images/math/7a983ab63ecb4fb45519eff44faf5b175680a7a3.png" alt="\underline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1)"/> is the
subzero level set of the value function</p>
<div class="math" id="equation-minmaxvfb">
<p><span class="eqno">(76)</span><img src="_images/math/ca65a051666ebc1dd07a9fd4bbe2a7e082ecd0aa.png" alt="\begin{aligned}
&amp;&amp;\overline{V}_b(t, y) = \nonumber \\
&amp;&amp;\min_u\max_v\{{\bf dist}(y(t_1), {\mathcal Y}_1) ~|~ y(t)=y, \; u(\tau)\in{\mathcal U}(\tau), \;
v(\tau)\in{\mathcal V}(\tau), \; t\leqslant\tau&lt;t_1\},
\end{aligned}"/></p>
</div><p><strong>Remark.</strong> The backward reach set can be computed for a continuous-time
system only if the solution of <a href="#equation-ctds2">(51)</a> exists for <img class="math" src="_images/math/bfb532e561f10458258d619de1c2f1d9bb83aaf1.png" alt="t&lt;t_1"/>, and
for a discrete-time system only if the right hand side of <a href="#equation-dtds2">(52)</a> is
invertible.</p>
<p>Similarly to the forward reachability case, we construct piecewise OLBRS
with one correction at time <img class="math" src="_images/math/5595b2091ab81419cf08ada9eba54585015760a8.png" alt="\tau_1"/>, <img class="math" src="_images/math/8df47bc4a3a133e15c4b4fddbd4c828c533db682.png" alt="t&lt;\tau_1&lt;t_1"/>. The
piecewise maxmin OLBRS with one correction is</p>
<div class="math" id="equation-maxminb1">
<p><span class="eqno">(77)</span><img src="_images/math/575f4465a753e850815e6b50482147d4d8778a5e.png" alt="\overline{{\mathcal Y}}_{OL}^1(t_1, t, {\mathcal Y}_1) = \overline{{\mathcal Y}}_{OL}(\tau_1, t, \overline{{\mathcal Y}}_{OL}(t_1, \tau_1, {\mathcal Y}_1)),"/></p>
</div><p>and it is the subzero level set of the function</p>
<div class="math" id="equation-maxminvfb1">
<p><span class="eqno">(78)</span><img src="_images/math/e24ce2723f8de5c2119f2296e313e52882f01777.png" alt="\begin{aligned}
&amp;&amp;\underline{V}^1_b(t, y) = \nonumber \\
&amp;&amp;\max_v\min_u\{\underline{V}_b(\tau_1, y(\tau_1)) ~|~
y(t)=y, \; u(\tau)\in{\mathcal U}(\tau), \;
v(\tau)\in{\mathcal V}(\tau), \; t\leqslant\tau&lt;\tau_1\}.
\end{aligned}"/></p>
</div><p>The piecewise minmax OLBRS with one correction is</p>
<div class="math" id="equation-minmaxb1">
<p><span class="eqno">(79)</span><img src="_images/math/003c9b1192f91b3cf009f3a52b39979b79014605.png" alt="\underline{{\mathcal Y}}_{OL}^1(t_1, t, {\mathcal Y}_1) = \underline{{\mathcal Y}}_{OL}(\tau_1, t, \underline{{\mathcal Y}}_{OL}(t_1, \tau_1, {\mathcal Y}_1)),"/></p>
</div><p>and it is the subzero level set of the function</p>
<div class="math" id="equation-minmaxvfb1">
<p><span class="eqno">(80)</span><img src="_images/math/f6ecdb1fe1d0d5df703e422d4fca78d0c0556445.png" alt="\begin{aligned}
&amp;&amp;\overline{V}^1_b(t, y) = \nonumber \\
&amp;&amp;\min_u\max_v\{\overline{V}_b(\tau_1, y(\tau_1)) ~|~
y(t)=y, \; u(\tau)\in{\mathcal U}(\tau), \;
v(\tau)\in{\mathcal V}(\tau), \; t\leqslant\tau&lt;\tau_1\},
\end{aligned}"/></p>
</div><p>Recursively define maxmin and minmax OLBRS with <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> corrections
for <img class="math" src="_images/math/1a905f067dcefa3757a6e6c2f97beb800d104f61.png" alt="t&lt;\tau_k&lt;\cdots&lt;\tau_1&lt;t_1"/>. The maxmin OLBRS with <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/>
corrections is</p>
<div class="math" id="equation-maxminbk">
<p><span class="eqno">(81)</span><img src="_images/math/4b6654ee26d2d9978a19618f963c6f6b793c3707.png" alt="\overline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1) = \overline{{\mathcal Y}}_{OL}(\tau_k, t, \overline{{\mathcal Y}}_{OL}^{k-1}(t_1, \tau_k, {\mathcal Y}_1)),"/></p>
</div><p>which is the subzero level set of function</p>
<div class="math" id="equation-maxminvfbk">
<p><span class="eqno">(82)</span><img src="_images/math/4a1427c2e1140339ccba1ec7800ff0162110b7ec.png" alt="\begin{aligned}
&amp;&amp;\underline{V}^k_b(t, y) = \nonumber \\
&amp;&amp;\max_v\min_u\{\underline{V}^{k-1}_b(\tau_k, y(\tau_k)) ~|~
y(t)=y, \; u(\tau)\in{\mathcal U}(\tau), \;
v(\tau)\in{\mathcal V}(\tau), \; t\leqslant\tau&lt;\tau_k\}.
\end{aligned}"/></p>
</div><p>The minmax OLBRS with <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> corrections is</p>
<div class="math" id="equation-minmaxbk">
<p><span class="eqno">(83)</span><img src="_images/math/1a4e8e0c62b16b158905d6492860cda8cf0d80c2.png" alt="\underline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1) = \underline{{\mathcal Y}}_{OL}(\tau_k, t, \underline{{\mathcal Y}}_{OL}^{k-1}(t_1, \tau_k, {\mathcal Y}_1)),"/></p>
</div><p>which is the subzero level set of the function</p>
<div class="math" id="equation-minmaxvfbk">
<p><span class="eqno">(84)</span><img src="_images/math/54838d326dce7b5dd30035080df905b55f2c6b0e.png" alt="\begin{aligned}
&amp;&amp;\overline{V}^k_b(t, y) = \nonumber \\
&amp;&amp;\min_u\max_v\{\overline{V}^{k-1}_b(\tau_k, y(\tau_k)) ~|~
y(t)=y, \; u(\tau)\in{\mathcal U}(\tau), \;
v(\tau)\in{\mathcal V}(\tau), \; t\leqslant\tau&lt;\tau_k\},
\end{aligned}"/></p>
</div><p>From <a href="#equation-maxminvfb1">(78)</a>, <a href="#equation-minmaxvfb1">(80)</a>, <a href="#equation-maxminvfbk">(82)</a> and <a href="#equation-minmaxvfbk">(84)</a>
it follows that</p>
<div class="math">
<p><img src="_images/math/16017575da684720060b8470c2c57151043ce8dd.png" alt="\underline{V}_b(t, y) \leqslant\underline{V}^1_b(t, y)\leqslant\cdots
\leqslant\underline{V}^k_b(t, y) \leqslant\overline{V}^k_b(t, y) \leqslant\cdots
\leqslant\overline{V}^1_b(t, y) \leqslant\overline{V}_b(t, y) ."/></p>
</div><p>Hence,</p>
<div class="math" id="equation-olbrsinclusion">
<p><span class="eqno">(85)</span><img src="_images/math/65a7946cd7884a80a939be886d5ec4a538267cbf.png" alt="\begin{aligned}
&amp;&amp;\underline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1) \subseteq \underline{{\mathcal Y}}_{OL}^1(t_1, t, {\mathcal Y}_1) \subseteq \cdots
\subseteq \underline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1) \subseteq \nonumber \\
&amp;&amp;\overline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1) \subseteq \cdots \subseteq \overline{{\mathcal Y}}_{OL}^1(t_1, t, {\mathcal Y}_1)
\subseteq \overline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1) .
\end{aligned}"/></p>
</div><p>We say that</p>
<div class="math" id="equation-maxminclbrs">
<p><span class="eqno">(86)</span><img src="_images/math/f5cc1545b6c15c1781d2b6ab2dbb62df29e2d6dc.png" alt="\overline{{\mathcal Y}}_{CL}(t_1, t, {\mathcal Y}_1) = \overline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1), \;\;
k = \left\{\begin{array}{ll}
\infty &amp; \mbox{ for continuous-time system}\\
t_1-t-1 &amp; \mbox{ for discrete-time system}\end{array}\right."/></p>
</div><p>is the <em>maxmin closed-loop backward reach set</em> of system <a href="#equation-ctds2">(51)</a> or
<a href="#equation-dtds2">(52)</a> at time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>.</p>
<p>We say that</p>
<div class="math" id="equation-minmaxclbrs">
<p><span class="eqno">(87)</span><img src="_images/math/e0062ef633b8d4f46c81b8d3f27160acf9cef4fa.png" alt="\underline{{\mathcal Y}}_{CL}(t_1, t, {\mathcal Y}_1) = \underline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1), \;\;
k = \left\{\begin{array}{ll}
\infty &amp; \mbox{ for continuous-time system}\\
t_1-t-1 &amp; \mbox{ for discrete-time system}\end{array}\right."/></p>
</div><p>is the <em>minmax closed-loop backward reach set</em> of system <a href="#equation-ctds2">(51)</a> or
<a href="#equation-dtds2">(52)</a> at time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>.</p>
<p>Given the terminal time <img class="math" src="_images/math/8b91b7245b0dd42b4f5585b97e323a8cfaa064a8.png" alt="t_1"/> and
target set <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/>, the maxmin CLBRS
<img class="math" src="_images/math/a0b040babf1e916fd89b63a7d1ce5d7a1a61e907.png" alt="\overline{{\mathcal Y}}_{CL}(t_1, t, {\mathcal Y}_1)"/> of system
<a href="#equation-ctds2">(51)</a> or <a href="#equation-dtds2">(52)</a> at time <img class="math" src="_images/math/bfb532e561f10458258d619de1c2f1d9bb83aaf1.png" alt="t&lt;t_1"/>, is the set of all states
<img class="math" src="_images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/>, for each of which for every disturbance
<img class="math" src="_images/math/e85f92fe1925b42b86da50a31d00b47850b2305f.png" alt="v(\tau)\in{\mathcal V}(\tau)"/> there exists terminal state
<img class="math" src="_images/math/ea92bf13f3bda814ce7a63203cb91447f9ed1ef0.png" alt="y_1\in{\mathcal Y}_1"/> and control
<img class="math" src="_images/math/99aa3d80b39fbabf8a6fcdd3067aeb27181b6faf.png" alt="u(\tau, y(\tau))\in{\mathcal U}(\tau)"/> that assigns trajectory
<img class="math" src="_images/math/548e764d305f342f6848494c3df5123dc700cb9c.png" alt="y(\tau, | v(\tau), u(\tau, y(\tau)))"/> satisfying</p>
<div class="math">
<p><img src="_images/math/49f4931744770188d9ed0326c5cd77ffa0be3669.png" alt="\dot{y}(\tau | v(\tau), u(\tau, y(\tau))) \in
f(\tau, y(\tau), u(\tau, y(\tau)), v(\tau))"/></p>
</div><p>in continuous-time case, or</p>
<div class="math">
<p><img src="_images/math/bab8161dcd9106bd9811b988df2903e348f0d2b2.png" alt="y(\tau+1 | v(\tau), u(\tau, y(\tau))) \in
f(\tau, y(\tau), u(\tau, y(\tau)), v(\tau))"/></p>
</div><p>in discrete-time case, with <img class="math" src="_images/math/db857027076b91652b7bac6974e038e8975cb8f4.png" alt="t\leqslant\tau&lt;t_1"/>, such that
<img class="math" src="_images/math/ea4a48d6123e85485ce06b11d0c2c8001dd46d77.png" alt="y(t) = y"/> and <img class="math" src="_images/math/a5d0a76f62ca1acdb1000a63660be39e7d0281e4.png" alt="y(t_1)=y_1"/>.</p>
<p>Given the terminal time <img class="math" src="_images/math/8b91b7245b0dd42b4f5585b97e323a8cfaa064a8.png" alt="t_1"/> and target set <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/>, the
minmax CLBRS <img class="math" src="_images/math/7c85acb9dee5270c789591eda5ec1f18d4705993.png" alt="\underline{{\mathcal Y}}_{CL}(t_1, t, {\mathcal Y}_1)"/> of system
([ctds2]) or [dtds2] at time <img class="math" src="_images/math/bfb532e561f10458258d619de1c2f1d9bb83aaf1.png" alt="t&lt;t_1"/>, is the set of all states
<img class="math" src="_images/math/092e364e1d9d19ad5fffb0b46ef4cc7f2da02c1c.png" alt="y"/>, for each of which there exists control
<img class="math" src="_images/math/99aa3d80b39fbabf8a6fcdd3067aeb27181b6faf.png" alt="u(\tau, y(\tau))\in{\mathcal U}(\tau)"/> that for every disturbance
<img class="math" src="_images/math/e85f92fe1925b42b86da50a31d00b47850b2305f.png" alt="v(\tau)\in{\mathcal V}(\tau)"/> assigns terminal state
<img class="math" src="_images/math/ea92bf13f3bda814ce7a63203cb91447f9ed1ef0.png" alt="y_1\in{\mathcal Y}_1"/> and trajectory
<img class="math" src="_images/math/451599baec69984b1605b1043f8eadc8f06c077b.png" alt="y(\tau, v(\tau) | u(\tau, y(\tau)))"/> satisfying</p>
<div class="math">
<p><img src="_images/math/ca2711a2fff533ee6c5e947f21868eecdeb81a27.png" alt="\dot{y}(\tau, v(\tau) | u(\tau, y(\tau))) \in
f(\tau, y(\tau), u(\tau, y(\tau)), v(\tau))"/></p>
</div><p>in the continuous-time case, or</p>
<div class="math">
<p><img src="_images/math/71bffe079ec90efd7bfd64992dc9c9d2109d17d2.png" alt="y(\tau+1, v(\tau) | u(\tau, y(\tau))) \in
f(\tau, y(\tau), u(\tau, y(\tau)), v(\tau))"/></p>
</div><p>in the discrete-time case, with <img class="math" src="_images/math/db857027076b91652b7bac6974e038e8975cb8f4.png" alt="t\leqslant\tau&lt;t_1"/>, such that
<img class="math" src="_images/math/ea4a48d6123e85485ce06b11d0c2c8001dd46d77.png" alt="y(t) = y"/> and <img class="math" src="_images/math/a5d0a76f62ca1acdb1000a63660be39e7d0281e4.png" alt="y(t_1)=y_1"/>.</p>
<p>Both
maxmin and minmax CLBRS satisfy the semigroup property
<a href="#equation-semigroup_b">(48)</a>.</p>
<p>The maxmin OLBRS for the continuous-time linear system can be expressed
through set valued integrals,</p>
<div class="math" id="equation-ctlsmaxminb">
<p><span class="eqno">(88)</span><img src="_images/math/f72bb9e9b07948568197426b7808fae4a54fb0c5.png" alt="\begin{array}{l}
\overline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1) = \\
\left(\Phi(t, t_1){\mathcal Y}_1 \oplus
\int_{t_1}^t\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau\right) \dot{-} \\
\int_{t}^{t_1}\Phi(t, \tau)G(\tau){\mathcal V}(\tau)d\tau,
\end{array}"/></p>
</div><p>and for the discrete-time linear system through set-valued sums,</p>
<div class="math" id="equation-dtlsmaxminb">
<p><span class="eqno">(89)</span><img src="_images/math/e3dc7d72356fe189fa74a5f69b4281aa7c9b83fc.png" alt="\begin{array}{l}
\overline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1) = \\
\left(\Phi(t, t_1){\mathcal Y}_1 \oplus
\sum_{\tau=t}^{t_1-1}-\Phi(t, \tau+1)B(\tau){\mathcal U}(\tau)\right) \dot{-} \\
\sum_{\tau=t}^{t_1-1}\Phi(t, \tau+1)G(\tau){\mathcal V}(\tau).
\end{array}"/></p>
</div><p>Similarly, the minmax OLBRS for the continuous-time linear system is</p>
<div class="math" id="equation-ctlsminmaxb">
<p><span class="eqno">(90)</span><img src="_images/math/bb26083a167e5bd142ee8954a3647b09633f91b4.png" alt="\begin{array}{l}
\underline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1) = \\
\left(\Phi(t, t_1){\mathcal Y}_1 \dot{-}
\int_{t}^{t_1}\Phi(t, \tau)G(\tau){\mathcal V}(\tau)d\tau\right)
\oplus \\
\int_{t_1}^{t}\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau,
\end{array}"/></p>
</div><p>and for the discrete-time linear system it is</p>
<div class="math" id="equation-dtlsminmaxb">
<p><span class="eqno">(91)</span><img src="_images/math/4477999953dde31124876e0e0a502295d5d69f65.png" alt="\begin{array}{l}
\underline{{\mathcal Y}}_{OL}(t_1, t, {\mathcal Y}_1) = \\
\left(\Phi(t, t_1){\mathcal Y}_1 \dot{-}
\sum_{\tau=t}^{t_1-1}\Phi(t, \tau+1)G(\tau){\mathcal V}(\tau)\right)
\oplus \\
\sum_{\tau=t}^{t_1-1}-\Phi(t, \tau+1)B(\tau){\mathcal U}(\tau).
\end{array}"/></p>
</div><p>Now consider piecewise OLBRS with <img class="math" src="_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> corrections. Expression
<a href="#equation-maxminbk">(81)</a> translates into</p>
<div class="math" id="equation-ctlsmaxminbk">
<p><span class="eqno">(92)</span><img src="_images/math/8ad351143a54fb473f32d2c1fd53d5ff4229c105.png" alt="\begin{array}{l}
\overline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1) = \\
\left(\Phi(t, \tau_k)\overline{{\mathcal Y}}_{OL}^{k-1}(t_1, \tau_k, {\mathcal Y}_1) \oplus
\int_{\tau_k}^t\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau\right) \dot{-} \\
\int^{\tau_k}_t\Phi(t, \tau)G(\tau){\mathcal V}(\tau)d\tau,
\end{array}"/></p>
</div><p>in the continuous-time case, and for the discrete-time case into</p>
<div class="math" id="equation-dtlsmaxminbk">
<p><span class="eqno">(93)</span><img src="_images/math/13d6bdacf58f0a02cde9e48296f68f4a38df54e6.png" alt="\begin{array}{l}
\overline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1) = \\
\left(\Phi(t, \tau_k)\overline{{\mathcal Y}}_{OL}^{k-1}(t_1, \tau_k, {\mathcal Y}_1) \oplus
\sum_{\tau=t}^{\tau_k-1}-\Phi(t, \tau+1)B(\tau){\mathcal U}(\tau)\right) \dot{-} \\
\sum_{\tau=t}^{\tau_k-1}\Phi(t, \tau+1)G(\tau){\mathcal V}(\tau).
\end{array}"/></p>
</div><p>Expression <a href="#equation-minmaxbk">(83)</a> translates into</p>
<div class="math" id="equation-ctlsminmaxbk">
<p><span class="eqno">(94)</span><img src="_images/math/1112d680db7e93bca25c793145d2fd5eee2be9f4.png" alt="\begin{array}{l}
\underline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1) = \\
\left(\Phi(t, \tau_k)\overline{{\mathcal Y}}_{OL}^{k-1}(t_1, \tau_k, {\mathcal Y}_1) \dot{-}
\int^{\tau_k}_t\Phi(t, \tau)G(\tau){\mathcal V}(\tau)d\tau\right)
\oplus \\
\int_{\tau_k}^t\Phi(t, \tau)B(\tau){\mathcal U}(\tau)d\tau,
\end{array}"/></p>
</div><p>in the continuous-time case, and for the discrete-time case into</p>
<div class="math" id="equation-dtlsminmaxbk">
<p><span class="eqno">(95)</span><img src="_images/math/7563120c07a5e4dae2a9a4603165b6cac4cd83c4.png" alt="\begin{array}{l}
\underline{{\mathcal Y}}_{OL}^k(t_1, t, {\mathcal Y}_1) = \\
(\Phi(t, \tau_k)\overline{{\mathcal Y}}_{OL}^{k-1}(t_1, \tau_k, {\mathcal Y}_1) \dot{-}
\sum_{\tau=t}^{\tau_k-1}\Phi(t, \tau+1)G(\tau){\mathcal V}(\tau))
\oplus \\
\sum_{\tau=t}^{\tau_k-1}-\Phi(t, \tau+1)B(\tau){\mathcal U}(\tau).
\end{array}"/></p>
</div><p>For continuous-time linear systems
<img class="math" src="_images/math/54a24dd1f688ee4e39631553c985d7f5714b415a.png" alt="\overline{{\mathcal Y}}_{CL}(t_1, t, {\mathcal Y}_1) = \underline{{\mathcal Y}}_{CL}(t_1, t, {\mathcal Y}_1) = {\mathcal Y}_{CL}(t_1, t, {\mathcal Y}_1)"/>
under the condition that the target set <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> is large
enough to ensure that
<img class="math" src="_images/math/51b93fc7552a4a9753feb5f559bd724e7987dbdc.png" alt="\underline{{\mathcal Y}}_{CL}(t_1, t_1-\epsilon, {\mathcal Y}_1)"/>
is nonempty for some small <img class="math" src="_images/math/ca47de052eb3fb5454694d9bce3561ebff831a1e.png" alt="\epsilon&gt;0"/>.</p>
<p>Computation of backward reach sets for discrete-time linear systems
makes sense only if the state transition matrix <img class="math" src="_images/math/9d404d92b318a1f9085fe646972e13f01e554ebe.png" alt="\Phi(t_1, t)"/> is
invertible.</p>
<p>If the target set <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/>, control sets
<img class="math" src="_images/math/2fad00e8688c15ae8e5d1cb55e0e80e8a1a94599.png" alt="{\mathcal U}(\tau)"/> and disturbance sets
<img class="math" src="_images/math/f7bf92e6253e44b00475b7a2cb18ff6f712f5211.png" alt="{\mathcal V}(\tau)"/>, <img class="math" src="_images/math/db857027076b91652b7bac6974e038e8975cb8f4.png" alt="t\leqslant\tau&lt;t_1"/>, are compact and
convex, then CLBRS
<img class="math" src="_images/math/a0b040babf1e916fd89b63a7d1ce5d7a1a61e907.png" alt="\overline{{\mathcal Y}}_{CL}(t_1, t, {\mathcal Y}_1)"/> and
<img class="math" src="_images/math/7c85acb9dee5270c789591eda5ec1f18d4705993.png" alt="\underline{{\mathcal Y}}_{CL}(t_1, t, {\mathcal Y}_1)"/> are
compact and convex, if they are nonempty.</p>
</div>
<div class="section" id="reachability-problem">
<h3>Reachability problem<a class="headerlink" href="#reachability-problem" title="Permalink to this headline">¶</a></h3>
<p>Reachability analysis is concerned with the computation of the forward
<img class="math" src="_images/math/742ecaa940e5f59c5500865e58e37461ccd8aa3a.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0)"/> and backward
<img class="math" src="_images/math/6e2bb77aa7bc88aa6847793e8159b305c3e98836.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1)"/> reach sets (the reach sets
may be maxmin or minmax) in a way that can effectively meet requests
like the following:</p>
<ol class="arabic">
<li><p class="first">For the given time interval <img class="math" src="_images/math/9cfd7cc884ddf9e7b9d34795c8cd6ab315ad64b2.png" alt="[t_0, t]"/>, determine whether the
system can be steered into the given target set
<img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/>. In other words, is the set
<img class="math" src="_images/math/d382e12bcb2e7be040560ab018317c9dde8ea934.png" alt="{\mathcal Y}_1\cap\bigcup_{t_0 \leqslant\tau\leqslant t}{\mathcal X}(\tau, t_0, {\mathcal X}_0)"/>
nonempty? And if the answer is ‘yes’, find a control that steers the
system to the target set (or avoids the target set). <a class="footnote-reference" href="#id18" id="id8">[8]</a></p>
</li>
<li><p class="first">If the target set <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> is reachable from the given
initial condition <img class="math" src="_images/math/84af55d74ac2ea1f85b6f2fb0fab79aaa8d3d54c.png" alt="\{t_0, {\mathcal X}_0\}"/> in the time
interval <img class="math" src="_images/math/9cfd7cc884ddf9e7b9d34795c8cd6ab315ad64b2.png" alt="[t_0, t]"/>, find the shortest time to reach
<img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/>,</p>
<div class="math">
<p><img src="_images/math/19c73966f7a7742df71b237a679cfd7ac93e757b.png" alt="\arg\min_{\tau}
\{{\mathcal X}(\tau,t_0,{\mathcal X}_0)\cap{\mathcal Y}_1\neq\emptyset ~|~ t_0\leqslant\tau\leqslant t\}."/></p>
</div></li>
<li><p class="first">Given the terminal time <img class="math" src="_images/math/8b91b7245b0dd42b4f5585b97e323a8cfaa064a8.png" alt="t_1"/>, target set
<img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> and time <img class="math" src="_images/math/bfb532e561f10458258d619de1c2f1d9bb83aaf1.png" alt="t&lt;t_1"/> find the set of states
starting at time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> from which the system can reach
<img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> within time interval <img class="math" src="_images/math/8c88a62e87aa508a4d9c2d643500df142073b3bd.png" alt="[t, t_1]"/>. In
other words, find
<img class="math" src="_images/math/8c279080fcf8ba7e878dae7163745021aa77b200.png" alt="\bigcup_{t\leqslant\tau&lt;t_1}{\mathcal Y}(t_1, \tau, {\mathcal Y}_1)"/>.</p>
</li>
<li><p class="first">Find a closed-loop control that steers a system with disturbances to
the given target set in given time.</p>
</li>
<li><p class="first">Graphically display the projection of the reach set along any
specified two- or three-dimensional subspace.</p>
</li>
</ol>
<p>For linear systems, if the initial set <img class="math" src="_images/math/058cc043eb5c4750bfba163d5014ba4a2911b20c.png" alt="{\mathcal X}_0"/>, target
set <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/>, control bounds <img class="math" src="_images/math/d8da1db395f6bf29f89a517a8aa1db11c090ed8f.png" alt="{\mathcal U}(\cdot)"/>
and disturbance bounds <img class="math" src="_images/math/a504a8aea7683f7176c45787b5048d916d623af4.png" alt="{\mathcal V}(\cdot)"/> are compact and
convex, so are the forward <img class="math" src="_images/math/742ecaa940e5f59c5500865e58e37461ccd8aa3a.png" alt="{\mathcal X}(t, t_0, {\mathcal X}_0)"/>
and backward <img class="math" src="_images/math/6e2bb77aa7bc88aa6847793e8159b305c3e98836.png" alt="{\mathcal Y}(t_1, t, {\mathcal Y}_1)"/> reach sets.
Hence reachability analysis requires the computationally effective
manipulation of convex sets, and performing the set-valued operations of
unions, intersections, geometric sums and differences.</p>
<p>Existing reach set computation tools can deal reliably only with linear
systems with convex constraints. A claim that certain tool or method can
be used <em>effectively</em> for nonlinear systems must be treated with
caution, and the first question to ask is for what class of nonlinear
systems and with what limit on the state space dimension does this tool
work? Some “reachability methods for nonlinear systems” reduce to the
local linearization of a system followed by the use of well-tested
techniques for linear system reach set computation. Thus these
approaches in fact use reachability methods for linear systems.</p>
</div>
</div>
<div class="section" id="ellipsoidal-method">
<h2>Ellipsoidal Method<a class="headerlink" href="#ellipsoidal-method" title="Permalink to this headline">¶</a></h2>
<div class="section" id="continuous-time-systems">
<h3>Continuous-time systems<a class="headerlink" href="#continuous-time-systems" title="Permalink to this headline">¶</a></h3>
<p>Consider the system</p>
<div class="math" id="equation-ctsystem">
<p><span class="eqno">(96)</span><img src="_images/math/88bae481a3101494a0b4f3def3fc547733818b61.png" alt="\dot{x}(t) = A(t)x(t) + B(t)u + G(t)v,"/></p>
</div><p>in which <img class="math" src="_images/math/7bb6c0add112d2fafef9f550e3efdf5a8a90f9fc.png" alt="x\in{\bf R}^n"/> is the state, <img class="math" src="_images/math/885666012fc22acc97448cd23a4e087461163fe8.png" alt="u\in{\bf R}^m"/> is
the control and <img class="math" src="_images/math/7bb3fd47faa27f347a077d625d39406a791ff622.png" alt="v\in{\bf R}^d"/> is the disturbance. <img class="math" src="_images/math/39a600f2477bf0c26625cbeac94c8b2db1137fc3.png" alt="A(t)"/>,
<img class="math" src="_images/math/429f9bbb73bef9e385fb33c6a610248910b919e0.png" alt="B(t)"/> and <img class="math" src="_images/math/8af75cf3e7caba5c7c879ab92a73e61550e311be.png" alt="G(t)"/> are continuous and take their values in
<img class="math" src="_images/math/cb0db0dbdc5a4fb4c145e30a737d8d2e3a0c0665.png" alt="{\bf R}^{n\times n}"/>, <img class="math" src="_images/math/e3f84cb70f5968a9273be1ddd6e93aca6e0cb7f3.png" alt="{\bf R}^{n\times m}"/> and
<img class="math" src="_images/math/0c3627101f580ceefacc9b8de59e4787dc157455.png" alt="{\bf R}^{n\times d}"/> respectively. Control <img class="math" src="_images/math/7bb48a5641483af7144dc7932424b1e0ca1dd571.png" alt="u(t,x(t))"/> and
disturbance <img class="math" src="_images/math/0dfca47fad8dae84de1c4d7532d3bf9269f096ae.png" alt="v(t)"/> are measurable functions restricted by
ellipsoidal constraints: <img class="math" src="_images/math/4a01cd4855fec413a82275feab556a69ab4a6fea.png" alt="u(t,x(t)) \in {\mathcal E}(p(t), P(t))"/>
and <img class="math" src="_images/math/9edbb67b3beacb59a37ab9ab9149bb0e6e62b342.png" alt="v(t) \in {\mathcal E}(q(t), Q(t))"/>. The set of initial states
at initial time <img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> is assumed to be the ellipsoid
<img class="math" src="_images/math/f26eef1760d960eb46a9f56bde4103cf5a508bfe.png" alt="{\mathcal E}(x_0,X_0)"/>.</p>
<p>The reach sets for systems with disturbances computed by the Ellipsoidal
Toolbox are CLRS. Henceforth, when describing backward reachability,
reach sets refer to CLRS or CLBRS. Recall that for continuous-time
linear systems maxmin and minmax CLRS coincide, and the same is true for
maxmin and minmax CLBRS.</p>
<p>If the matrix <img class="math" src="_images/math/3c396f19be8ac96093ea0cde3a84665fdf618616.png" alt="Q(\cdot)=0"/>, the system <a href="#equation-ctsystem">(96)</a> becomes an
ordinary affine system with known <img class="math" src="_images/math/4a52fc293384aa5c833a3a0f2a36a7724371908f.png" alt="v(\cdot)=q(\cdot)"/>. If
<img class="math" src="_images/math/7d922d652a26b1427e9b710e4138414036d20c47.png" alt="G(\cdot) = 0"/>, the system becomes linear. For these two cases
(<img class="math" src="_images/math/3c396f19be8ac96093ea0cde3a84665fdf618616.png" alt="Q(\cdot)=0"/> or <img class="math" src="_images/math/8c9aa9297601e14670eafe0c7f3dbc190eae1d71.png" alt="G(\cdot)=0"/>) the reach set is as given in
Definition [def:sub:<cite>o</cite>lrs], and so the reach set will be denoted as
<img class="math" src="_images/math/8e89ea910958c8ee7951acbacc86b15c73118402.png" alt="{\mathcal X}_{CL}(t, t_0, {\mathcal E}(x_0, X_0)) = {\mathcal X}(t, t_0, {\mathcal E}(x_0,X_0))"/>.</p>
<p>The reach set <img class="math" src="_images/math/1077958e06582dfbd2ead28a7a8524f5628bfb67.png" alt="{\mathcal X}(t,t_0,{\mathcal E}(x_0,X_0))"/> is a
symmetric compact convex set, whose center evolves in time according to</p>
<div class="math" id="equation-fwdcenter">
<p><span class="eqno">(97)</span><img src="_images/math/df1105d596aa4698e00d8b52d11657b969238b73.png" alt="\dot{x}_c(t) = A(t)x_c(t) + B(t)p(t) + G(t)q(t), \;\;\;
x_c(t_0)=x_0."/></p>
</div><p>Fix a vector <img class="math" src="_images/math/c679b5dadbc4e753a6971567b360896886ea7f88.png" alt="l_0\in{\bf R}^n"/>, and consider the solution
<img class="math" src="_images/math/bd252b5c4a12368f727135da5f6d3a66c73c2621.png" alt="l(t)"/> of the adjoint equation</p>
<div class="math" id="equation-adjointct">
<p><span class="eqno">(98)</span><img src="_images/math/3a2389277aefb7b53b5fe2fe70207953e5ca0f71.png" alt="\dot{l}(t) = -A^T(t)l(t), \;\;\; l(t_0) = l_0,"/></p>
</div><p>which is equivalent to</p>
<div class="math">
<p><img src="_images/math/753f3ed3f350e1b8b796ab7fd45de1e729a95cb8.png" alt="l(t) = \Phi^T(t_0, t)l_0."/></p>
</div><p>If the reach set <img class="math" src="_images/math/12e61160c0650b58138f398148aa06184fb0d39f.png" alt="{\mathcal X}(t, t_0, {\mathcal E}(x_0,X_0))"/> is
nonempty, there exist tight external and tight internal approximating
ellipsoids <img class="math" src="_images/math/d7babe857990f25b6e8e194e18d5e952be43e9e5.png" alt="{\mathcal E}(x_c(t), X^+_l(t))"/> and
<img class="math" src="_images/math/4af9fbc5ea360c75f7b4e191d0571aa04d6d65a6.png" alt="{\mathcal E}(x_c(t), X^-_l(t))"/>, respectively, such that</p>
<div class="math" id="equation-fwdinclusion">
<p><span class="eqno">(99)</span><img src="_images/math/b5c7e4a0ea338caa9b6fa7ef4fd31ce8bec5da50.png" alt="{\mathcal E}(x_c(t), X^-_l(t))\subseteq{\mathcal X}(t,t_0,{\mathcal E}(x_0,X_0))
\subseteq {\mathcal E}(x_c(t), X^+_l(t)),"/></p>
</div><p>and</p>
<div class="math" id="equation-fwdtightness">
<p><span class="eqno">(100)</span><img src="_images/math/98bdba074d91bed934098c97cdd3bed607d9a02a.png" alt="\rho(l(t) ~|~ {\mathcal E}(x_c(t), X^-_l(t))) =
\rho(l(t) ~|~ {\mathcal X}(t, t_0, {\mathcal E}(x_0,X_0))) =
\rho(l(t) ~|~ {\mathcal E}(x_c(t), X^+_l(t))) ."/></p>
</div><p>The equation for the shape matrix of the external ellipsoid is</p>
<div class="math" id="equation-fwdext1">
<p><span class="eqno">(101)</span><img src="_images/math/1b3508a4b47daa2bd747d512ff5caa3b43d1e349.png" alt="\dot{X}^+_l(t) &amp; = A(t)X^+_l(t) + X^+_l(t)A^T(t) +\nonumber \\
&amp;\pi_l(t)X^+_l(t) + \frac{1}{\pi_l(t)}B(t)P(t)B^T(t) -\nonumber \\
&amp; (X_l^{+}(t))^{1/2}S_l(t)(G(t)Q(t)G^T(t))^{1/2} \nonumber -\\
&amp; (G(t)Q(t)G^T(t))^{1/2}S_l^T(t)(X_l^{+}(t))^{1/2}, \\"/></p>
</div><div class="math" id="equation-fwdext2">
<p><span class="eqno">(102)</span><img src="_images/math/1342753c00b262a71e8f2619e9bf3202ad238db5.png" alt="X^+_l(t_0) =X_0,"/></p>
</div><p>in which</p>
<div class="math">
<p><img src="_images/math/eb0c57e987cefca1e577531c850c5fecdc043a19.png" alt="\pi_l(t) = \frac{\langle l(t),
B(t)P(t)B^T(t)l(t)\rangle^{1/2}}{\langle l(t), X^+_l(t)l(t)\rangle^{1/2}},"/></p>
</div><p>and the orthogonal matrix <img class="math" src="_images/math/94e6930643fa109366fdebf264472c0fe36f8607.png" alt="S_l(t)"/> (<img class="math" src="_images/math/5f0071b019fe2f2413ac2db5502a55d5d619e145.png" alt="S_l(t)S_l^T(t) = I"/>)
is determined by the equation</p>
<div class="math">
<p><img src="_images/math/960a40aeb84d82c0d137790bc51a2c0a3a65548f.png" alt="S_l(t)(G(t)Q(t)G^T(t))^{1/2}l(t) = \frac{\langle l(t),
G(t)Q(t)G^T(t)l(t)\rangle^{1/2}}{\langle l(t),
X_l^+(t)l(t)\rangle^{1/2}}(X_l^{+}(t))^{1/2}l(t)."/></p>
</div><p>In the presence of disturbance, if the reach set is empty, the matrix
<img class="math" src="_images/math/bc84f023e1c67c07ea9a2ea4729a9cf7e64dff41.png" alt="X^+_l(t)"/> becomes sign indefinite. For a system without
disturbance, the terms containing <img class="math" src="_images/math/8af75cf3e7caba5c7c879ab92a73e61550e311be.png" alt="G(t)"/> and <img class="math" src="_images/math/4cd3bd684973a2f27540634a1dfa19310c182d40.png" alt="Q(t)"/> vanish
from the equation <a href="#equation-fwdext1">(101)</a>.</p>
<p>The equation for the shape matrix of the internal ellipsoid is</p>
<div class="math" id="equation-fwdint1">
<p><span class="eqno">(103)</span><img src="_images/math/849aded1ec69d9c1f8fa19ab080a9b424f72d82e.png" alt="\dot{X}^-_l(t) &amp; = A(t)X^-_l(t) + X^-_l(t)A^T(t) +\nonumber \\
&amp; (X_l^{-}(t))^{1/2}T_l(t)(B(t)P(t)B^T(t))^{1/2} +\nonumber \\
&amp; (B(t)P(t)B^T(t))^{1/2}T_l^T(t)(X_l^{-}(t))^{1/2} -\nonumber \\
&amp; \eta_l(t)X^-_l(t) - \frac{1}{\eta_l(t)}G(t)Q(t)G^T(t), \\"/></p>
</div><div class="math" id="equation-fwdint2">
<p><span class="eqno">(104)</span><img src="_images/math/a87b80f9c19a0f7d192ef4e5ccfb4692ea5469d8.png" alt="X^-_l(t_0) = X_0,"/></p>
</div><p>in which</p>
<div class="math">
<p><img src="_images/math/b7ed034435db4171594856da469d011319ee1222.png" alt="\eta_l(t) = \frac{\langle l(t),
G(t)Q(t)G^T(t)l(t)\rangle^{1/2}}{\langle l(t), X^+_l(t)l(t)\rangle^{1/2}},"/></p>
</div><p>and the orthogonal matrix <img class="math" src="_images/math/80466d3565e195458a3b7bcd6772727f9b52fed6.png" alt="T_l(t)"/> is determined by the equation</p>
<div class="math">
<p><img src="_images/math/4ff7439c5774277c15821799cb020af526d2bbd1.png" alt="T_l(t)(B(t)P(t)B^T(t))^{1/2}l(t) = \frac{\langle l(t),
B(t)P(t)B^T(t)l(t)\rangle^{1/2}}{\langle l(t),
X_l^-(t)l(t)\rangle^{1/2}}(X_l^{-}(t))^{1/2}l(t)."/></p>
</div><p>Similarly to the external case, the terms containing <img class="math" src="_images/math/8af75cf3e7caba5c7c879ab92a73e61550e311be.png" alt="G(t)"/> and
<img class="math" src="_images/math/4cd3bd684973a2f27540634a1dfa19310c182d40.png" alt="Q(t)"/> vanish from the equation ([fwdint1]) for a system without
disturbance.</p>
<p>The point where the external and internal ellipsoids touch the boundary
of the reach set is given by</p>
<div class="math">
<p><img src="_images/math/8bba47f30516b0b129c280bc371e7365a96476a9.png" alt="x_l^*(t) = x_c(t) +
\frac{X^+_l(t)l(t)}{\langle l(t), X^+_l(t)l(t)\rangle^{1/2}} ."/></p>
</div><p>The boundary points <img class="math" src="_images/math/1d111edf5abfceaadf875c1c50541bcf23fb05e2.png" alt="x^*_l(t)"/> form trajectories, which we call
<em>extremal trajectories</em>. Due to the nonsingular nature of the state
transition matrix <img class="math" src="_images/math/7a189579cd696fcb515d46cce84fc3d7a6dfc4e6.png" alt="\Phi(t,t_0)"/>, every boundary point of the reach
set belongs to an extremal trajectory. To follow an extremal trajectory
specified by parameter <img class="math" src="_images/math/30d710af557466bc27cf63b952f43997962da1cc.png" alt="l_0"/>, the system has to start at time
<img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> at initial state</p>
<div class="math" id="equation-x0lct">
<p><span class="eqno">(105)</span><img src="_images/math/989587c7e2c0eec1235d485552fa2ca115860e97.png" alt="x^0_l = x_0 + \frac{X_0l_0}{\langle l_0,X_0l_0\rangle^{1/2}}."/></p>
</div><p>In the absence of disturbances, the open-loop control</p>
<div class="math" id="equation-uct">
<p><span class="eqno">(106)</span><img src="_images/math/623c893ebfcdea64f5a006798b24c599bf27cd23.png" alt="u_l(t) = p(t) + \frac{P(t)B^T(t)l(t)}{\langle l(t),
B(t)P(t)B^T(t)l(t)\rangle^{1/2}}."/></p>
</div><p>steers the system along the extremal trajectory defined by the vector
<img class="math" src="_images/math/30d710af557466bc27cf63b952f43997962da1cc.png" alt="l_0"/>. When a disturbance is present, this control keeps the
system on an extremal trajectory if and only if the disturbance plays
against the control always taking its extreme values.</p>
<p>Expressions <a href="#equation-fwdinclusion">(99)</a> and <a href="#equation-fwdtightness">(100)</a> lead to the following
fact,</p>
<div class="math">
<p><img src="_images/math/7c653e4eaf3d573922edfd852748299b6783816c.png" alt="\bigcup_{\langle l_0,l_0\rangle=1}{\mathcal E}(x_c(t),X^-_l(t)) =
{\mathcal X}(t,t_0,{\mathcal E}(x_0,X_0)) =
\bigcap_{\langle l_0,l_0\rangle=1}{\mathcal E}(x_c(t),X^+_l(t))."/></p>
</div><p>In practice this means that the more values of <img class="math" src="_images/math/30d710af557466bc27cf63b952f43997962da1cc.png" alt="l_0"/> we use to
compute <img class="math" src="_images/math/bc84f023e1c67c07ea9a2ea4729a9cf7e64dff41.png" alt="X^+_l(t)"/> and <img class="math" src="_images/math/c8d28fbb5121a9141fb66ccb45c3439d1706b10b.png" alt="X^-_l(t)"/>, the better will be our
approximation.</p>
<p>Analogous results hold for the backward reach set.</p>
<p>Given the terminal time <img class="math" src="_images/math/8b91b7245b0dd42b4f5585b97e323a8cfaa064a8.png" alt="t_1"/> and ellipsoidal target set
<img class="math" src="_images/math/d0e4aa8a9554e0263d03709e33156cd55a79d81e.png" alt="{\mathcal E}_(y_1,Y_1)"/>, the CLBRS
<img class="math" src="_images/math/85e6526c25b0e162e55fffe6bf86518b5c1fc001.png" alt="{\mathcal Y}_{CL}(t_1, t, {\mathcal Y}_1)={\mathcal Y}(t_1, t, {\mathcal Y}_1)"/>,
<img class="math" src="_images/math/bfb532e561f10458258d619de1c2f1d9bb83aaf1.png" alt="t&lt;t_1"/>, if it is nonempty, is a symmetric compact convex set
whose center is governed by</p>
<div class="math" id="equation-bckcenter">
<p><span class="eqno">(107)</span><img src="_images/math/827a6153554e7de0bebd57b81114ccadb3f0332c.png" alt="y_c(t) = Ay_c(t) + B(t)p(t) + G(t)q(t), \;\;\; y_c(t_1) = y_1."/></p>
</div><p>Fix a vector <img class="math" src="_images/math/b1f2c8bed9f4455e07e18f5bde82d6039e6ea9dd.png" alt="l_1\in{\bf R}^n"/>, and consider</p>
<div class="math" id="equation-bckadjoint">
<p><span class="eqno">(108)</span><img src="_images/math/6f105a45cb51ba995f877f2e16aada4cd386b2c1.png" alt="l(t) = \Phi(t_1, t)^Tl_1 ."/></p>
</div><p>If the backward reach set
<img class="math" src="_images/math/41bbe06329bdeffa52ce584c4b2be61f044ecdaa.png" alt="{\mathcal Y}(t_1, t, {\mathcal E}(y_1,Y_1))"/> is nonempty, there
exist tight external and tight internal approximating ellipsoids
<img class="math" src="_images/math/281482a20e2bd8b4df0ebc92e19ae3777b9c4858.png" alt="{\mathcal E}(y_c(t), Y^+_l(t))"/> and
<img class="math" src="_images/math/2257c45c574f36ab04e7959e6b94f1f53aade52d.png" alt="{\mathcal E}(y_c(t), Y^-_l(t))"/> respectively, such that</p>
<div class="math" id="equation-bckinclusion">
<p><span class="eqno">(109)</span><img src="_images/math/445ad4463e761e117119dd5cdd4dc77f64dd2feb.png" alt="{\mathcal E}(y_c(t), Y^-_l(t))\subseteq{\mathcal Y}(t_1,t,{\mathcal E}(y_1,Y_1))
\subseteq {\mathcal E}(y_c(t), Y^+_l(t)),"/></p>
</div><p>and</p>
<div class="math" id="equation-bcktightness">
<p><span class="eqno">(110)</span><img src="_images/math/9efc7d05188900cd4c67c89f3bde58dd41071cfc.png" alt="\rho(l(t) ~|~ {\mathcal E}(y_c(t), Y^-_l(t))) =
\rho(l(t) ~|~ {\mathcal Y}(t_1, t, {\mathcal E}(y_0,Y_0))) =
\rho(l(t) ~|~ {\mathcal E}(y_c(t), Y^+_l(t))) ."/></p>
</div><p>The equation for the shape matrix of the external ellipsoid is</p>
<div class="math" id="equation-bckext1">
<p><span class="eqno">(111)</span><img src="_images/math/560746cd9095bb6db3f87426a11b22229641ee74.png" alt="\dot{Y}^+_l(t) &amp; = A(t)Y^+_l(t) + Y^+_l(t)A^T(t) -\nonumber \\
&amp; \pi_l(t)Y^+_l(t) - \frac{1}{\pi_l(t)}B(t)P(t)B^T(t) +\nonumber \\
&amp; (Y_l^{+}(t))^{1/2}S_l(t)(G(t)Q(t)G^T(t))^{1/2} +\nonumber \\
&amp; (G(t)Q(t)G^T(t))^{1/2}S_l^T(t)(Y_l^{+}(t))^{1/2},\\"/></p>
</div><div class="math" id="equation-bckext2">
<p><span class="eqno">(112)</span><img src="_images/math/0576de94ae7d848b37c2638bd42aa6308aacd7b2.png" alt="Y^+_l(t_1)  = Y_1,"/></p>
</div><p>in which</p>
<div class="math">
<p><img src="_images/math/2aabaf5f9ec9f8e714b3ffc0440bcb3a053087da.png" alt="\pi_l(t) = \frac{\langle l(t),
B(t)P(t)B^T(t)l(t)\rangle^{1/2}}{\langle l(t),
Y^+_l(t)l(t)\rangle^{1/2}},"/></p>
</div><p>and the orthogonal matrix <img class="math" src="_images/math/94e6930643fa109366fdebf264472c0fe36f8607.png" alt="S_l(t)"/> satisfies the equation</p>
<div class="math">
<p><img src="_images/math/4ad3c3ce45bcd0c508079d9b77b8a0afcd8a8bce.png" alt="S_l(t)(G(t)Q(t)G^T(t))^{1/2}l(t) = \frac{\langle l(t),
G(t)Q(t)G^T(t)l(t)\rangle^{1/2}}{\langle l(t),
Y_l^+(t)l(t)\rangle^{1/2}}(Y_l^{+}(t))^{1/2}l(t)."/></p>
</div><p>The equation for the shape matrix of the internal ellipsoid is</p>
<div class="math" id="equation-bckint1">
<p><span class="eqno">(113)</span><img src="_images/math/803bfba256b292fd1938d2850e60c64bb7c8846c.png" alt="\dot{Y}^-_l(t) &amp; =  A(t)Y^-_l(t) + Y^-_l(t)A^T(t) -\nonumber \\
&amp; (Y_l^{-}(t))^{1/2}T_l(t)(B(t)P(t)B^T(t))^{1/2} -\nonumber \\
&amp; (B(t)P(t)B^T(t))^{1/2}T_l^T(t)(Y_l^{-}(t))^{1/2} +\nonumber \\
&amp; \eta_l(t)Y^-_l(t) + \frac{1}{\eta_l(t)}G(t)Q(t)G^T(t),\\"/></p>
</div><div class="math" id="equation-bckint2">
<p><span class="eqno">(114)</span><img src="_images/math/26d3e9394e9703cda5d815170a44d6cbc3be63ce.png" alt="Y^-_l(t_1) &amp; = Y_1,"/></p>
</div><p>in which</p>
<div class="math">
<p><img src="_images/math/5abc98a9fcbe6295aa0875b25f20475e4aa87701.png" alt="\eta_l(t) = \frac{\langle l(t),
G(t)Q(t)G^T(t)l(t)\rangle^{1/2}}{\langle l(t),
Y^+_l(t)l(t)\rangle^{1/2}},"/></p>
</div><p>and the orthogonal matrix <img class="math" src="_images/math/80466d3565e195458a3b7bcd6772727f9b52fed6.png" alt="T_l(t)"/> is determined by the equation</p>
<div class="math">
<p><img src="_images/math/bbb1bd4a96b3f75d677187d678e52f67af3338a5.png" alt="T_l(t)(B(t)P(t)B^T(t))^{1/2}l(t) = \frac{\langle l(t),
B(t)P(t)B^T(t)l(t)\rangle^{1/2}}{\langle l(t),
Y_l^-(t)l(t)\rangle^{1/2}}(Y_l^{-}(t))^{1/2}l(t)."/></p>
</div><p>Just as in the forward reachability case, the terms containing
<img class="math" src="_images/math/8af75cf3e7caba5c7c879ab92a73e61550e311be.png" alt="G(t)"/> and <img class="math" src="_images/math/4cd3bd684973a2f27540634a1dfa19310c182d40.png" alt="Q(t)"/> vanish from equations <a href="#equation-bckext1">(111)</a> and
<a href="#equation-bckint1">(113)</a> in the absence of disturbances. The boundary value problems
<a href="#equation-bckcenter">(107)</a>, <a href="#equation-bckext1">(111)</a> and <a href="#equation-bckint1">(113)</a> are converted to the initial
value problems by the change of variables <img class="math" src="_images/math/f63632e06efb8dad4a366dbf88b04a0f4b0e44e9.png" alt="s = -t"/>.</p>
<p>Due to <a href="#equation-bckinclusion">(109)</a> and <a href="#equation-bcktightness">(110)</a>,</p>
<div class="math">
<p><img src="_images/math/8ef8b45b6f157425074f62412e5dd4a61382a49a.png" alt="\bigcup_{\langle l_1,l_1\rangle=1}{\mathcal E}(y_c(t),Y^-_l(t)) =
{\mathcal Y}(t_1,t,{\mathcal E}(y_1,Y_1)) =
\bigcap_{\langle l_1,l_1\rangle=1}{\mathcal E}(y_c(t),Y^+_l(t))."/></p>
</div><p><strong>Remark.</strong> In expressions <a href="#equation-fwdext1">(101)</a>, <a href="#equation-fwdint1">(103)</a>, <a href="#equation-bckext1">(111)</a> and
<a href="#equation-bckint1">(113)</a> the terms <img class="math" src="_images/math/2e2957fe2e70d4cf071788ba3a0454c696222a0a.png" alt="\frac{1}{\pi_l(t)}"/> and
<img class="math" src="_images/math/95b45e151683fcad510b8995d6504e477ab4508e.png" alt="\frac{1}{\eta_l(t)}"/> may not be well defined for some vectors
<img class="math" src="_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/>, because matrices <img class="math" src="_images/math/4e7cadacbbc15773559d0e940a684fb4b7a3e122.png" alt="B(t)P(t)B^T(t)"/> and
<img class="math" src="_images/math/25fd3019133e6c84e1af456de90277c42e291280.png" alt="G(t)Q(t)G^T(t)"/> may be singular. In such cases, we set these
entire expressions to zero.</p>
</div>
<div class="section" id="discrete-time-systems">
<h3>Discrete-time systems<a class="headerlink" href="#discrete-time-systems" title="Permalink to this headline">¶</a></h3>
<p>Consider the discrete-time linear system,</p>
<div class="math" id="equation-dtsystem">
<p><span class="eqno">(115)</span><img src="_images/math/633e52ea69062a285a75a1c77881d2b3f687a0b4.png" alt="x(t+1) = A(t)x(t) + B(t)u(t,x(t)) + G(t)v(t),"/></p>
</div><p>in which <img class="math" src="_images/math/cb9ef13ed977539cc82153a8dfdfd9f2b7d2662b.png" alt="x(t)\in{\bf R}^n"/> is the state,
<img class="math" src="_images/math/66bb9e1a6ec78d759d6dd1a7f3f8f0d964e8732c.png" alt="u(t, x(t))\in{\bf R}^m"/> is the control bounded by the ellipsoid
<img class="math" src="_images/math/5df23544fadc7d2f7a59468ebb259c8a8f5aedfd.png" alt="{\mathcal E}(p(t),P(t))"/>, <img class="math" src="_images/math/a42dd6323c4006b8223f98a7034043dc1c9ab4ad.png" alt="v(t)\in{\bf R}^d"/> is disturbance
bounded by ellipsoid <img class="math" src="_images/math/a5c14c3879b117925fb31d46861cde93fb8181bb.png" alt="{\mathcal E}(q(t),Q(t))"/>, and matrices
<img class="math" src="_images/math/39a600f2477bf0c26625cbeac94c8b2db1137fc3.png" alt="A(t)"/>, <img class="math" src="_images/math/429f9bbb73bef9e385fb33c6a610248910b919e0.png" alt="B(t)"/>, <img class="math" src="_images/math/8af75cf3e7caba5c7c879ab92a73e61550e311be.png" alt="G(t)"/> are in
<img class="math" src="_images/math/cb0db0dbdc5a4fb4c145e30a737d8d2e3a0c0665.png" alt="{\bf R}^{n\times n}"/>, <img class="math" src="_images/math/e3f84cb70f5968a9273be1ddd6e93aca6e0cb7f3.png" alt="{\bf R}^{n\times m}"/>,
<img class="math" src="_images/math/0c3627101f580ceefacc9b8de59e4787dc157455.png" alt="{\bf R}^{n\times d}"/> respectively. Here we shall assume
<img class="math" src="_images/math/39a600f2477bf0c26625cbeac94c8b2db1137fc3.png" alt="A(t)"/> to be nonsingular. <a class="footnote-reference" href="#id19" id="id9">[9]</a> The set of initial conditions at
initial time <img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> is ellipsoid <img class="math" src="_images/math/f26eef1760d960eb46a9f56bde4103cf5a508bfe.png" alt="{\mathcal E}(x_0,X_0)"/>.</p>
<p>Ellipsoidal Toolbox computes maxmin and minmax CLRS
<img class="math" src="_images/math/40704d9b8514ec28ce9d9a05533d0d593ebeac29.png" alt="\overline{{\mathcal X}}_{CL}(t, t_0, {\mathcal E}(x_0, X_0)"/> and
<img class="math" src="_images/math/bed6aa0e1d5ee31b81d55d174ee68924bbe53efe.png" alt="\underline{{\mathcal X}}_{CL}(t, t_0, {\mathcal E}(x_0, X_0)"/> for
discrete-time systems.</p>
<p>If matrix <img class="math" src="_images/math/3c396f19be8ac96093ea0cde3a84665fdf618616.png" alt="Q(\cdot)=0"/>, the system <a href="#equation-dtsystem">(115)</a> becomes an
ordinary affine system with known <img class="math" src="_images/math/4a52fc293384aa5c833a3a0f2a36a7724371908f.png" alt="v(\cdot)=q(\cdot)"/>. If matrix
<img class="math" src="_images/math/8c9aa9297601e14670eafe0c7f3dbc190eae1d71.png" alt="G(\cdot)=0"/>, the system reduces to a linear controlled system. In
the absence of disturbance (<img class="math" src="_images/math/3c396f19be8ac96093ea0cde3a84665fdf618616.png" alt="Q(\cdot)=0"/> or <img class="math" src="_images/math/8c9aa9297601e14670eafe0c7f3dbc190eae1d71.png" alt="G(\cdot)=0"/>),
<img class="math" src="_images/math/3c89c58117518e2a209ba4c10bd330b3d838e0bc.png" alt="\overline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0))=\underline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0))={\mathcal X}(t,t_0,{\mathcal E}(x_0,X_0))"/>,
the reach set is as in Definition.</p>
<p>Maxmin and minmax CLRS
<img class="math" src="_images/math/40704d9b8514ec28ce9d9a05533d0d593ebeac29.png" alt="\overline{{\mathcal X}}_{CL}(t, t_0, {\mathcal E}(x_0, X_0)"/> and
<img class="math" src="_images/math/bed6aa0e1d5ee31b81d55d174ee68924bbe53efe.png" alt="\underline{{\mathcal X}}_{CL}(t, t_0, {\mathcal E}(x_0, X_0)"/>, if
nonempty, are symmetric convex and compact, with the center evolving in
time according to</p>
<div class="math" id="equation-fwdcenterd">
<p><span class="eqno">(116)</span><img src="_images/math/b3222df82f335ae3c13b3bc410b20f191706382f.png" alt="x_c(t+1) = A(t)x_c(t) + B(t)p(t) + G(t)v(t), \\
x_c(t_0)= x_0."/></p>
</div><p>Fix some vector <img class="math" src="_images/math/c679b5dadbc4e753a6971567b360896886ea7f88.png" alt="l_0\in{\bf R}^n"/> and consider <img class="math" src="_images/math/bd252b5c4a12368f727135da5f6d3a66c73c2621.png" alt="l(t)"/> that
satisfies the discrete-time adjoint equation, <a class="footnote-reference" href="#id20" id="id10">[10]</a></p>
<div class="math" id="equation-adjointdt">
<p><span class="eqno">(117)</span><img src="_images/math/f5d58d6e153ef8a2b1cd480d85e91a6fe5565198.png" alt="l(t+1) = \left(A^T\right)^{-1}(t)l(t), \\
l(t_0) = l_0,"/></p>
</div><p>or, equivalently</p>
<div class="math">
<p><img src="_images/math/c1bc083425137f9fe84652c8635a605daa5d7063.png" alt="l(t) = \Phi^T(t_0, t)l_0 ."/></p>
</div><p>There exist tight external ellipsoids
<img class="math" src="_images/math/9618579f2b911a58a71f1b4c5985f9399149842a.png" alt="{\mathcal E}(x_c(t), \overline{X}^+_l(t))"/>,
<img class="math" src="_images/math/c2ad91891f8b89f9b21bdd650bef4119448b29e2.png" alt="{\mathcal E}(x_c(t), \underline{X}^+_l(t))"/> and tight internal
ellipsoids <img class="math" src="_images/math/8daa2bdc5e23c0309be4274847fddc37281fbc27.png" alt="{\mathcal E}(x_c(t), \overline{X}^-_l(t))"/>,
<img class="math" src="_images/math/8dcb1add319dc007a9c0b976bc97d73499f04e50.png" alt="{\mathcal E}(x_c(t), \underline{X}^-_l(t))"/> such that</p>
<div class="math" id="equation-maxmininclusion">
<p><span class="eqno">(118)</span><img src="_images/math/6706c15ee3803e60b042d7467f24d9889563c413.png" alt="{\mathcal E}(x_c(t), \overline{X}^-_l(t))\subseteq\overline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0))
\subseteq {\mathcal E}(x_c(t), \overline{X}^+_l(t)),"/></p>
</div><div class="math" id="equation-maxmintightness">
<p><span class="eqno">(119)</span><img src="_images/math/f03683f25fabcc8423d6b65a29cf2ba0bd9b5e8d.png" alt="\rho(l(t) ~|~ {\mathcal E}(x_c(t), \overline{X}^-_l(t))) =
\rho(l(t) ~|~ \overline{{\mathcal X}}_{CL}(t, t_0, {\mathcal E}(x_0,X_0))) =
\rho(l(t) ~|~ {\mathcal E}(x_c(t), \overline{X}^+_l(t))) ."/></p>
</div><p>and</p>
<div class="math" id="equation-minmaxinclusion">
<p><span class="eqno">(120)</span><img src="_images/math/85ffdcc09f2c5ec8d1a66f608521b971566ca82e.png" alt="{\mathcal E}(x_c(t), \underline{X}^-_l(t))\subseteq\underline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0))
\subseteq {\mathcal E}(x_c(t), \underline{X}^+_l(t)),"/></p>
</div><div class="math" id="equation-minmaxtightness">
<p><span class="eqno">(121)</span><img src="_images/math/0bdcb488c25dd46ecebddb1029b30e39cd3945ad.png" alt="\rho(l(t) ~|~ {\mathcal E}(x_c(t), \underline{X}^-_l(t))) =
\rho(l(t) ~|~ \underline{{\mathcal X}}_{CL}(t, t_0, {\mathcal E}(x_0,X_0))) =
\rho(l(t) ~|~ {\mathcal E}(x_c(t), \underline{X}^+_l(t))) ."/></p>
</div><p>The shape matrix of the external ellipsoid for maxmin reach set is
determined from</p>
<div class="math" id="equation-fwdextmaxmin1">
<p><span class="eqno">(122)</span><img src="_images/math/3a0df83cb6767a97a70ad8d44b4cb909bfb7ff74.png" alt="\hat{X}^+_l(t) &amp; = (1+\overline{\pi}_l(t))A(t)\overline{X}^+_l(t)A^T(t) +
\left(1+\frac{1}{\overline{\pi}_l(t)}\right)
B(t)P(t)B^T(t),  \\"/></p>
</div><div class="math" id="equation-fwdextmaxmin2">
<p><span class="eqno">(123)</span><img src="_images/math/10a235d32783d36915a1b06eaa6ceef7c846fab3.png" alt="\overline{X}^+_l(t+1) &amp; = \left((\hat{X}^+_l(t))^{1/2} +
\overline{S}_l(t)(G(t)Q(t)G^T(t))^{1/2}\right)^T
\times \nonumber \\
&amp; \left((\hat{X}^+_l(t))^{1/2} + \overline{S}_l(t)(G(t)Q(t)G^T(t))^{1/2}\right),\\"/></p>
</div><div class="math" id="equation-fwdextmaxmin3">
<p><span class="eqno">(124)</span><img src="_images/math/6492f8478ac93c764cbce93fd3201f541744faf9.png" alt="\overline{X}^+_l(t_0) &amp; = X_0,"/></p>
</div><p>wherein</p>
<div class="math">
<p><img src="_images/math/e604f4bdaf5c77e742d293d39c74e9c0c29d4a56.png" alt="\overline{\pi}_l(t) = \frac{\langle l(t+1),
B(t)P(t)B^T(t)l(t+1)\rangle^{1/2}}{\langle l(t),
\overline{X}^+_l(t)l(t)\rangle^{1/2}},"/></p>
</div><p>and the orthogonal matrix <img class="math" src="_images/math/872c313f4d281f36ac6691dd9ba82029153721c0.png" alt="\overline{S}_l(t)"/> is determined by
the equation</p>
<div class="math">
<p><img src="_images/math/e2ac8a7ecd2133ff7e7a64bdb511658417f9b9f2.png" alt="\begin{aligned}
&amp; &amp; \overline{S}_l(t)(G(t)Q(t)G^T(t))^{1/2}l(t+1) = \\
&amp; &amp; \frac{\langle l(t+1),
G(t)Q(t)G^T(t)l(t+1)\rangle^{1/2}}{\langle l(t+1),
\hat{X}^+_l(t)l(t+1)\rangle^{1/2}}(\hat{X}^+_l(t))^{1/2}l(t+1).\end{aligned}"/></p>
</div><p>Equation <a href="#equation-fwdextmaxmin2">(123)</a> is valid only if
<img class="math" src="_images/math/5ab0ac2ae450110b1cbebc25535061562866f6df.png" alt="{\mathcal E}(0,G(t)Q(t)G^T(t))\subseteq{\mathcal E}(0,\hat{X}^+_l(t))"/>,
otherwise the maxmin CLRS
<img class="math" src="_images/math/98e97423400c5f7068672ed053eb94a04324ffef.png" alt="\overline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0))"/> is
empty.</p>
<p>The shape matrix of the external ellipsoid for minmax reach set is
determined from</p>
<div class="math" id="equation-fwdextminmax1">
<p><span class="eqno">(125)</span><img src="_images/math/961e976eb912f0968f18ad08470000292503ce75.png" alt="\breve{X}^+_l(t) &amp; =
\left((A(t)\underline{X}^+_l(t)A^T(t))^{1/2} +
\underline{S}_l(t)(G(t)Q(t)G^T(t))^{1/2}\right)^T
\times \nonumber \\
&amp;\left((A(t)\underline{X}^+_l(t)A^T(t))^{1/2} +
\underline{S}_l(t)(G(t)Q(t)G^T(t))^{1/2}\right)\\"/></p>
</div><div class="math" id="equation-fwdextminmax2">
<p><span class="eqno">(126)</span><img src="_images/math/7107c95bef9115f5c3dd9726120c515186f68f26.png" alt="\underline{X}^+_l(t+1) &amp; =
(1+\underline{\pi}_l(t))\breve{X}^+_l(t) +
\left(1+\frac{1}{\underline{\pi}_l(t)}\right)
B(t)P(t)B^T(t),\\"/></p>
</div><div class="math" id="equation-fwdextminmax3">
<p><span class="eqno">(127)</span><img src="_images/math/cf52b153335f5ac797121010c7c860e58bba8126.png" alt="\underline{X}^+_l(t_0) &amp; = X_0,"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/46d4ca89782e68c377cfe7599eb9b80dc01a6367.png" alt="\underline{\pi}_l(t) = \frac{\langle l(t+1),
B(t)P(t)B^T(t)l(t+1)\rangle^{1/2}}{\langle l(t+1),
\breve{X}^+_l(t)l(t+1)\rangle^{1/2}},"/></p>
</div><p>and <img class="math" src="_images/math/19ef93caa567ee8b1879a110bd706c2023511895.png" alt="\underline{S}_l(t)"/> is orthogonal matrix determined from the
equation</p>
<div class="math">
<p><img src="_images/math/9f160899477b4c01e00b65fbc49546eeceea6e06.png" alt="\begin{aligned}
&amp; \underline{S}_l(t)(G(t)Q(t)G^T(t))^{1/2}l(t+1) = \\
&amp; \frac{\langle l(t+1),
G(t)Q(t)G^T(t)l(t+1)\rangle^{1/2}}{\langle l(t),
\underline{X}^+_l(t)l(t)\rangle^{1/2}}(A(t)\underline{X}^+_l(t)A^T(t))^{1/2}l(t+1).\end{aligned}"/></p>
</div><p>Equations <a href="#equation-fwdextminmax1">(125)</a>, <a href="#equation-fwdextminmax2">(126)</a> are valid only if
<img class="math" src="_images/math/40eee3852a6aa9c03a68ac06e5abb7b3a2de8ea4.png" alt="{\mathcal E}(0,G(t)Q(t)G^T(t)\subseteq{\mathcal E}(0,A(t)\underline{X}^+_l(t)A^T(t))"/>,
otherwise minmax CLRS
<img class="math" src="_images/math/463d0e81612382d359e7c9d96b4ea72b1f5f7350.png" alt="\underline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0))"/> is
empty.</p>
<p>The shape matrix of the internal ellipsoid for maxmin reach set is
determined from</p>
<div class="math" id="equation-fwdintmaxmin1">
<p><span class="eqno">(128)</span><img src="_images/math/9c7f4f6974e643e3e2707f4e64304ccfd02ff7e5.png" alt="\hat{X}^-_l(t) &amp; =
\left((A(t)\overline{X}^-_l(t)A^T(t))^{1/2} +
\overline{T}_l(t)(B(t)P(t)B^T(t))^{1/2}\right)^T
\times \nonumber \\
&amp; \left((A(t)\overline{X}^-_l(t)A^T(t))^{1/2} +
\overline{T}_l(t)(B(t)P(t)B^T(t))^{1/2}\right)\\"/></p>
</div><div class="math" id="equation-fwdintmaxmin2">
<p><span class="eqno">(129)</span><img src="_images/math/7b4c2efe99c75e008e4a4c69717ab97196f7bbac.png" alt="\overline{X}^-_l(t+1) &amp; =
(1+\overline{\eta}_l(t))\hat{X}^-_l(t) +
\left(1+\frac{1}{\underline{\eta}_l(t)}\right)
G(t)Q(t)G^T(t), \\"/></p>
</div><div class="math" id="equation-fwdintmaxmin3">
<p><span class="eqno">(130)</span><img src="_images/math/1f33257ddd5a4b27a62f801c4f9850818f273cd9.png" alt="\overline{X}^-_l(t_0) &amp; = X_0,"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/211db988f3e108976cbe83c6ffadc86cbf7eb130.png" alt="\overline{\eta}_l(t) = \frac{\langle l(t+1),
G(t)Q(t)G^T(t)l(t+1)\rangle^{1/2}}{\langle l(t+1),
\hat{X}^-_l(t)l(t+1)\rangle^{1/2}},"/></p>
</div><p>and <img class="math" src="_images/math/c7e1267b0cd5ebe33335a922923dd866c20add77.png" alt="\overline{T}_l(t)"/> is orthogonal matrix determined from the
equation</p>
<div class="math">
<p><img src="_images/math/318140bc816efa802dae516b493f1ac9ec95f0f6.png" alt="\begin{aligned}
&amp; \overline{T}_l(t)(B(t)P(t)B^T(t))^{1/2}l(t+1) = \\
&amp; \frac{\langle l(t+1),
B(t)P(t)B^T(t)l(t+1)\rangle^{1/2}}{\langle l(t),
\overline{X}^-_l(t)l(t)\rangle^{1/2}}(A(t)\overline{X}^-_l(t)A^T(t))^{1/2}l(t+1).\end{aligned}"/></p>
</div><p>Equation <a href="#equation-fwdintmaxmin2">(129)</a> is valid only if
<img class="math" src="_images/math/13a76b9e72fb1ecd3584d85dc006bfd274fbc9e6.png" alt="{\mathcal E}(0,G(t)Q(t)G^T(t)\subseteq{\mathcal E}(0,\hat{X}^-_l(t))"/>.</p>
<p>The shape matrix of the internal ellipsoid for the minmax reach set is
determined by</p>
<div class="math" id="equation-fwdintminmax1">
<p><span class="eqno">(131)</span><img src="_images/math/16c6d9c878b2925bb6556b36d68313ae9bcf174b.png" alt="\breve{X}^-_l(t) &amp; = (1+\underline{\eta}_l(t))A(t)\underline{X}^-_l(t)A^T(t) +
\left(1+\frac{1}{\underline{\eta}_l(t)}\right)
G(t)Q(t)G^T(t),\\"/></p>
</div><div class="math" id="equation-fwdintminmax2">
<p><span class="eqno">(132)</span><img src="_images/math/c51a6915bac1a64c7f08a3f6e2934e6fc79ba764.png" alt="\underline{X}^-_l(t+1) &amp; = \left((\breve{X}^-_l(t))^{1/2} +
\underline{T}_l(t)(B(t)P(t)B^T(t))^{1/2}\right)^T
\times \nonumber \\
&amp;\left((\breve{X}^-_l(t))^{1/2} + \underline{T}_l(t)(B(t)P(t)B^T(t))^{1/2}\right),\\"/></p>
</div><div class="math" id="equation-fwdintminmax3">
<p><span class="eqno">(133)</span><img src="_images/math/5394fc9edd05bd7e8f4c87858c8978a261baa2ac.png" alt="\underline{X}^-_l(t_0) &amp; = X_0,"/></p>
</div><p>wherein</p>
<div class="math">
<p><img src="_images/math/a8fbccb52c1a6ceea5d3b27b2a12f2b3ded05199.png" alt="\underline{\eta}_l(t) = \frac{\langle l(t+1),
G(t)Q(t)G^T(t)l(t+1)\rangle^{1/2}}{\langle l(t),
\underline{X}^-_l(t)l(t)\rangle^{1/2}},"/></p>
</div><p>and the orthogonal matrix <img class="math" src="_images/math/3a22700dbf8d5c2d9479f191e10e853d17bacafa.png" alt="\underline{T}_l(t)"/> is determined by
the equation</p>
<div class="math">
<p><img src="_images/math/955e5adf6b441bec4019ff381ff77f3b1061cae2.png" alt="\begin{aligned}
&amp;\underline{T}_l(t)(B(t)P(t)B^T(t))^{1/2}l(t+1) = \\
&amp; \frac{\langle l(t+1),
B(t)P(t)B^T(t)l(t+1)\rangle^{1/2}}{\langle l(t+1),
\breve{X}^-_l(t)l(t+1)\rangle^{1/2}}(\breve{X}^-_l(t))^{1/2}l(t+1).\end{aligned}"/></p>
</div><p>Equations <a href="#equation-fwdintminmax1">(131)</a>, <a href="#equation-fwdintminmax2">(132)</a> are valid only if
<img class="math" src="_images/math/933cd1087ffb4f28f128d84ccb09631bf8674201.png" alt="{\mathcal E}(0,G(t)Q(t)G^T(t)\subseteq{\mathcal E}(0,A(t)\underline{X}^-_l(t)A^T(t))"/>.</p>
<p>The point where the external and the internal ellipsoids both touch the
boundary of the maxmin CLRS is</p>
<div class="math">
<p><img src="_images/math/85f55467d2bf207362c7bb902118f27f799f70ef.png" alt="x_l^+(t) = x_c(t) + \frac{\overline{X}^+_l(t)l(t)}{\langle l(t),
\overline{X}^+_l(t)l(t)\rangle^{1/2}} ,"/></p>
</div><p>and the bounday point of minmax CLRS is</p>
<div class="math">
<p><img src="_images/math/6af12374fb598ba7d1824e20b2b52622566e58a5.png" alt="x_l^-(t) = x_c(t) + \frac{\overline{X}^-_l(t)l(t)}{\langle l(t),
\overline{X}^-_l(t)l(t)\rangle^{1/2}} ."/></p>
</div><p>Points <img class="math" src="_images/math/a3aabd2381990060bf40eb923028279849d1cf5f.png" alt="x^{\pm}_l(t)"/>, <img class="math" src="_images/math/31647639deeebd7862662e827baa5487d856a953.png" alt="t\geqslant t_0"/>, form extremal
trajectories. In order for the system to follow the extremal trajectory
specified by some vector <img class="math" src="_images/math/30d710af557466bc27cf63b952f43997962da1cc.png" alt="l_0"/>, the initial state must be</p>
<div class="math" id="equation-dx01">
<p><span class="eqno">(134)</span><img src="_images/math/ff2ccd681bc1bc2a9dc4ded91b181c9b2ecfdb2d.png" alt="x_l^0 = x_0 + \frac{X_0l_0}{\langle l_0, X_0l_0\rangle^{1/2}}."/></p>
</div><p>When there is no disturbance (<img class="math" src="_images/math/6c82309d7670311c875de138ac1ee872518628bf.png" alt="G(t)=0"/> or <img class="math" src="_images/math/7f9e1cb9aa6839ba0b3b19bd099c1b0528e6a820.png" alt="Q(t)=0"/>),
<img class="math" src="_images/math/dc0048e7fd0d92df650c03fb6192c2081843201f.png" alt="\overline{X}^+_l(t)=\underline{X}^+_l(t)"/> and
<img class="math" src="_images/math/9c6b6e3411fe8fb81cae8159e683fa6a3347d73f.png" alt="\overline{X}^-_l(t)=\underline{X}^-_l(t)"/>, and the open-loop
control that steers the system along the extremal trajectory defined by
<img class="math" src="_images/math/30d710af557466bc27cf63b952f43997962da1cc.png" alt="l_0"/> is</p>
<div class="math" id="equation-udt">
<p><span class="eqno">(135)</span><img src="_images/math/a78eaedc43faf86647d85ba58be66d49fa5b11d0.png" alt="u_l(t) = p(t) + \frac{P(t)B^T(t)l(t+1)}{\langle l(t+1),
B(t)P(t)B^T(t)l(t+1)\rangle^{1/2}}."/></p>
</div><p>Each choice of <img class="math" src="_images/math/30d710af557466bc27cf63b952f43997962da1cc.png" alt="l_0"/> defines an external and internal
approximation. If <img class="math" src="_images/math/98e97423400c5f7068672ed053eb94a04324ffef.png" alt="\overline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0))"/> is
nonempty,</p>
<div class="math">
<p><img src="_images/math/a99420d44217c70d97d6a101fc86e0a4cc39c391.png" alt="\bigcup_{\langle l_0,l_0\rangle=1}{\mathcal E}(x_c(t),\overline{X}^-_l(t)) =
\overline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0)) =
\bigcap_{\langle l_0,l_0\rangle=1}{\mathcal E}(x_c(t),\overline{X}^+_l(t))."/></p>
</div><p>Similarly for
<img class="math" src="_images/math/463d0e81612382d359e7c9d96b4ea72b1f5f7350.png" alt="\underline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0))"/>,</p>
<div class="math">
<p><img src="_images/math/edf789924f2480ed06b4966e254d2bab89a81b15.png" alt="\bigcup_{\langle l_0,l_0\rangle=1}{\mathcal E}(x_c(t),\underline{X}^-_l(t)) =
\underline{{\mathcal X}}_{CL}(t,t_0,{\mathcal E}(x_0,X_0)) =
\bigcap_{\langle l_0,l_0\rangle=1}{\mathcal E}(x_c(t),\underline{X}^+_l(t))."/></p>
</div><p>Similarly, tight ellipsoidal approximations of maxmin and minmax CLBRS
with terminating conditions <img class="math" src="_images/math/4b298e30c8b34980e081552d6c38097e4411b83c.png" alt="(t_1, {\mathcal E}(y_1,Y_1))"/> can be
obtained for those directions <img class="math" src="_images/math/bd252b5c4a12368f727135da5f6d3a66c73c2621.png" alt="l(t)"/> satisfying</p>
<div class="math" id="equation-bckadjointd">
<p><span class="eqno">(136)</span><img src="_images/math/0ae93fb772136ddf9a664517ee297bd73d62d830.png" alt="l(t) = \Phi^T(t_1,t)l_1,"/></p>
</div><p>with some fixed <img class="math" src="_images/math/6ee61fd6e8a1926a802b97fc99b66b8687d8f620.png" alt="l_1"/>, for which they exist.</p>
<p>With boundary conditions</p>
<div class="math" id="equation-bndconds">
<p><span class="eqno">(137)</span><img src="_images/math/44efa78f5f13515bb2ef62d8d585a796691ce444.png" alt="y_c(t_1)=y_1, ~~~ \overline{Y}^+_l(t_1)=\overline{Y}^-_l(t_1)=\underline{Y}^+_l(t_1)=\underline{Y}^-_l(t_1)=Y_1,"/></p>
</div><p>external and internal ellipsoids for maxmin CLBRS
<img class="math" src="_images/math/03576497a2e7ecf7a20fae0927798ad267822382.png" alt="\overline{{\mathcal Y}}_{CL}(t_1,t,{\mathcal E}(y_1,Y_1))"/> at
time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>, <img class="math" src="_images/math/389004081e200060ecd8d5bf750cac9f3a832ab5.png" alt="{\mathcal E}(y_c(t),\overline{Y}^+_l(t))"/> and
<img class="math" src="_images/math/bfda056c7f39fb530c68df229d3d470527c1fd62.png" alt="{\mathcal E}(y_c(t),\overline{Y}^-_l(t))"/>, are computed as
external and internal ellipsoidal approximations of the geometric
sum-difference</p>
<div class="math">
<p><img src="_images/math/5655669c713bf34d09b279cd7b3c993626c57d46.png" alt="A^{-1}(t)\left(
{\mathcal E}(y_c(t+1),\overline{Y}^+_l(t+1)) \oplus B(t){\mathcal E}(-p(t),P(t))
\dot{-}G(t){\mathcal E}(-q(t),Q(t))
\right)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/68e2d28a8b14a0309cdbb1b9795bebe94af6cea1.png" alt="A^{-1}(t)\left(
{\mathcal E}(y_c(t+1),\overline{Y}^-_l(t+1)) \oplus B(t){\mathcal E}(-p(t),P(t))
\dot{-}G(t){\mathcal E}(-q(t),Q(t))
\right)"/></p>
</div><p>in direction <img class="math" src="_images/math/bd252b5c4a12368f727135da5f6d3a66c73c2621.png" alt="l(t)"/> from <a href="#equation-bckadjointd">(136)</a>. Section
<a class="reference internal" href="#geometric-sum-difference">Geometric Sum-Difference</a> describes the operation of geometric
sum-difference for ellipsoids.</p>
<p>External and internal ellipsoids for minmax CLBRS
<img class="math" src="_images/math/c70a0fcf951da1989574d835398818c55c7010a7.png" alt="\underline{{\mathcal Y}}_{CL}(t_1,t,{\mathcal E}(y_1,Y_1))"/> at
time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>, <img class="math" src="_images/math/6f2f3ee909d926b80cc2e044ba52dded92ccc855.png" alt="{\mathcal E}(y_c(t),\underline{Y}^+_l(t))"/> and
<img class="math" src="_images/math/d15c498a846f205d2ab161542b48aa976c5de32d.png" alt="{\mathcal E}(y_c(t),\underline{Y}^-_l(t))"/>, are computed as
external and internal ellipsoidal approximations of the geometric
difference-sum</p>
<div class="math">
<p><img src="_images/math/35aea7a1172c8a1f12e47a58f88389cd0c883c1c.png" alt="A^{-1}(t)\left(
{\mathcal E}(y_c(t+1),\underline{Y}^+_l(t+1))
\dot{-}G(t){\mathcal E}(-q(t),Q(t))
\oplus B(t){\mathcal E}(-p(t),P(t))
\right)"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/d54b6f079584d8766776a78beefe25872871ffd7.png" alt="A^{-1}(t)\left(
{\mathcal E}(y_c(t+1),\underline{Y}^-_l(t+1))
\dot{-}G(t){\mathcal E}(-q(t),Q(t))
\oplus B(t){\mathcal E}(-p(t),P(t))
\right)"/></p>
</div><p>in direction <img class="math" src="_images/math/bd252b5c4a12368f727135da5f6d3a66c73c2621.png" alt="l(t)"/> from <a href="#equation-bckadjointd">(136)</a>. Section
<a class="reference internal" href="#geometric-difference-sum">Geometric Difference-Sum</a> describes the operation of geometric
difference-sum for ellipsoids.</p>
<div class="references"><p>A. A. Kurzhanskiy, P. Varaiya. 2007. “Ellipsoidal Techniques for
Reachability Analysis of Discrete-time Linear Systems.” <em>IEEE
Transactions on Automatic Control</em> 52 (1): 26–38.</p>
</div><table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>In discrete-time case <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/> assumes integer values.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>We are being general when giving the basic definitions. However, it
is important to understand that for any specific <em>continuous-time</em>
dynamical system it must be determined whether the solution exists
and is unique, and in which class of solutions these conditions are
met. Here we shall assume that function <img class="math" src="_images/math/bb2c93730dbb48558bb3c4738c956c4e8f816437.png" alt="f"/> is such that the
solution of the differential equation ([ctds1]) exists and is unique
in Fillipov sense. This allows the right-hand side to be
discontinuous. For discrete-time systems this problem does not exist.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>Minkowski sum of sets
<img class="math" src="_images/math/517da2d4e8db53b5e7f29a1899eb66a00a02bb46.png" alt="{\mathcal W}, {\mathcal Z}\subseteq {\bf R}^n"/> is defined as
<img class="math" src="_images/math/a351f605045834958437fa694984c043cb23547f.png" alt="{\mathcal W}\oplus {\mathcal Z}= \{w+z ~|~ w\in{\mathcal W}, ~ z\in{\mathcal Z}\}"/>.
Set <img class="math" src="_images/math/cd6263916b4b7d5650057a657775fd73484e9fd5.png" alt="{\mathcal W}\oplus{\mathcal Z}"/> is nonempty if and only if
both, <img class="math" src="_images/math/0c1b4347826deca0764c2f3294e57e87964d6abe.png" alt="{\mathcal W}"/> and <img class="math" src="_images/math/e63caa96be87c8447a6385452f4a56cc2cd88d3b.png" alt="{\mathcal Z}"/> are nonempty. If
<img class="math" src="_images/math/0c1b4347826deca0764c2f3294e57e87964d6abe.png" alt="{\mathcal W}"/> and <img class="math" src="_images/math/e63caa96be87c8447a6385452f4a56cc2cd88d3b.png" alt="{\mathcal Z}"/> are convex, set
<img class="math" src="_images/math/cd6263916b4b7d5650057a657775fd73484e9fd5.png" alt="{\mathcal W}\oplus{\mathcal Z}"/> is convex.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><img class="math" src="_images/math/3bddf7260abbc83712dbd6e554c5e07c54cc6c7b.png" alt="{\mathcal M}"/> is weakly invariant with respect to the target
set <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> and times <img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> and <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>, if
for every state <img class="math" src="_images/math/ccd073125d54a003704961629fe643cd5c3ebf39.png" alt="x_0\in{\mathcal M}"/> there exists a control
<img class="math" src="_images/math/75741dc287c95ab30ca0b52fba5160b2c2ea66d8.png" alt="u(\tau, x(\tau))\in{\mathcal U}(\tau)"/>,
<img class="math" src="_images/math/eab6bff26e807fb4405fa64304a1265c1dd9ca3c.png" alt="t_0\leqslant\tau&lt; t"/>, that steers the system from <img class="math" src="_images/math/17f1249ad95b7682b8316ad21de8ce4ee9fdcf93.png" alt="x_0"/>
at time <img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> to some state in <img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> at time
<img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>. If <em>all</em> controls in <img class="math" src="_images/math/2fad00e8688c15ae8e5d1cb55e0e80e8a1a94599.png" alt="{\mathcal U}(\tau)"/>,
<img class="math" src="_images/math/f835b9ade5be0f5e6fe46ddb9e6aaf4e6722f665.png" alt="t_0\leqslant\tau&lt;t"/> steer the system from every
<img class="math" src="_images/math/ccd073125d54a003704961629fe643cd5c3ebf39.png" alt="x_0\in{\mathcal M}"/> at time <img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> to
<img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/> at time <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>, set <img class="math" src="_images/math/3bddf7260abbc83712dbd6e554c5e07c54cc6c7b.png" alt="{\mathcal M}"/> is
said to be <em>strongly</em> invariant with respect to
<img class="math" src="_images/math/bde4a0fa62e8151878615f926c15315366dd1d2f.png" alt="{\mathcal Y}_1"/>, <img class="math" src="_images/math/10fde25257f32317828fde97047bbe76438b6305.png" alt="t_0"/> and <img class="math" src="_images/math/e0d2bf360290fd61d1c1557e763f2622363b3d35.png" alt="t"/>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td>There exists <img class="math" src="_images/math/c4c90c13fe1f3e0aab2e9b3cb569889010f9b1fc.png" alt="f^{-1}(t,x,u)"/> such that
<img class="math" src="_images/math/2a4d203ea36a22028c85e3456b4bfe8a32dc49e7.png" alt="x(t)=f^{-1}(t, x(t+1), u, v)"/>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[6]</a></td><td><p class="first">Hausdorff semidistance between compact sets
<img class="math" src="_images/math/517da2d4e8db53b5e7f29a1899eb66a00a02bb46.png" alt="{\mathcal W}, {\mathcal Z}\subseteq {\bf R}^n"/> is defined as</p>
<div class="math">
<p><img src="_images/math/6eec0a22790a08c116bb86a0acf83aa7c46a5e8b.png" alt="{\bf dist}({\mathcal W}, {\mathcal Z}) = \min\{\langle w-z, w-z\rangle^{1/2}
~|~ w\in{\mathcal W}, \; z\in{\mathcal Z}\},"/></p>
</div><p class="last">where <img class="math" src="_images/math/76fb372270116754eae677544e2d6c7610cec79a.png" alt="\langle\cdot, \cdot\rangle"/> denotes inner product.</p>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[7]</a></td><td>The Minkowski difference of sets
<img class="math" src="_images/math/eb2bd2c948217fc8b2eeb7ee523076542cf52b7f.png" alt="{\mathcal W}, {\mathcal Z}\in{\bf R}^n"/> is defined as
<img class="math" src="_images/math/a9e3ad6abac6691710658fb197bf62541ee991fb.png" alt="{\mathcal W}\dot{-}{\mathcal Z}= \left\{\xi\in{\bf R}^n ~|~
\xi \oplus {\mathcal Z}\subseteq {\mathcal W}\right\}"/>. If
<img class="math" src="_images/math/0c1b4347826deca0764c2f3294e57e87964d6abe.png" alt="{\mathcal W}"/> and <img class="math" src="_images/math/e63caa96be87c8447a6385452f4a56cc2cd88d3b.png" alt="{\mathcal Z}"/> are convex,
<img class="math" src="_images/math/196d742a593eb551cda95342e23a8a187d6c7577.png" alt="{\mathcal W}\dot{-}{\mathcal Z}"/> is convex if it is nonempty.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id18" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[8]</a></td><td>So-called verification problems often consist in ensuring that the
system is unable to reach an ‘unsafe’ target set within a given time
interval.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id19" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[9]</a></td><td><p class="first">The case when <img class="math" src="_images/math/39a600f2477bf0c26625cbeac94c8b2db1137fc3.png" alt="A(t)"/> is singular is described in A. A.
Kurzhanskiy (2007). The idea is to substitute <img class="math" src="_images/math/39a600f2477bf0c26625cbeac94c8b2db1137fc3.png" alt="A(t)"/> with the
nonsingular <img class="math" src="_images/math/2802b493730f36078f7c9a242d2c4684b07c90d9.png" alt="A_\delta(t) = A(t) + \delta U(t)W(t)"/>, in which
<img class="math" src="_images/math/a382495e202a1b34e33e489f3219651f351ff526.png" alt="U(t)"/> and <img class="math" src="_images/math/e462977a99202c493ba3c4eb9e062b2ce8fe0e49.png" alt="W(t)"/> are obtained from the singular value
decomposition</p>
<div class="math">
<p><img src="_images/math/c3b5ec5263738d8823c3f32b1fa3913518aeff22.png" alt="A(t) = U(t)\Sigma(t)V(t) ."/></p>
</div><p class="last">The parameter <img class="math" src="_images/math/0a42a8b725c200085e5253db2d2fbf8dab898a8f.png" alt="\delta"/> can be chosen based on the number of
time steps for which the reach set must be computed and the required
accuracy. The issue of inverting ill-conditioned matrices is also
addressed in A. A. Kurzhanskiy (2007).</p>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id20" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[10]</a></td><td>Note that for <a href="#equation-adjointdt">(117)</a> <img class="math" src="_images/math/39a600f2477bf0c26625cbeac94c8b2db1137fc3.png" alt="A(t)"/> must be invertible.</td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="main_manual.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Ellipsoidal Calculus</a><ul>
<li><a class="reference internal" href="#basic-notions">Basic Notions</a></li>
<li><a class="reference internal" href="#operations-with-ellipsoids">Operations with Ellipsoids</a><ul>
<li><a class="reference internal" href="#affine-transformation">Affine Transformation</a></li>
<li><a class="reference internal" href="#geometric-sum">Geometric Sum</a></li>
<li><a class="reference internal" href="#geometric-difference">Geometric Difference</a></li>
<li><a class="reference internal" href="#geometric-difference-sum">Geometric Difference-Sum</a></li>
<li><a class="reference internal" href="#geometric-sum-difference">Geometric Sum-Difference</a></li>
<li><a class="reference internal" href="#intersection-of-ellipsoid-and-hyperplane">Intersection of Ellipsoid and Hyperplane</a></li>
<li><a class="reference internal" href="#intersection-of-ellipsoid-and-ellipsoid">Intersection of Ellipsoid and Ellipsoid</a></li>
<li><a class="reference internal" href="#intersection-of-ellipsoid-and-halfspace">Intersection of Ellipsoid and Halfspace</a></li>
<li><a class="reference internal" href="#checking-if-one-ellipsoid-contains-another">Checking if one ellipsoid contains another</a></li>
<li><a class="reference internal" href="#minimum-volume-ellipsoids">Minimum Volume Ellipsoids</a></li>
<li><a class="reference internal" href="#maximum-volume-ellipsoids">Maximum Volume Ellipsoids</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#reachability">Reachability</a><ul>
<li><a class="reference internal" href="#basics-of-reachability-analysis">Basics of Reachability Analysis</a><ul>
<li><a class="reference internal" href="#systems-without-disturbances">Systems without disturbances</a></li>
<li><a class="reference internal" href="#systems-with-disturbances">Systems with disturbances</a></li>
<li><a class="reference internal" href="#reachability-problem">Reachability problem</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ellipsoidal-method">Ellipsoidal Method</a><ul>
<li><a class="reference internal" href="#continuous-time-systems">Continuous-time systems</a></li>
<li><a class="reference internal" href="#discrete-time-systems">Discrete-time systems</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="chap_intro.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="chap_install.html"
                        title="next chapter">Installation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/chap_ellcalc.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="chap_install.html" title="Installation"
             >next</a> |</li>
        <li class="right" >
          <a href="chap_intro.html" title="Introduction"
             >previous</a> |</li>
        <li><a href="main_manual.html">Ellipsoidal Toolbox 2.0 beta 1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2013 Moscow State University, Faculty of Computational Mathematics and Computer Science, System Analysis Department, 2004-2011 The Regents of the University of California.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b2.
    </div>
  </body>
</html>